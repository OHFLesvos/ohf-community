(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{4:function(t,e,a){t.exports=a("gfoa")},gfoa:function(t,e,a){"use strict";a.r(e);var n=a("XuX8"),s=a.n(n),i=a("X1uE"),r=a("1QPe"),o=a("o0Hb"),l={components:{BaseTable:a("D52m").a},data:function(){return{fields:[{key:"name",label:this.$t("app.name"),sortable:!0},{key:"family_name",label:this.$t("people.family_name"),sortable:!0},{key:"date_of_birth",label:this.$t("people.date_of_birth"),sortable:!0},{key:"nationality",label:this.$t("people.nationality"),sortable:!0},{key:"police_no_formatted",label:this.$t("people.police_no"),sortable:!1},{key:"languages",label:this.$t("people.languages"),sortable:!0},{key:"remarks",label:this.$t("people.remarks"),sortable:!0}]}},methods:{list:o.a.list}},u=a("KHd+"),c=Object(u.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-table",{attrs:{id:"peopleTable",fields:t.fields,"api-method":t.list,"default-sort-by":"name","empty-text":t.$t("people.no_persons_found"),"filter-placeholder":t.$t("people.bank_search_text"),"items-per-page":15},scopedSlots:t._u([{key:"cell(name)",fn:function(e){return[null!=e.item.url?[""!=e.value?a("a",{attrs:{href:e.item.url}},[t._v(t._s(e.value))]):t._e()]:[t._v("\n            "+t._s(e.value)+"\n        ")]]}},{key:"cell(family_name)",fn:function(e){return[null!=e.item.url?[""!=e.value?a("a",{attrs:{href:e.item.url}},[t._v(t._s(e.value))]):t._e()]:[t._v("\n            "+t._s(e.value)+"\n        ")]]}}])})}),[],!1,null,null,null).exports,d=a("wd/R"),h=a.n(d),p=a("ihdb"),_=a("o0o1"),v=a.n(_),m=a("rTcV"),f=a("slm/");function b(t,e,a,n,s,i,r){try{var o=t[i](r),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,s)}var g={components:{BarChart:m.a},mixins:[f.a],props:{dateRange:{required:!0,type:Object}},data:function(){return{data:null}},watch:{dateRange:function(){this.loadData(),this.$refs.registrationsPerDayChart.refresh()}},created:function(){this.loadData()},methods:{loadData:function(){var t,e=this;return(t=v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.fetchNumberReportData(e.dateRange.from,e.dateRange.to);case 2:e.data=t.sent;case 3:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(n,s){var i=t.apply(e,a);function r(t){b(i,n,s,r,o,"next",t)}function o(t){b(i,n,s,r,o,"throw",t)}r(void 0)}))})()},registrationsPerDay:function(){return o.a.fetchRegistrationsPerDay(this.dateRange.from,this.dateRange.to)}}},y=Object(u.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card mb-4"},[a("div",{staticClass:"card-header"},[t._v(t._s(t.$t("people.registrations")))]),t._v(" "),a("div",{staticClass:"card-body"},[t.data?t._l(t.data,(function(e,n){return a("div",{key:n,staticClass:"row mb-4 align-items-center"},[t._l(e,(function(e,n){return a("div",{key:n,staticClass:"col"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col text-secondary"},[t._v(t._s(n)+":")]),t._v(" "),a("div",{staticClass:"col display-4"},[t._v(t._s(t.numberFormat(e)))])])])})),t._v(" "),a("div",{staticClass:"w-100 d-block d-sm-none"})],2)})):a("p",[t._v("\n            "+t._s(t.$t("app.loading"))+"\n        ")]),t._v(" "),a("bar-chart",{ref:"registrationsPerDayChart",staticClass:"mb-0",attrs:{title:t.$t("app.new_registrations_per_day"),"x-label":t.$t("app.date"),"y-label":t.$t("app.quantity"),data:t.registrationsPerDay,height:350}})],2)])}),[],!1,null,null,null).exports,w={components:{DoughnutChart:a("4LGy").a},props:{title:{required:!0,type:String},data:{type:[Function,Object],required:!0}}},C={components:{DoughnutChartDistributionWidget:Object(u.a)(w,(function(){var t=this.$createElement,e=this._self._c||t;return e("b-card",{staticClass:"mb-4",attrs:{header:this.title}},[e("doughnut-chart",{staticClass:"mb-2",attrs:{title:this.title,data:this.data,"hide-legend":"",height:300}})],1)}),[],!1,null,null,null).exports},data:function(){return{api:o.a}}},x=Object(u.a)(C,(function(){var t=this.$createElement;return(this._self._c||t)("doughnut-chart-distribution-widget",{attrs:{title:this.$t("people.gender"),data:this.api.fetchGenderDistribution}})}),[],!1,null,null,null).exports,D=a("CN0g"),M={components:{DoughnutChartTableDistributionWidget:D.a},data:function(){return{api:o.a}}},$=Object(u.a)(M,(function(){var t=this.$createElement;return(this._self._c||t)("doughnut-chart-table-distribution-widget",{attrs:{title:this.$t("people.age_distribution"),data:this.api.fetchAgeDistribution}})}),[],!1,null,null,null).exports,k={components:{DoughnutChartTableDistributionWidget:D.a},data:function(){return{api:o.a}}},R=Object(u.a)(k,(function(){var t=this.$createElement;return(this._self._c||t)("doughnut-chart-table-distribution-widget",{attrs:{title:this.$t("people.nationalities"),data:this.api.fetchNationalityDistribution}})}),[],!1,null,null,null).exports,T={components:{DateRangeSelect:p.a,NumbersWidget:y,GenderDistributionWidget:x,AgeDistributionWidget:$,NationalityDistribution:R},data:function(){return{dateRange:{from:h()().subtract(30,"days").format(h.a.HTML5_FMT.DATE),to:h()().format(h.a.HTML5_FMT.DATE),granularity:"days"}}}},O=Object(u.a)(T,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("date-range-select",{staticClass:"mb-2",attrs:{"no-granularity":""},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}}),t._v(" "),a("div",{staticClass:"row mb-0 mb-sm-2"},[a("div",{staticClass:"col-xl-6"},[a("numbers-widget",{attrs:{"date-range":t.dateRange}}),t._v(" "),a("gender-distribution-widget"),t._v(" "),a("age-distribution-widget")],1),t._v(" "),a("div",{staticClass:"col-xl-6"},[a("nationality-distribution")],1)])],1)}),[],!1,null,null,null).exports;function P(t,e,a,n,s,i,r){try{var o=t[i](r),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,s)}var j={mixins:[f.a],data:function(){return{data:null,selectedMonth:null}},computed:{currentMonthName:function(){return h()(this.data.monthDate).format("MMMM YYYY")},monthOptions:function(){return Object.entries(this.data.months).map((function(t){return{value:t[0],text:t[1]}}))},computedData:function(){var t=this.data.current_days_active>0?Math.round(this.data.current_total_visitors/this.data.current_days_active):0,e=this.data.previous_days_active>0?Math.round(this.data.previous_total_visitors/this.data.previous_days_active):0,a=this.data.current_days_active>0?Math.round(this.data.current_new_registrations/this.data.current_days_active):0,n=this.data.previous_days_active>0?Math.round(this.data.previous_new_registrations/this.data.previous_days_active):0;return[{label:"Coupons handed out",value:this.data.current_coupons_handed_out,percent:this.percentVal(this.data.previous_coupons_handed_out,this.data.current_coupons_handed_out),list:this.data.current_coupon_types_handed_out,ytd:this.data.year_coupons_handed_out},{label:"Days active",value:this.data.current_days_active,percent:this.percentVal(this.data.previous_days_active,this.data.current_days_active),ytd:this.data.year_days_active},{label:"Unique visitors",value:this.data.current_unique_visitors,percent:this.percentVal(this.data.previous_unique_visitors,this.data.current_unique_visitors),ytd:this.data.year_unique_visitors},{label:"Total visitors",value:this.data.current_total_visitors,percent:this.percentVal(this.data.previous_total_visitors,this.data.current_total_visitors),ytd:this.data.year_total_visitors},{label:"Average visitors / day",value:t,percent:this.percentVal(e,t)},{label:"New registrations",value:this.data.current_new_registrations,percent:this.percentVal(this.data.previous_new_registrations,this.data.current_new_registrations),ytd:this.data.year_new_registrations},{label:"Average registrations / day",value:a,percent:this.percentVal(n,a)}]}},watch:{selectedMonth:function(t,e){null!=e&&this.loadData()}},mounted:function(){this.loadData()},methods:{loadData:function(){var t,e=this;return(t=v.a.mark((function t(){var a,n,s,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null!=e.selectedMonth&&(s=e.selectedMonth.split("-"),a=s[0],n=s[1]),t.prev=1,t.next=4,o.a.fetchMonthlySummaryReportData(a,n);case 4:i=t.sent,e.data=i,e.selectedMonth=h()(e.data.monthDate).format("YYYY-MM"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),alert(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})),function(){var e=this,a=arguments;return new Promise((function(n,s){var i=t.apply(e,a);function r(t){P(i,n,s,r,o,"next",t)}function o(t){P(i,n,s,r,o,"throw",t)}r(void 0)}))})()},percentVal:function(t,e){return 0!=t?Math.round((e-t)/t*100):null}}},E=Object(u.a)(j,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.data?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm"},[a("h2",{staticClass:"display-4 mb-4"},[t._v(t._s(t.currentMonthName))])]),t._v(" "),t.data.months&&Object.keys(t.data.months).length>0?a("div",{staticClass:"col-sm-auto"},[a("b-form-select",{attrs:{options:t.monthOptions},model:{value:t.selectedMonth,callback:function(e){t.selectedMonth=e},expression:"selectedMonth"}})],1):t._e()]),t._v(" "),a("div",{staticClass:"row"},t._l(t.computedData,(function(e,n){return a("div",{key:n,staticClass:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2 mb-3"},[a("div",{staticClass:"card text-dark bg-light"},[a("div",{staticClass:"card-body text-right"},[a("big",{staticClass:"display-4"},[t._v(t._s(t.numberFormat(e.value)))]),t._v(" "),e.percent?[t._v("\n                        Â \n                        "),a("small",{class:{"text-success":e.percent>0,"text-danger":e.percent<0}},[t._v("\n                            "+t._s(Math.abs(e.percent))+"%\n                            "),e.percent>0?a("font-awesome-icon",{attrs:{icon:"caret-up"}}):t._e(),t._v(" "),e.percent<0?a("font-awesome-icon",{attrs:{icon:"caret-down"}}):t._e()],1)]:t._e(),t._v(" "),a("br"),t._v(" "),a("small",{staticClass:"text-uppercase"},[t._v(t._s(e.label))]),t._v(" "),e.ytd?[a("br"),a("small",{staticClass:"text-muted",attrs:{title:"Year-to-date"}},[t._v("\n                            "+t._s(t.numberFormat(e.ytd))+" (YTD)\n                        ")])]:t._e()],2),t._v(" "),e.list?a("ul",{staticClass:"list-group list-group-flush"},t._l(e.list,(function(e,n){return a("li",{key:n,staticClass:"list-group-item d-flex justify-content-between"},[a("span",[t._v(t._s(e.label))]),t._v(" "),a("span",{staticClass:"pull-right"},[t._v("\n                            "+t._s(t.numberFormat(e.value))+"\n                        ")])])})),0):t._e()])])})),0)]):a("p",[t._v("\n    "+t._s(t.$t("app.loading"))+"\n")])}),[],!1,null,null,null).exports,Y=a("UvZm"),q=a("fxIy");s.a.use(i.a),s.a.component("font-awesome-icon",r.a),s.a.mixin(Y.a),s.a.config.productionTip=!1,new s.a({el:"#people-app",i18n:q.a,components:{PeopleTable:c,PeopleReportPage:O,MonthlySummaryReportPage:E}})}},[[4,0,1]]]);
//# sourceMappingURL=people.js.map