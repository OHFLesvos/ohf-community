"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[372],{6301:(t,e,r)=>{r.d(e,{Z:()=>l});var n=r(7757),a=r.n(n),i=r(892);function o(t,e,r,n,a,i,o){try{var s=t[i](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,a)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function s(t){o(i,n,a,s,l,"next",t)}function l(t){o(i,n,a,s,l,"throw",t)}s(void 0)}))}}const l={listCurrent:function(t){return s(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,i.BC)("api.visitors.listCurrent",t),e.next=3,i.hi.get(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},checkin:function(t){return s(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,i.BC)("api.visitors.checkin"),e.next=3,i.hi.post(r,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},checkout:function(t){return s(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,i.BC)("api.visitors.checkout",t),e.next=3,i.hi.put(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},checkoutAll:function(){return s(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,i.BC)("api.visitors.checkoutAll"),t.next=3,i.hi.post(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},dailyVisitors:function(){return s(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,i.BC)("api.visitors.dailyVisitors"),t.next=3,i.hi.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},monthlyVisitors:function(){return s(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,i.BC)("api.visitors.monthlyVisitors"),t.next=3,i.hi.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()}}},6890:(t,e,r)=>{r.d(e,{Z:()=>s});var n=r(7897),a=r.n(n),i=r(1519),o=r.n(i)()(a());o.push([t.id,'.required-marker legend:after{color:red;content:"*";margin-left:3px}',"",{version:3,sources:["webpack://./resources/js/components/visitors/RegisterVisitorForm.vue"],names:[],mappings:"AA4PA,8BAEA,SAAA,CADA,WAAA,CAEA,eACA",sourcesContent:['<template>\r\n    <validation-observer\r\n        ref="observer"\r\n        v-slot="{ handleSubmit }"\r\n    >\r\n        <b-form @submit.stop.prevent="handleSubmit(onSubmit)">\r\n            <b-form-row>\r\n                <b-col\r\n                  v-if="formData.type == \'visitor\' || formData.type == \'participant\'"\r\n                  sm\r\n                >\r\n                    <validation-provider\r\n                        :name="$t(\'ID Number\')"\r\n                        vid="id_number"\r\n                        :rules="{ required: true }"\r\n                        v-slot="validationContext"\r\n                    >\r\n                        <b-form-group\r\n                            :label="$t(\'ID Number\')"\r\n                            :state="getValidationState(validationContext)"\r\n                            :invalid-feedback="validationContext.errors[0]"\r\n                            class="required-marker"\r\n                        >\r\n                            <b-form-input\r\n                                ref="idNumberInput"\r\n                                v-model="formData.id_number"\r\n                                trim\r\n                                autocomplete="off"\r\n                                :state="getValidationState(validationContext)"\r\n                                :disabled="isDisabled"\r\n                            />\r\n                        </b-form-group>\r\n                    </validation-provider>\r\n                </b-col>\r\n            </b-form-row>\r\n            <b-form-row>\r\n                <b-col sm>\r\n                    <validation-provider\r\n                        :name="$t(\'First Name\')"\r\n                        vid="first_name"\r\n                        :rules="{}"\r\n                        v-slot="validationContext"\r\n                    >\r\n                        <b-form-group\r\n                            :label="$t(\'First Name\')"\r\n                            :state="getValidationState(validationContext)"\r\n                            :invalid-feedback="validationContext.errors[0]"\r\n                        >\r\n                            <b-form-input\r\n                                v-model="formData.first_name"\r\n                                trim\r\n                                ref="firstNameInput"\r\n                                autocomplete="off"\r\n                                :state="getValidationState(validationContext)"\r\n                                :disabled="isDisabled"\r\n                            />\r\n                        </b-form-group>\r\n                    </validation-provider>\r\n                </b-col>\r\n                <b-col sm>\r\n                    <validation-provider\r\n                        :name="$t(\'Last Name\')"\r\n                        vid="last_name"\r\n                        :rules="{}"\r\n                        v-slot="validationContext"\r\n                    >\r\n                        <b-form-group\r\n                            :label="$t(\'Last Name\')"\r\n                            :state="getValidationState(validationContext)"\r\n                            :invalid-feedback="validationContext.errors[0]"\r\n                        >\r\n                            <b-form-input\r\n                                v-model="formData.last_name"\r\n                                trim\r\n                                autocomplete="off"\r\n                                :state="getValidationState(validationContext)"\r\n                                :disabled="isDisabled"\r\n                            />\r\n                        </b-form-group>\r\n                    </validation-provider>\r\n                </b-col>\r\n            </b-form-row>\r\n            <b-form-row>\r\n                <b-col cols="auto" class="pr-3">\r\n                    <b-form-group :label="$t(\'Type\')">\r\n                        <b-form-radio-group\r\n                            v-model="formData.type"\r\n                            :options="types"\r\n                            stacked\r\n                            @change="changeType"\r\n                        />\r\n                    </b-form-group>\r\n                </b-col>\r\n                <b-col\r\n                  v-if="formData.type == \'visitor\'"\r\n                  sm\r\n                >\r\n                    <validation-provider\r\n                        :name="$t(\'Place of residence\')"\r\n                        vid="place_of_residence"\r\n                        :rules="{ }"\r\n                        v-slot="validationContext"\r\n                    >\r\n                        <b-form-group\r\n                            :label="$t(\'Place of residence\')"\r\n                            :state="getValidationState(validationContext)"\r\n                            :invalid-feedback="validationContext.errors[0]"\r\n                        >\r\n                            <b-form-input\r\n                                v-model="formData.place_of_residence"\r\n                                trim\r\n                                autocomplete="off"\r\n                                :state="getValidationState(validationContext)"\r\n                                :disabled="isDisabled"\r\n                            />\r\n                        </b-form-group>\r\n                    </validation-provider>\r\n                </b-col>\r\n                <b-col\r\n                  v-if="formData.type == \'participant\' || formData.type == \'external\'"\r\n                  sm\r\n                >\r\n                    <validation-provider\r\n                        :name="$t(\'Organization\')"\r\n                        vid="organization"\r\n                        :rules="{ }"\r\n                        v-slot="validationContext"\r\n                    >\r\n                        <b-form-group\r\n                            :label="$t(\'Organization\')"\r\n                            :state="getValidationState(validationContext)"\r\n                            :invalid-feedback="validationContext.errors[0]"\r\n                        >\r\n                            <b-form-input\r\n                                ref="organizationInput"\r\n                                v-model="formData.organization"\r\n                                trim\r\n                                autocomplete="off"\r\n                                :state="getValidationState(validationContext)"\r\n                                :disabled="isDisabled"\r\n                            />\r\n                        </b-form-group>\r\n                    </validation-provider>\r\n                </b-col>\r\n            </b-form-row>\r\n            <p>\r\n                <b-button\r\n                    variant="primary"\r\n                    type="submit"\r\n                    :disabled="isDisabled"\r\n                >\r\n                    <font-awesome-icon icon="check" />\r\n                    {{ $t(\'Register\') }}\r\n                </b-button>\r\n                <b-button\r\n                    variant="secondary"\r\n                    type="button"\r\n                    :disabled="isDisabled"\r\n                    @click="reset"\r\n                >\r\n                    <font-awesome-icon icon="eraser" />\r\n                    {{ $t(\'Reset\') }}\r\n                </b-button>\r\n            </p>\r\n        </b-form>\r\n    </validation-observer>\r\n</template>\r\n\r\n<script>\r\nimport formInputMixin from \'@/mixins/formInputMixin\'\r\nexport default {\r\n    props: {\r\n        disabled: Boolean,\r\n    },\r\n    mixins: [ formInputMixin ],\r\n    data () {\r\n        return {\r\n            formData: this.initialFormData(),\r\n            types: [\r\n                { value: \'visitor\', text: this.$t(\'Visitor OHF\') },\r\n                { value: \'participant\', text: this.$t(\'Visitor Partner\') },\r\n                { value: \'external\', text: this.$t(\'Other\') },\r\n            ]\r\n        }\r\n    },\r\n    computed: {\r\n        isDisabled () {\r\n            return this.disabled\r\n        }\r\n    },\r\n    watch: {\r\n        disabled (val, oldVal) {\r\n            if (!val && oldVal) {\r\n                this.$nextTick(() => this.focus())\r\n            }\r\n        }\r\n    },\r\n    mounted () {\r\n        this.focus()\r\n    },\r\n    methods: {\r\n        submit () {\r\n            this.$refs.observer.validate()\r\n                .then(valid => {\r\n                    if (valid) {\r\n                        this.onSubmit()\r\n                    }\r\n                })\r\n        },\r\n        onSubmit () {\r\n            if (this.formData.type == \'visitor\') {\r\n                this.formData.organization = \'\'\r\n            } else if (this.formData.type == \'participant\') {\r\n                this.formData.place_of_residence = \'\'\r\n            } else if (this.formData.type == \'external\') {\r\n                this.formData.id_number = \'\'\r\n                this.formData.place_of_residence = \'\'\r\n            }\r\n            this.$emit(\'submit\', this.formData)\r\n        },\r\n        reset () {\r\n            this.formData = this.initialFormData()\r\n            this.$refs.observer.reset()\r\n            this.focus()\r\n        },\r\n        initialFormData () {\r\n            return {\r\n                first_name: \'\',\r\n                last_name: \'\',\r\n                type: \'visitor\',\r\n                id_number: \'\',\r\n                place_of_residence: \'\',\r\n                organization: \'\'\r\n            }\r\n        },\r\n        focus () {\r\n            this.$refs.idNumberInput.focus()\r\n        },\r\n        changeType (value) {\r\n            if (value == \'external\') {\r\n                this.$nextTick(() => this.$refs.organizationInput.focus())\r\n            } else if (value == \'participant\') {\r\n                this.$nextTick(() => this.$refs.organizationInput.focus())\r\n            } else {\r\n                this.$nextTick(() => this.$refs.idNumberInput.focus())\r\n            }\r\n        }\r\n    }\r\n}\r\n<\/script>\r\n\r\n<style>\r\n    .required-marker legend:after {\r\n        content: \'*\';\r\n        color: red;\r\n        margin-left: 3px;\r\n    }\r\n</style>\r\n'],sourceRoot:""}]);const s=o},2851:(t,e,r)=>{r.d(e,{Z:()=>a});const n={props:["value"]};const a=(0,r(1900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-alert",{attrs:{variant:"danger",show:null!=t.value}},[r("b-row",{attrs:{"align-v":"center"}},[r("b-col",[r("font-awesome-icon",{attrs:{icon:"times-circle"}}),t._v("\n            "+t._s(t.$t("Error: {err}",{err:t.value}))+"\n        ")],1),t._v(" "),r("b-col",{attrs:{sm:"auto"}},[r("b-button",{staticClass:"float-right",attrs:{variant:"danger",size:"sm"},on:{click:function(e){return t.$emit("retry")}}},[r("font-awesome-icon",{attrs:{icon:"redo"}}),t._v("\n                "+t._s(t.$t("Retry"))+"\n            ")],1)],1)],1)],1)}),[],!1,null,null,null).exports},6951:(t,e,r)=>{r.d(e,{Z:()=>c});var n=r(7757),a=r.n(n),i=r(2851),o=r(505),s=r(6281);function l(t,e,r,n,a,i,o){try{var s=t[i](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,a)}const u={components:{AlertWithRetry:i.Z,TableFilter:o.Z,TablePagination:s.Z},props:{id:{required:!0,type:String},fields:{required:!1,type:Array},apiMethod:{required:!0,type:Function},defaultSortBy:{required:!0,type:String},defaultSortDesc:{required:!1,type:Boolean,default:!1},emptyText:{required:!1,type:String},tbodyTrClass:{required:!1},itemsPerPage:{required:!1,type:Number,default:25},filterPlaceholder:{require:!1,type:String,default:function(){return this.$t("Type to search...")}},loadingLabel:{type:String,required:!1,default:function(){return this.$t("Loading...")}},noFilter:Boolean},data:function(){return{isBusy:!1,sortBy:sessionStorage.getItem(this.id+".sortBy")?sessionStorage.getItem(this.id+".sortBy"):this.defaultSortBy,sortDesc:sessionStorage.getItem(this.id+".sortDesc")?"true"==sessionStorage.getItem(this.id+".sortDesc"):this.defaultSortDesc,currentPage:sessionStorage.getItem(this.id+".currentPage")?parseInt(sessionStorage.getItem(this.id+".currentPage")):1,perPage:this.itemsPerPage,totalRows:0,errorText:null,filter:sessionStorage.getItem(this.id+".filter")?sessionStorage.getItem(this.id+".filter"):""}},watch:{filter:function(){this.currentPage=1}},methods:{itemProvider:function(t){var e,r=this;return(e=a().mark((function e(){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.errorText=null,n={filter:t.filter,page:t.currentPage,pageSize:t.perPage,sortBy:t.sortBy,sortDirection:t.sortDesc?"desc":"asc"},e.prev=2,e.next=5,r.apiMethod(n);case 5:return i=e.sent,r.totalRows=i.meta?i.meta.total:0,r.$emit("metadata",i.meta),i.meta&&t.perPage!=i.meta.per_page&&console.error("Table ".concat(r.id,": Discrepancies detected between requested items per page (").concat(t.perPage,") and returned items per page (").concat(i.meta.per_page,").")),sessionStorage.setItem(r.id+".sortBy",t.sortBy),sessionStorage.setItem(r.id+".sortDesc",t.sortDesc),sessionStorage.setItem(r.id+".currentPage",t.currentPage),t.filter.length>0?sessionStorage.setItem(r.id+".filter",t.filter):sessionStorage.removeItem(r.id+".filter"),e.abrupt("return",i.data||[]);case 16:return e.prev=16,e.t0=e.catch(2),r.errorText=e.t0,r.totalRows=0,sessionStorage.removeItem(r.id+".sortBy"),sessionStorage.removeItem(r.id+".sortDesc"),sessionStorage.removeItem(r.id+".currentPage"),sessionStorage.removeItem(r.id+".filter"),e.abrupt("return",[]);case 25:case"end":return e.stop()}}),e,null,[[2,16]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(t){l(i,n,a,o,s,"next",t)}function s(t){l(i,n,a,o,s,"throw",t)}o(void 0)}))})()},refresh:function(){this.$root.$emit("bv::refresh::table",this.id)}}};const c=(0,r(1900).Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("alert-with-retry",{attrs:{value:t.errorText},on:{retry:t.refresh}}),t._v(" "),t._t("top"),t._v(" "),r("b-form-row",[t.$slots["filter-prepend"]||t.$scopedSlots["filter-prepend"]?r("b-col",{attrs:{cols:"auto"}},[t._t("filter-prepend",null,{filter:t.filter})],2):t._e(),t._v(" "),r("b-col",[t.noFilter?t._e():r("table-filter",{attrs:{placeholder:t.filterPlaceholder,"is-busy":t.isBusy,"total-rows":t.totalRows},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1),t._v(" "),t.$slots["filter-append"]||t.$scopedSlots["filter-append"]?r("b-col",{attrs:{cols:"auto"}},[t._t("filter-append",null,{filter:t.filter})],2):t._e()],1),t._v(" "),r("b-table",{staticClass:"bg-white shadow-sm",attrs:{id:t.id,hover:"",responsive:"",items:t.itemProvider,fields:t.fields,"primary-key":"id",busy:t.isBusy,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"per-page":t.perPage,"current-page":t.currentPage,"show-empty":!0,"empty-text":t.emptyText,"empty-filtered-text":t.$t("There are no records matching your request."),"no-sort-reset":!0,filter:t.filter,"tbody-tr-class":t.tbodyTrClass},on:{"update:busy":function(e){t.isBusy=e},"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([t._l(t.$scopedSlots,(function(e,r){return{key:r,fn:function(e){return[t._t(r,null,null,e)]}}})),{key:"empty",fn:function(e){return[r("em",[t._v(t._s(e.emptyText))])]}},{key:"emptyfiltered",fn:function(e){return[r("em",[t._v(t._s(e.emptyFilteredText))])]}}],null,!0)},[t._v(" "),r("div",{staticClass:"text-center my-2",attrs:{slot:"table-busy"},slot:"table-busy"},[r("b-spinner",{staticClass:"align-middle"}),t._v(" "),r("strong",[t._v(t._s(t.loadingLabel))])],1)]),t._v(" "),t.totalRows>0?r("table-pagination",{attrs:{"total-rows":t.totalRows,"per-page":t.perPage,disabled:t.isBusy},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],2)}),[],!1,null,null,null).exports},505:(t,e,r)=>{r.d(e,{Z:()=>a});const n={props:{value:{required:!0},placeholder:{required:!1,type:String,default:function(){return this.$t("Type to search...")}},totalRows:{type:Number},isBusy:Boolean},computed:{filterText:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}};const a=(0,r(1900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-input-group",{staticClass:"mb-3"},[r("b-form-input",{attrs:{debounce:400,trim:"",type:"search",placeholder:t.placeholder,autocomplete:"off"},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.filterText=""}},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),r("b-input-group-append",{staticClass:"d-none d-sm-block"},[t.isBusy?r("b-input-group-text",[t._v("\n            ...\n        ")]):r("b-input-group-text",[t._v("\n            "+t._s(t.$t("{num} results",{num:t.totalRows}))+"\n        ")])],1)],1)}),[],!1,null,null,null).exports},6281:(t,e,r)=>{r.d(e,{Z:()=>a});const n={props:{value:Number,totalRows:Number,perPage:Number,disabled:Boolean},computed:{currentPage:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},itemsStart:function(){return(this.currentPage-1)*this.perPage+1},itemsEnd:function(){return Math.min(this.currentPage*this.perPage,this.totalRows)}}};const a=(0,r(1900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-row",{staticClass:"mb-3",attrs:{"align-v":"center"}},[r("b-col",[t.totalRows>0?r("b-pagination",{staticClass:"mb-0",attrs:{size:"sm","total-rows":t.totalRows,"per-page":t.perPage,disabled:t.disabled},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1),t._v(" "),r("b-col",{staticClass:"text-right",attrs:{sm:"auto"}},[r("small",[t._v("\n            "+t._s(t.$t("{x} out of {y}",{x:t.itemsStart+" - "+t.itemsEnd,y:t.totalRows}))+"\n        ")])])],1)}),[],!1,null,null,null).exports},7939:(t,e,r)=>{r.r(e),r.d(e,{default:()=>h});var n=r(7757),a=r.n(n),i=r(1581),o=r(6301);const s={props:{value:{type:String},hideLabel:Boolean,disabled:Boolean},computed:{modelValue:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{getValidationState:function(t){var e=t.dirty,r=t.validated,n=t.valid;return e||r?void 0===n?null:n:null},focus:function(){this.$refs.input.focus()}}},l={props:{disabled:Boolean},mixins:[s],data:function(){return{formData:this.initialFormData(),types:[{value:"visitor",text:this.$t("Visitor OHF")},{value:"participant",text:this.$t("Visitor Partner")},{value:"external",text:this.$t("Other")}]}},computed:{isDisabled:function(){return this.disabled}},watch:{disabled:function(t,e){var r=this;!t&&e&&this.$nextTick((function(){return r.focus()}))}},mounted:function(){this.focus()},methods:{submit:function(){var t=this;this.$refs.observer.validate().then((function(e){e&&t.onSubmit()}))},onSubmit:function(){"visitor"==this.formData.type?this.formData.organization="":"participant"==this.formData.type?this.formData.place_of_residence="":"external"==this.formData.type&&(this.formData.id_number="",this.formData.place_of_residence=""),this.$emit("submit",this.formData)},reset:function(){this.formData=this.initialFormData(),this.$refs.observer.reset(),this.focus()},initialFormData:function(){return{first_name:"",last_name:"",type:"visitor",id_number:"",place_of_residence:"",organization:""}},focus:function(){this.$refs.idNumberInput.focus()},changeType:function(t){var e=this;"external"==t||"participant"==t?this.$nextTick((function(){return e.$refs.organizationInput.focus()})):this.$nextTick((function(){return e.$refs.idNumberInput.focus()}))}}};var u=r(3379),c=r.n(u),d=r(6890),f={insert:"head",singleton:!1};c()(d.Z,f);d.Z.locals;var m=r(1900);function p(t,e,r,n,a,i,o){try{var s=t[i](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,a)}function b(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function o(t){p(i,n,a,o,s,"next",t)}function s(t){p(i,n,a,o,s,"throw",t)}o(void 0)}))}}const v={title:function(){return this.$t("Visitors")},components:{RegisterVisitorForm:(0,m.Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){var n=e.handleSubmit;return[r("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),n(t.onSubmit)}}},[r("b-form-row",["visitor"==t.formData.type||"participant"==t.formData.type?r("b-col",{attrs:{sm:""}},[r("validation-provider",{attrs:{name:t.$t("ID Number"),vid:"id_number",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(e){return[r("b-form-group",{staticClass:"required-marker",attrs:{label:t.$t("ID Number"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[r("b-form-input",{ref:"idNumberInput",attrs:{trim:"",autocomplete:"off",state:t.getValidationState(e),disabled:t.isDisabled},model:{value:t.formData.id_number,callback:function(e){t.$set(t.formData,"id_number",e)},expression:"formData.id_number"}})],1)]}}],null,!0)})],1):t._e()],1),t._v(" "),r("b-form-row",[r("b-col",{attrs:{sm:""}},[r("validation-provider",{attrs:{name:t.$t("First Name"),vid:"first_name",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[r("b-form-group",{attrs:{label:t.$t("First Name"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[r("b-form-input",{ref:"firstNameInput",attrs:{trim:"",autocomplete:"off",state:t.getValidationState(e),disabled:t.isDisabled},model:{value:t.formData.first_name,callback:function(e){t.$set(t.formData,"first_name",e)},expression:"formData.first_name"}})],1)]}}],null,!0)})],1),t._v(" "),r("b-col",{attrs:{sm:""}},[r("validation-provider",{attrs:{name:t.$t("Last Name"),vid:"last_name",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[r("b-form-group",{attrs:{label:t.$t("Last Name"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[r("b-form-input",{attrs:{trim:"",autocomplete:"off",state:t.getValidationState(e),disabled:t.isDisabled},model:{value:t.formData.last_name,callback:function(e){t.$set(t.formData,"last_name",e)},expression:"formData.last_name"}})],1)]}}],null,!0)})],1)],1),t._v(" "),r("b-form-row",[r("b-col",{staticClass:"pr-3",attrs:{cols:"auto"}},[r("b-form-group",{attrs:{label:t.$t("Type")}},[r("b-form-radio-group",{attrs:{options:t.types,stacked:""},on:{change:t.changeType},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}})],1)],1),t._v(" "),"visitor"==t.formData.type?r("b-col",{attrs:{sm:""}},[r("validation-provider",{attrs:{name:t.$t("Place of residence"),vid:"place_of_residence",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[r("b-form-group",{attrs:{label:t.$t("Place of residence"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[r("b-form-input",{attrs:{trim:"",autocomplete:"off",state:t.getValidationState(e),disabled:t.isDisabled},model:{value:t.formData.place_of_residence,callback:function(e){t.$set(t.formData,"place_of_residence",e)},expression:"formData.place_of_residence"}})],1)]}}],null,!0)})],1):t._e(),t._v(" "),"participant"==t.formData.type||"external"==t.formData.type?r("b-col",{attrs:{sm:""}},[r("validation-provider",{attrs:{name:t.$t("Organization"),vid:"organization",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[r("b-form-group",{attrs:{label:t.$t("Organization"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[r("b-form-input",{ref:"organizationInput",attrs:{trim:"",autocomplete:"off",state:t.getValidationState(e),disabled:t.isDisabled},model:{value:t.formData.organization,callback:function(e){t.$set(t.formData,"organization",e)},expression:"formData.organization"}})],1)]}}],null,!0)})],1):t._e()],1),t._v(" "),r("p",[r("b-button",{attrs:{variant:"primary",type:"submit",disabled:t.isDisabled}},[r("font-awesome-icon",{attrs:{icon:"check"}}),t._v("\n                "+t._s(t.$t("Register"))+"\n            ")],1),t._v(" "),r("b-button",{attrs:{variant:"secondary",type:"button",disabled:t.isDisabled},on:{click:t.reset}},[r("font-awesome-icon",{attrs:{icon:"eraser"}}),t._v("\n                "+t._s(t.$t("Reset"))+"\n            ")],1)],1)],1)]}}])})}),[],!1,null,null,null).exports,BaseTable:r(6951).Z},data:function(){var t=this;return{isBusy:!1,showRegisterForm:!1,fields:[{key:"last_name",label:this.$t("Last Name"),sortable:!0,tdClass:"align-middle"},{key:"first_name",label:this.$t("First Name"),sortable:!0,tdClass:"align-middle"},{key:"type",label:this.$t("Type"),tdClass:"align-middle",formatter:this.getTypeLabel},{key:"additional_info",label:this.$t("Additional Information"),tdClass:"align-middle",formatter:function(e,r,n){var a=Array();return n.id_number&&a.push("".concat(t.$t("ID Number"),": ").concat(n.id_number)),n.place_of_residence&&a.push("".concat(t.$t("Place of residence"),": ").concat(n.place_of_residence)),n.activity&&a.push("".concat(t.$t("Activity / Program"),": ").concat(n.activity)),n.organization&&a.push("".concat(t.$t("Organization"),": ").concat(n.organization)),a.join(", ")}},{key:"entered_at",label:this.$t("Time"),sortable:!0,sortDirection:"desc",tdClass:"align-middle",formatter:this.timeFormat,class:"fit"},{key:"checkout",label:this.$t("Checkout"),class:"fit"}],currentlyVisiting:{}}},computed:{count:function(){return Object.values(this.currentlyVisiting).reduce((function(t,e){return t+e}),0)}},methods:{fetchData:function(t){return b(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.Z.listCurrent(t));case 1:case"end":return e.stop()}}),e)})))()},registerVisitor:function(t){var e=this;return b(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.isBusy=!0,r.prev=1,r.next=4,o.Z.checkin(t);case 4:(0,i.OV)(e.$t("Checked-in.")),e.isBusy=!1,e.$refs.table.refresh(),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),alert(r.t0),e.isBusy=!1;case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))()},checkoutVisitor:function(t){var e=this;return b(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.isBusy=!0,r.prev=1,r.next=4,o.Z.checkout(t);case 4:e.isBusy=!1,(0,i.OV)(e.$t("Checked out.")),e.$refs.table.refresh(),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(1),alert(r.t0),e.isBusy=!1;case 13:case"end":return r.stop()}}),r,null,[[1,9]])})))()},checkoutAll:function(){var t=this;return b(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!confirm(t.$t("Really checkout everyone?"))){e.next=14;break}return t.isBusy=!0,e.prev=2,e.next=5,o.Z.checkoutAll();case 5:t.isBusy=!1,(0,i.OV)(t.$t("Everyone has been checked out.")),t.$refs.table.refresh(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),alert(e.t0),t.isBusy=!1;case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()},getTypeLabel:function(t){return"visitor"==t?this.$t("Visitor OHF"):"visitors"==t?this.$t("Visitors OHF"):"participant"==t?this.$t("Visitor Partner"):"participants"==t?this.$t("Visitors Partner"):"staff"==t?this.$t("Volunteer / Staff"):"external"==t?this.$t("Other"):t}}};const h=(0,m.Z)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-container",{staticClass:"px-0",attrs:{fluid:"md"}},[t.showRegisterForm?r("b-card",{staticClass:"mb-4",attrs:{"body-class":"pb-0","header-class":"d-flex justify-content-between"},scopedSlots:t._u([{key:"header",fn:function(){return[r("span",[t._v(t._s(t.$t("Check-in")))]),t._v(" "),r("b-button",{attrs:{variant:"link",size:"sm"},on:{click:function(e){t.showRegisterForm=!1}}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)]},proxy:!0}],null,!1,3660364019)},[t._v(" "),r("register-visitor-form",{attrs:{disabled:t.isBusy},on:{submit:t.registerVisitor}})],1):t._e(),t._v(" "),t.showRegisterForm?t._e():r("b-row",{staticClass:"mb-4"},[r("b-col",[r("b-button",{attrs:{variant:"primary"},on:{click:function(e){t.showRegisterForm=!0}}},[r("font-awesome-icon",{attrs:{icon:"sign-in-alt"}}),t._v("\n                "+t._s(t.$t("Check-in"))+"\n            ")],1)],1),t._v(" "),r("b-col",{staticClass:"text-right"},[r("b-dropdown",{staticClass:"d-block d-md-none",attrs:{right:"",text:t.$t("Actions")}},[0!==t.count?r("b-dropdown-item",{on:{click:t.checkoutAll}},[r("font-awesome-icon",{attrs:{icon:"door-closed"}}),t._v("\n                    "+t._s(t.$t("Checkout everyone"))+"\n                ")],1):t._e()],1),t._v(" "),r("span",{staticClass:"d-none d-md-inline"},[0!==t.count?r("b-button",{attrs:{variant:"secondary",disabled:t.isBusy},on:{click:t.checkoutAll}},[r("font-awesome-icon",{attrs:{icon:"door-closed"}}),t._v("\n                    "+t._s(t.$t("Checkout everyone"))+"\n                ")],1):t._e()],1)],1)],1),t._v(" "),r("h3",[t._v(t._s(t.$t("Current Visitors")))]),t._v(" "),r("p",{staticClass:"text-muted"},[t._l(t.currentlyVisiting,(function(e,n){return r("span",{key:n},[t._v("\n            "+t._s(t.getTypeLabel(n))+": "),r("strong",[t._v(t._s(e))]),t._v(",\n        ")])})),t._v("\n        "+t._s(t.$t("Total"))+": "),r("strong",[t._v(t._s(t.count))])],2),t._v(" "),r("base-table",{ref:"table",attrs:{id:"visitors-table",fields:t.fields,"api-method":t.fetchData,"default-sort-by":"entered_at","default-sort-desc":"","empty-text":t.$t("No data registered."),"items-per-page":100},on:{metadata:function(e){t.currentlyVisiting=e.currently_visiting}},scopedSlots:t._u([{key:"cell(checkout)",fn:function(e){return[r("b-button",{attrs:{size:"sm",variant:"primary",disabled:t.isBusy},on:{click:function(r){return t.checkoutVisitor(e.item.id)}}},[r("font-awesome-icon",{attrs:{icon:"sign-out-alt"}}),t._v("\n                "+t._s(t.$t("Checkout"))+"\n            ")],1)]}}])})],1)}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=visitors.js.map?id=1e4299a06c959d2a0728