"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[640],{5817:(t,e,n)=>{n.d(e,{Z:()=>d});var r=n(7757),a=n.n(r),o=n(7202);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){c(o,r,a,s,i,"next",t)}function i(t){c(o,r,a,s,i,"throw",t)}s(void 0)}))}}const d={list:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.accounting.budgets.index",t),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},store:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.accounting.budgets.store"),e.next=3,o.hi.post(n,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},find:function(t){var e=arguments;return l(a().mark((function n(){var r,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.length>1&&void 0!==e[1]?e[1]:{},s=(0,o.BC)("api.accounting.budgets.show",i({budget:t},r)),n.next=4,o.hi.get(s);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})))()},update:function(t,e){return l(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.accounting.budgets.update",t),n.next=3,o.hi.put(r,e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},delete:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.accounting.budgets.destroy",t),e.next=3,o.hi.delete(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},transactions:function(t){var e=arguments;return l(a().mark((function n(){var r,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.length>1&&void 0!==e[1]?e[1]:{},s=(0,o.BC)("api.accounting.budgets.transactions",i({budget:t},r)),n.next=4,o.hi.get(s);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})))()},donations:function(t){var e=arguments;return l(a().mark((function n(){var r,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.length>1&&void 0!==e[1]?e[1]:{},s=(0,o.BC)("api.accounting.budgets.donations",i({budget:t},r)),n.next=4,o.hi.get(s);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})))()},names:function(){return l(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,o.BC)("api.accounting.budgets.names"),t.next=3,o.hi.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},export:function(t,e){return l(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.accounting.budgets.export",i({budget:t},e)),n.next=3,o.hi.download(r);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()}}},6909:(t,e,n)=>{n.d(e,{Z:()=>u});var r=n(7757),a=n.n(r),o=n(7202);function s(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){s(o,r,a,i,u,"next",t)}function u(t){s(o,r,a,i,u,"throw",t)}i(void 0)}))}}const u={list:function(t){return i(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donations.index",t),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},find:function(t){return i(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donations.show",t),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},update:function(t,e){return i(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.fundraising.donations.update",t),n.next=3,o.hi.put(r,e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},delete:function(t){return i(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donations.destroy",t),e.next=3,o.hi.delete(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},listChannels:function(){return i(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,o.BC)("api.fundraising.donations.channels"),t.next=3,o.hi.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},listCurrencies:function(){return i(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,o.BC)("api.fundraising.donations.currencies"),t.next=3,o.hi.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},import:function(t,e){return i(a().mark((function n(){var r,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=new FormData).append("type",t),r.append("file",e),s=(0,o.BC)("api.fundraising.donations.import"),n.next=6,o.hi.postFormData(s,r);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))()}}},195:(t,e,n)=>{n.d(e,{Z:()=>d});var r=n(7757),a=n.n(r),o=n(7202);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){c(o,r,a,s,i,"next",t)}function i(t){c(o,r,a,s,i,"throw",t)}s(void 0)}))}}const d={list:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donors.index",t),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},store:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donors.store"),e.next=3,o.hi.post(n,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},find:function(t){var e=arguments;return l(a().mark((function n(){var r,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.length>1&&void 0!==e[1]&&e[1],s=(0,o.BC)("api.fundraising.donors.show",t),r&&(s+="?extended"),n.next=5,o.hi.get(s);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))()},update:function(t,e){return l(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.fundraising.donors.update",t),n.next=3,o.hi.put(r,e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},delete:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donors.destroy",t),e.next=3,o.hi.delete(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},listSalutations:function(){return l(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,o.BC)("api.fundraising.donors.salutations"),t.next=3,o.hi.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},listDonations:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donors.donations.index",t),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},storeDonation:function(t,e){return l(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.fundraising.donors.donations.store",t),n.next=3,o.hi.post(r,e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},listComments:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donors.comments.index",t),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},storeComment:function(t,e){return l(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.fundraising.donors.comments.store",t),n.next=3,o.hi.post(r,e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},listTags:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.tags.index",{filter:t}),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},listDonorsTags:function(t){return l(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.fundraising.donors.tags.index",t),e.next=3,o.hi.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},storeDonorsTags:function(t,e){return l(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.fundraising.donors.tags.store",t),n.next=3,o.hi.post(r,e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},names:function(){return l(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,o.BC)("api.fundraising.donors.names"),t.next=3,o.hi.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},budgets:function(t){var e=arguments;return l(a().mark((function n(){var r,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.length>1&&void 0!==e[1]?e[1]:{},s=(0,o.BC)("api.fundraising.donors.budgets",i({donor:t},r)),n.next=4,o.hi.get(s);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})))()}}},7508:(t,e,n)=>{n.d(e,{Z:()=>a});const r={props:["value"]};const a=(0,n(1900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-alert",{attrs:{variant:"danger",show:null!=t.value}},[n("b-row",{attrs:{"align-v":"center"}},[n("b-col",[n("font-awesome-icon",{attrs:{icon:"times-circle"}}),t._v("\n            "+t._s(t.$t("Error: {err}",{err:t.value}))+"\n        ")],1),t._v(" "),n("b-col",{attrs:{sm:"auto"}},[n("b-button",{staticClass:"float-right",attrs:{variant:"danger",size:"sm"},on:{click:function(e){return t.$emit("retry")}}},[n("font-awesome-icon",{attrs:{icon:"redo"}}),t._v("\n                "+t._s(t.$t("Retry"))+"\n            ")],1)],1)],1)],1)}),[],!1,null,null,null).exports},414:(t,e,n)=>{n.d(e,{Z:()=>_});var r=n(7757),a=n.n(r),o=n(7202);function s(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){s(o,r,a,i,u,"next",t)}function u(t){s(o,r,a,i,u,"throw",t)}i(void 0)}))}}const u=function(t,e){return i(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,o.BC)("api.comments.update",t),n.next=3,o.hi.put(r,e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},c=function(t){return i(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.BC)("api.comments.destroy",t),e.next=3,o.hi.delete(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()};const l={props:{comment:{type:Object,required:!1},disabled:Boolean},data:function(){return{content:this.comment?this.comment.content:""}},methods:{submit:function(){this.$emit("submit",{content:this.content})},cancel:function(){this.$emit("cancel")}}};var d=n(1900);const f=(0,d.Z)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{on:{submit:function(e){return e.preventDefault(),t.submit()}}},[n("p",[n("b-form-textarea",{attrs:{rows:"3","max-rows":"6",placeholder:t.$t("Add comment"),disabled:t.disabled,autofocus:""},model:{value:t.content,callback:function(e){t.content="string"==typeof e?e.trim():e},expression:"content"}})],1),t._v(" "),n("p",[n("b-button",{attrs:{type:"submit",variant:"primary",disabled:t.disabled||0==t.content.length}},[n("font-awesome-icon",{attrs:{icon:"check"}}),t._v("\n            "+t._s(t.$t("Save"))+"\n        ")],1),t._v(" "),n("b-button",{attrs:{type:"button",variant:"secondary",disabled:t.disabled},on:{click:function(e){return t.cancel()}}},[n("font-awesome-icon",{attrs:{icon:"times"}}),t._v("\n            "+t._s(t.$t("Cancel"))+"\n        ")],1)],1)])}),[],!1,null,null,null).exports;var m=n(7554);const p={components:{Nl2br:n.n(m)()},props:{comment:{required:!0,type:Object},busy:Boolean},data:function(){return{dateFromNow:!0}},computed:{userName:function(){return this.comment.user_name?this.comment.user_name:this.$t("Unknown")},formattedDate:function(){var t=this.toDateString(this.comment.created_at);if(this.comment.created_at!=this.comment.updated_at){var e=this.$t("Updated :time.",{time:this.toDateString(this.comment.updated_at)});t+=" (".concat(e,")")}return t}},methods:{toDateString:function(t){return this.dateFromNow?this.timeFromNow(t):this.dateTimeFormat(t)}}};const v=(0,d.Z)(p,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-card",{staticClass:"mb-3",attrs:{"footer-class":"d-flex justify-content-between align-items-center py-1"},scopedSlots:t._u([{key:"footer",fn:function(){return[n("small",[t.comment.user_url?n("a",{attrs:{href:t.comment.user_url,target:"_blank"}},[t._v(t._s(t.userName))]):n("span",[t._v(t._s(t.userName))]),t._v(",\n            "),n("span",{on:{click:function(e){t.dateFromNow=!t.dateFromNow}}},[t._v("\n                "+t._s(t.formattedDate)+"\n            ")])]),t._v(" "),n("span",[t.comment.can_update?n("b-button",{attrs:{variant:"link",size:"sm",disabled:t.busy},on:{click:function(e){return t.$emit("edit")}}},[n("font-awesome-icon",{attrs:{icon:"pencil-alt"}})],1):t._e(),t._v(" "),t.comment.can_delete?n("b-button",{attrs:{variant:"link",size:"sm",disabled:t.busy},on:{click:function(e){return t.$emit("delete")}}},[n("font-awesome-icon",{attrs:{icon:"trash"}})],1):t._e()],1)]},proxy:!0}])},[n("b-card-text",[n("nl2br",{attrs:{tag:"span",text:t.comment.content}})],1)],1)}),[],!1,null,null,null).exports;var h=n(1581);function b(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function g(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){b(o,r,a,s,i,"next",t)}function i(t){b(o,r,a,s,i,"throw",t)}s(void 0)}))}}const y={components:{CommentEditor:f,CommentCard:v},props:{apiListMethod:{type:Function,required:!0},apiCreateMethod:{type:Function,required:!1}},data:function(){return{comments:[],editComment:null,editor:!1,error:null,loaded:!1,busy:!1}},mounted:function(){this.loadComments()},watch:{comments:function(t){this.$emit("count",t.length)}},methods:{loadComments:function(){var t=this;return g(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.error=null,e.prev=1,e.next=4,t.apiListMethod();case 4:n=e.sent,t.comments=n.data,t.loaded=!0,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t.error=e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},openEditor:function(){this.editor=!0},closeEditor:function(){this.editor=!1},addComment:function(t){var e=this;return g(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.error=null,e.busy=!0,n.prev=2,n.next=5,e.apiCreateMethod(t);case 5:r=n.sent,e.comments.push(r.data),e.closeEditor(),(0,h.OV)(r.message),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),e.error=n.t0;case 14:e.busy=!1;case 15:case"end":return n.stop()}}),n,null,[[2,11]])})))()},updateComment:function(t){var e=this;return g(a().mark((function n(){var r,o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.error=null,e.busy=!0,n.prev=2,n.next=5,u(t.id,t);case 5:r=n.sent,(o=e.comments.findIndex((function(e){return e.id===t.id})))>=0&&e.$set(e.comments,o,r.data),e.editComment=null,(0,h.OV)(r.message),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(2),e.error=n.t0;case 15:e.busy=!1;case 16:case"end":return n.stop()}}),n,null,[[2,12]])})))()},deleteComment:function(t){var e=this;return g(a().mark((function n(){var r,o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!confirm(e.$t("Really delete this comment?"))){n.next=15;break}return e.busy=!0,n.prev=2,n.next=5,c(t.id);case 5:r=n.sent,(o=e.comments.findIndex((function(e){return e.id===t.id})))>=0&&e.comments.splice(o,1),(0,h.OV)(r.message),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),e.error=n.t0;case 14:e.busy=!1;case 15:case"end":return n.stop()}}),n,null,[[2,11]])})))()}}};const _=(0,d.Z)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.error?n("b-alert",{attrs:{variant:"danger",show:""}},[t._v("\n        "+t._s(t.error)+"\n    ")]):t._e(),t._v(" "),t.loaded||t.error?t.comments.length>0?t._l(t.comments,(function(e){return n("div",{key:e.id},[t.editComment==e.id?n("comment-editor",{attrs:{comment:e,disabled:t.busy},on:{submit:function(n){return t.updateComment(Object.assign({},e,n))},cancel:function(e){t.editComment=null}}}):n("comment-card",{attrs:{comment:e,busy:t.busy},on:{edit:function(n){t.editComment=e.id,t.editor=!1},delete:function(n){return t.deleteComment(e)}}})],1)})):n("p",[n("em",[t._v(t._s(t.$t("No comments found.")))])]):n("p",[n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}}),t._v("\n        "+t._s(t.$t("Loading..."))+"\n    ")],1),t._v(" "),t.apiCreateMethod&&null==t.editComment?[t.editor?n("comment-editor",{attrs:{disabled:t.busy},on:{submit:function(e){return t.addComment(e)},cancel:function(e){return t.closeEditor()}}}):n("p",[n("b-button",{attrs:{variant:"primary",disabled:t.busy},on:{click:function(e){t.openEditor(),t.editComment=null}}},[n("font-awesome-icon",{attrs:{icon:"plus-circle"}}),t._v("\n                "+t._s(t.$t("Add comment"))+"\n            ")],1)],1)]:t._e()],2)}),[],!1,null,null,null).exports},7236:(t,e,n)=>{n.d(e,{Z:()=>a});const r={props:{value:{required:!0,type:String},iconOnly:Boolean,labelOnly:Boolean},computed:{mailToHref:function(){return"mailto:".concat(this.value)}}};const a=(0,n(1900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t.iconOnly?n("a",{staticClass:"btn btn-light btn-sm",attrs:{href:t.mailToHref}},[n("font-awesome-icon",{attrs:{icon:"envelope"}})],1):[t.labelOnly?t._e():n("font-awesome-icon",{attrs:{icon:"envelope"}}),t._v(" "),n("a",{attrs:{href:t.mailToHref}},[t._v(t._s(t.value))])]],2)}),[],!1,null,null,null).exports},4744:(t,e,n)=>{n.d(e,{Z:()=>a});const r={props:{value:{required:!0,type:String},iconOnly:Boolean,mobile:Boolean},computed:{telHref:function(){return"tel:".concat(this.value)},icon:function(){return this.mobile?"mobile-alt":"phone"}}};const a=(0,n(1900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t.iconOnly?n("a",{staticClass:"btn btn-light btn-sm",attrs:{href:t.telHref}},[n("font-awesome-icon",{attrs:{icon:t.icon}})],1):[n("font-awesome-icon",{attrs:{icon:t.icon}}),t._v(" "),n("a",{attrs:{href:t.telHref}},[t._v(t._s(t.value))])]],2)}),[],!1,null,null,null).exports},3609:(t,e,n)=>{n.d(e,{Z:()=>f});var r=n(7757),a=n.n(r),o=n(381),s=n.n(o),i=n(5817);function u(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const d={props:{donation:{type:Object,required:!1},currencies:{required:!0,type:Object},channels:{required:!0,type:Array},baseCurrency:{required:!0},disabled:Boolean},data:function(){return{loaded:!1,form:this.donation?{date:this.donation.date,currency:this.donation.currency,amount:this.donation.amount,exchange_rate:this.donation.exchange_rate,channel:this.donation.channel,purpose:this.donation.purpose,reference:this.donation.reference,in_name_of:this.donation.in_name_of,thanked:null!=this.donation.thanked,budget_id:this.donation.budget_id}:{date:s()().format(s().HTML5_FMT.DATE),currency:this.baseCurrency,amount:null,exchange_rate:null,channel:null,purpose:null,reference:null,in_name_of:null,thanked:!1,budget_id:null},budgets:[]}},computed:{maxDate:function(){return s()().format(s().HTML5_FMT.DATE)},currencyOptions:function(){return Object.entries(this.currencies).map((function(t){return{value:t[0],text:t[1]}}))},budgetOptions:function(){var t=this,e=[{value:null,text:"- ".concat(this.$t("No budget")," -")}];return e.push.apply(e,c(this.budgets.filter((function(e){var n;return!e.is_completed||(null===(n=t.transaction)||void 0===n?void 0:n.budget_id)==e.id})).map((function(t){return{value:t.id,text:t.name}})))),e}},created:function(){var t,e=this;return(t=a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.Z.names();case 2:e.budgets=t.sent,e.loaded=!0;case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){u(o,r,a,s,i,"next",t)}function i(t){u(o,r,a,s,i,"throw",t)}s(void 0)}))})()},methods:{getValidationState:function(t){var e=t.dirty,n=t.validated,r=t.valid;return e||n?void 0===r?null:r:null},onSubmit:function(){this.$emit("submit",this.form)},onDelete:function(){confirm(this.$t("Do you really want to delete this donation?"))&&this.$emit("delete")}}};const f=(0,n(1900).Z)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("validation-observer",{ref:"observer",attrs:{slim:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.handleSubmit,a=e.invalid;return[n("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),r(t.onSubmit)}}},[n("b-form-row",[n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Date"),vid:"date",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Date"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-datepicker",{attrs:{max:t.maxDate,required:"",state:t.getValidationState(e)},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:"auto"}},[n("validation-provider",{attrs:{name:t.$t("Currency"),vid:"currency",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Currency"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-select",{attrs:{options:t.currencyOptions,required:"",state:t.getValidationState(e)},model:{value:t.form.currency,callback:function(e){t.$set(t.form,"currency",e)},expression:"form.currency"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Amount"),vid:"amount",rules:{required:!0,decimal:!0}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Amount"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{ref:"amount",attrs:{type:"number",min:"1",required:"",step:"any",autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1)]}}],null,!0)})],1),t._v(" "),t.form.currency!=t.baseCurrency?n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Exchange rate"),vid:"exchange_rate",rules:{decimal:!0}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Exchange rate"),description:t.$t("Leave empty for automatic calculation"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{type:"number",min:"0",step:"any",autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.exchange_rate,callback:function(e){t.$set(t.form,"exchange_rate",e)},expression:"form.exchange_rate"}})],1)]}}],null,!0)})],1):t._e()],1),t._v(" "),n("b-form-row",[n("b-col",{attrs:{md:"4"}},[n("validation-provider",{attrs:{name:t.$t("Channel"),vid:"channel",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Channel"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{required:"",list:"channel-list",autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.channel,callback:function(e){t.$set(t.form,"channel",e)},expression:"form.channel"}})],1),t._v(" "),n("b-form-datalist",{attrs:{id:"channel-list",options:t.channels}})]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Purpose"),vid:"purpose",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Purpose"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{state:t.getValidationState(e)},model:{value:t.form.purpose,callback:function(e){t.$set(t.form,"purpose",e)},expression:"form.purpose"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Budget"),vid:"budget_id",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Budget"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-select",{attrs:{options:t.budgetOptions,disabled:!t.loaded,state:t.getValidationState(e)},model:{value:t.form.budget_id,callback:function(e){t.$set(t.form,"budget_id",e)},expression:"form.budget_id"}})],1)]}}],null,!0)})],1)],1),t._v(" "),n("b-form-row",[n("b-col",{attrs:{md:"4"}},[n("validation-provider",{attrs:{name:t.$t("Reference"),vid:"reference",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Reference"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("In the name of"),vid:"in_name_of",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("In the name of")+"...",state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.in_name_of,callback:function(e){t.$set(t.form,"in_name_of",e)},expression:"form.in_name_of"}})],1)]}}],null,!0)})],1)],1),t._v(" "),n("p",[n("b-form-checkbox",{model:{value:t.form.thanked,callback:function(e){t.$set(t.form,"thanked",e)},expression:"form.thanked"}},[t._v("\n                "+t._s(t.$t("Donor has been thanked"))+"\n            ")])],1),t._v(" "),n("p",{staticClass:"d-flex justify-content-between align-items-start"},[n("span",[n("b-button",{attrs:{type:"submit",variant:"primary",disabled:t.disabled||a}},[n("font-awesome-icon",{attrs:{icon:"check"}}),t._v("\n                    "+t._s(t.donation?t.$t("Update"):t.$t("Add"))+"\n                ")],1),t._v(" "),n("b-button",{attrs:{variant:"link",disabled:t.disabled},on:{click:function(e){return t.$emit("cancel")}}},[t._v("\n                    "+t._s(t.$t("Cancel"))+"\n                ")])],1),t._v(" "),t.donation&&t.donation.can_delete?n("b-button",{staticClass:"text-danger",attrs:{variant:"link",disabled:t.disabled},on:{click:t.onDelete}},[t._v("\n                "+t._s(t.$t("Delete"))+"\n            ")]):t._e()],1)],1)]}}])})}),[],!1,null,null,null).exports},7808:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var r=n(7757),a=n.n(r),o=n(8374),s=n(195);function i(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}const u={components:{BaseTable:o.Z},props:{id:{required:!0}},data:function(){return{fields:[{key:"name",label:this.$t("Name")},{key:"agreed_amount_formatted",label:this.$t("Agreed amount"),class:"fit text-right"},{key:"balance_formatted",label:this.$t("Balance"),class:"fit text-right"},{key:"num_transactions",label:this.$t("Transactions"),class:"fit text-right"},{key:"closed_at",label:this.$t("Closing date"),class:"fit",formatter:this.dateFormat},{key:"is_completed",label:this.$t("Completed"),class:"fit text-center"}]}},methods:{fetchData:function(t){var e,n=this;return(e=a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.budgets(n.id,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(t){i(o,r,a,s,u,"next",t)}function u(t){i(o,r,a,s,u,"throw",t)}s(void 0)}))})()},rowClass:function(t,e){if(t&&"row"===e)return t.is_completed?"table-secondary":void 0}}};const c=(0,n(1900).Z)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("base-table",{attrs:{id:"donor-budgets-table",fields:t.fields,"api-method":t.fetchData,"default-sort-by":"name","empty-text":t.$t("No budgets found."),"items-per-page":25,"no-filter":"","tbody-tr-class":t.rowClass},scopedSlots:t._u([{key:"cell(name)",fn:function(e){return[n("router-link",{attrs:{to:{name:"accounting.budgets.show",params:{id:e.item.id}}}},[t._v("\n                "+t._s(e.value)+"\n            ")])]}},{key:"cell(is_completed)",fn:function(t){return[n("font-awesome-icon",{attrs:{icon:t.value?"check":"times"}})]}}])})],1)}),[],!1,null,null,null).exports},5065:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var r=n(7757),a=n.n(r),o=n(414),s=n(195);function i(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}const u={components:{CommentsList:o.Z},props:{id:{required:!0}},data:function(){return{canCreate:!1}},methods:{listComments:function(){var t,e=this;return(t=a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.Z.listComments(e.id);case 2:return n=t.sent,e.canCreate=n.meta.can_create,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){i(o,r,a,s,u,"next",t)}function u(t){i(o,r,a,s,u,"throw",t)}s(void 0)}))})()},storeComment:function(t){return s.Z.storeComment(this.id,t)}}};const c=(0,n(1900).Z)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-3"},[n("comments-list",{key:t.id,attrs:{"api-list-method":t.listComments,"api-create-method":t.canCreate?t.storeComment:null},on:{count:function(e){return t.$emit("count",{type:"comments",value:e})}}})],1)}),[],!1,null,null,null).exports},7822:(t,e,n)=>{n.r(e),n.d(e,{default:()=>O});var r=n(7757),a=n.n(r),o=n(195),s=n(6054),i=n(4744),u=n(7236),c=n(6486),l=n.n(c),d=n(8634),f=n.n(d);function m(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){v(o,r,a,s,i,"next",t)}function i(t){v(o,r,a,s,i,"throw",t)}s(void 0)}))}}const b={props:{value:{required:!0,type:Array},suggestions:{required:!1,type:Array,default:function(){return[]}},suggestionsProvider:{required:!1,type:Function},preload:Boolean,disabled:Boolean},data:function(){return{tagify:void 0}},computed:{valueString:function(){return JSON.stringify(this.value)}},mounted:function(){var t=this;this.tagify=new(f())(this.$refs.input,{whitelist:this.suggestions}),this.$refs.input.addEventListener("change",(function(){t.$emit("input",t.tagify.value.map((function(t){return t.value})))})),this.suggestionsProvider&&(this.preload?this.preloadTags():this.tagify.on("input",l().debounce((function(e){return t.fetchTags(e.detail.value)}),300)))},methods:{preloadTags:function(){var t=this;return h(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.suggestionsProvider();case 3:n=e.sent,t.tagify.settings.whitelist=n.data.map((function(t){return t.name})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},fetchTags:function(t){var e=this;return h(a().mark((function n(){var r,o,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t.length<=1)){n.next=2;break}return n.abrupt("return");case 2:return e.tagify.settings.whitelist.length=0,e.tagify.loading(!0).dropdown.hide.call(e.tagify),n.prev=4,n.next=7,e.suggestionsProvider(t);case 7:o=n.sent,s=o.data.map((function(t){return t.name})),(r=e.tagify.settings.whitelist).splice.apply(r,[0,s.length].concat(m(s))),e.tagify.loading(!1).dropdown.show.call(e.tagify,t),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(4),console.error(n.t0);case 16:case"end":return n.stop()}}),n,null,[[4,13]])})))()}}};var g=n(1900);function y(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const w={components:{TagInput:(0,g.Z)(b,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{ref:"input",staticClass:"tags",attrs:{disabled:t.disabled,autofocus:""},domProps:{value:t.valueString}})}),[],!1,null,null,null).exports},props:{tags:{required:!0,type:Array},suggestions:{required:!1,type:Array,default:function(){return[]}},suggestionsProvider:{required:!1,type:Function},preload:Boolean,disabled:Boolean},data:function(){return{value:y(this.tags)}},methods:{submit:function(){this.$emit("submit",this.value)}}};const x=(0,g.Z)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"form-row align-items-center",on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[n("div",{staticClass:"col"},[n("tag-input",{attrs:{suggestions:t.suggestions,"suggestions-provider":t.suggestionsProvider,preload:t.preload,disabled:t.disabled},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),n("div",{staticClass:"col-auto"},[n("b-button",{key:"submit",attrs:{variant:"primary",size:"sm",type:"submit",disabled:t.disabled}},[n("font-awesome-icon",{attrs:{icon:"check"}})],1),t._v(" "),n("b-button",{key:"cancel",attrs:{variant:"secondary",size:"sm",disabled:t.disabled},on:{click:function(e){return t.$emit("cancel")}}},[n("font-awesome-icon",{attrs:{icon:"times"}})],1)],1)])}),[],!1,null,null,null).exports;var k=n(1581);function $(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function C(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){$(o,r,a,s,i,"next",t)}function i(t){$(o,r,a,s,i,"throw",t)}s(void 0)}))}}const S={components:{TagEditor:x},props:{listProvider:{required:!0,type:Function},storeProvider:{required:!1,type:Function},suggestionsProvider:{required:!1,type:Function},preload:Boolean},data:function(){return{tags:[],error:null,loaded:!1,busy:!1,editor:!1}},mounted:function(){this.loadTags()},computed:{editIcon:function(){return this.tags.length>0?"pencil-alt":"plus-circle"},tagNames:function(){return this.tags.map((function(t){return t.name}))}},methods:{loadTags:function(){var t=this;return C(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.error=null,e.prev=1,e.next=4,t.listProvider();case 4:n=e.sent,t.tags=n.data,t.loaded=!0,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t.error=e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},storeTags:function(t){var e=this;return C(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!l().isEqual(e.tagNames,t)){n.next=3;break}return e.editor=!1,n.abrupt("return");case 3:return e.error=null,e.busy=!0,n.prev=5,n.next=8,e.storeProvider({tags:t});case 8:r=n.sent,e.tags=r.data,e.editor=!1,(0,k.OV)(r.message),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(5),alert(n.t0);case 17:e.busy=!1;case 18:case"end":return n.stop()}}),n,null,[[5,14]])})))()}}};const D=(0,g.Z)(S,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.error?n("span",{staticClass:"text-danger"},[t._v("\n        "+t._s(t.error)+"\n    ")]):t.loaded?t.editor?n("tag-editor",{attrs:{tags:t.tagNames,disabled:t.busy,"suggestions-provider":t.suggestionsProvider,preload:t.preload},on:{cancel:function(e){t.editor=!1},submit:t.storeTags}}):[t._l(t.tags,(function(e,r){return[n("b-button",{key:e.slug,attrs:{variant:"secondary",size:"sm"},on:{click:function(n){return t.$emit("tag-click",e.slug)}}},[t._v("\n                "+t._s(e.name)+"\n            ")]),r+1<t.tags.length?[t._v(t._s(" "))]:t._e()]})),t._v(" "),t.storeProvider?n("b-button",{key:"edit",attrs:{variant:"primary",size:"sm"},on:{click:function(e){t.editor=!0}}},[n("font-awesome-icon",{attrs:{icon:t.editIcon}})],1):t._e()]:n("span",[n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}}),t._v("\n        "+t._s(t.$t("Loading..."))+"\n    ")],1)],2)}),[],!1,null,null,null).exports;function P(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function B(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){P(o,r,a,s,i,"next",t)}function i(t){P(o,r,a,s,i,"throw",t)}s(void 0)}))}}const T={components:{TwoColListGroupItem:s.Z,EmailLink:u.Z,PhoneLink:i.Z,TagManager:D},props:{id:{required:!0}},data:function(){return{donor:null}},watch:{$route:function(){this.fetchData()}},created:function(){var t=this;return B(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.fetchData();case 1:case"end":return e.stop()}}),e)})))()},methods:{fetchData:function(){var t=this;return B(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.find(t.id,!0);case 3:n=e.sent,t.donor=n.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},listAllTags:o.Z.listTags,listTags:function(){return o.Z.listDonorsTags(this.id)},storeTags:function(t){return o.Z.storeDonorsTags(this.id,t)}}};const O=(0,g.Z)(T,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.donor?n("b-list-group",{attrs:{flush:""}},[t.donor.salutation?n("two-col-list-group-item",{attrs:{title:t.$t("Salutation")}},[t._v("\n        "+t._s(t.donor.salutation)+"\n    ")]):t._e(),t._v(" "),t.donor.first_name||t.donor.last_name?n("two-col-list-group-item",{attrs:{title:t.$t("Name")}},[t._v("\n        "+t._s(t.donor.first_name)+" "+t._s(t.donor.last_name)+"\n    ")]):t._e(),t._v(" "),t.donor.company?n("two-col-list-group-item",{attrs:{title:t.$t("Company")}},[t._v("\n        "+t._s(t.donor.company)+"\n    ")]):t._e(),t._v(" "),t.donor.fullAddress?n("two-col-list-group-item",{attrs:{title:t.$t("Address")}},[n("span",{staticStyle:{"white-space":"pre"}},[t._v(t._s(t.donor.fullAddress))])]):t._e(),t._v(" "),t.donor.email?n("two-col-list-group-item",{attrs:{title:t.$t("E-Mail Address")}},[n("email-link",{attrs:{value:t.donor.email}})],1):t._e(),t._v(" "),t.donor.phone?n("two-col-list-group-item",{attrs:{title:t.$t("Phone")}},[n("phone-link",{attrs:{value:t.donor.phone}})],1):t._e(),t._v(" "),t.donor.language?n("two-col-list-group-item",{attrs:{title:t.$t("Correspondence language")}},[t._v("\n        "+t._s(t.donor.language)+"\n    ")]):t._e(),t._v(" "),n("two-col-list-group-item",{attrs:{title:t.$t("Registered")}},[t._v("\n        "+t._s(t._f("dateTimeFormat")(t.donor.created_at))+"\n        "),n("small",{staticClass:"text-muted pl-2"},[t._v(t._s(t._f("timeFromNow")(t.donor.created_at)))])]),t._v(" "),n("two-col-list-group-item",{attrs:{title:t.$t("Last updated")}},[t._v("\n        "+t._s(t._f("dateTimeFormat")(t.donor.updated_at))+"\n        "),n("small",{staticClass:"text-muted pl-2"},[t._v(t._s(t._f("timeFromNow")(t.donor.updated_at)))])]),t._v(" "),n("two-col-list-group-item",{attrs:{title:t.$t("Tags")}},[n("tag-manager",{key:t.id,attrs:{"list-provider":t.listTags,"store-provider":t.donor.can_create_tag?t.storeTags:null,"suggestions-provider":t.listAllTags,preload:""},on:{"tag-click":function(e){return t.$router.push({name:"fundraising.donors.index",query:{tag:e}})}}},[t._v("\n            "+t._s(t.$t("Loading..."))+"\n        ")])],1)],1):n("p",[t._v("\n    "+t._s(t.$t("Loading..."))+"\n")])}),[],!1,null,null,null).exports},4821:(t,e,n)=>{n.r(e),n.d(e,{default:()=>_});var r=n(7757),a=n.n(r),o=n(381),s=n.n(o),i=n(6909),u=n(195),c=n(1581),l=n(3609);const d={props:{donations:{type:Array,required:!0},baseCurrency:{required:!0,type:String}},data:function(){return{fields:[{key:"date",label:this.$t("Date"),formatter:this.dateFormat,width:"10em"},{key:"exchange_amount",label:this.$t("Amount"),class:"text-md-right",width:"12em"},{key:"channel",label:this.$t("Channel"),width:"10em"},{key:"purpose",label:this.$t("Purpose")},{key:"budget_name",label:this.$t("Budget"),sortable:!1},{key:"reference",label:this.$t("Reference"),width:"12em"},{key:"in_name_of",label:this.$t("In the name of"),width:"10em"},{key:"created_at",label:this.$t("Registered"),width:"12em",formatter:this.dateTimeFormat},{key:"thanked",label:this.$t("Thanked"),width:"12em",formatter:this.dateTimeFormat}]}},methods:{totalAmount:function(t){var e=t.reduce((function(t,e){return t+parseFloat(e.exchange_amount)}),0);return(0,c.Me)(e,2)}}};var f=n(1900);const m=(0,f.Z)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-table",{staticClass:"shadow-md",attrs:{stacked:"md",hover:"",fields:t.fields,items:t.donations,"show-empty":"","empty-text":t.$t("No donations found."),"tbody-class":"bg-white","thead-class":"bg-white"},scopedSlots:t._u([{key:"cell(date)",fn:function(e){return[e.item.can_update?n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return t.$emit("select",e.item)}}},[t._v("\n                "+t._s(e.value)+"\n            ")]):[t._v("\n                "+t._s(e.value)+"\n            ")]]}},{key:"cell(exchange_amount)",fn:function(e){return[e.item.currency!=t.baseCurrency?n("span",{staticClass:"mr-1"},[n("small",{staticClass:"text-muted"},[t._v("\n                    "+t._s(e.item.currency)+"\n                    "+t._s(t._f("decimalNumberFormat")(e.item.amount))+"\n                ")])]):t._e(),t._v("\n            "+t._s(t.baseCurrency)+" "+t._s(t._f("decimalNumberFormat")(e.value))+"\n        ")]}},{key:"cell(budget_name)",fn:function(e){return[t.can("view-budgets")&&e.item.budget_id?n("router-link",{attrs:{to:{name:"accounting.budgets.show",params:{id:e.item.budget_id}}}},[t._v("\n                "+t._s(e.value)+"\n            ")]):[t._v("\n                "+t._s(e.value)+"\n            ")]]}},{key:"table-colgroup",fn:function(e){return t._l(e.fields,(function(t){return n("col",{key:t.key,style:{width:t.width}})}))}},{key:"custom-foot",fn:function(e){return[e.items.length>0?n("b-tr",[n("b-th",{attrs:{colspan:1}}),t._v(" "),n("b-th",{staticClass:"text-right"},[n("u",[t._v(t._s(t.baseCurrency)+"\n                        "+t._s(t._f("decimalNumberFormat")(t.totalAmount(e.items))))])]),t._v(" "),n("b-th",{attrs:{colspan:5}})],1):t._e()]}}])})],1)}),[],!1,null,null,null).exports;function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function g(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){b(o,r,a,s,i,"next",t)}function i(t){b(o,r,a,s,i,"throw",t)}s(void 0)}))}}const y={components:{DonationForm:l.Z,IndividualDonationsTable:m},props:{id:{required:!0}},data:function(){return{donations:null,canCreate:!1,selectedDonation:null,newDonationForm:!1,isBusy:!1,baseCurrency:null,currencies:{},channels:[]}},computed:{years:function(){return this.donations?this.donations.map((function(t){return t.year})).filter((function(t,e,n){return n.indexOf(t)===e})):[]},totalAmount:function(){var t=this.donations.reduce((function(t,e){return t+parseFloat(e.exchange_amount)}),0);return(0,c.Me)(t,2)}},watch:{$route:function(){this.fetchDonations()},donations:function(t){this.$emit("count",{type:"donations",value:t.length})},newDonationForm:function(t,e){var n=this;return g(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e||(n.fetchChannels(),n.fetchCurrencies());case 1:case"end":return t.stop()}}),t)})))()},selectedDonation:function(t,e){var n=this;return g(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e||(n.fetchChannels(),n.fetchCurrencies());case 1:case"end":return t.stop()}}),t)})))()}},created:function(){this.fetchDonations()},methods:{fetchDonations:function(){var t=this;return g(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.Z.listDonations(t.id);case 3:n=e.sent,t.donations=n.data.map((function(t){return v(v({},t),{},{year:s()(t.date).year()})})),t.baseCurrency=n.meta.base_currency,t.canCreate=n.meta.can_create,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),alert(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},fetchChannels:function(){var t=this;return g(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.Z.listChannels();case 3:n=e.sent,t.channels=n.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},fetchCurrencies:function(){var t=this;return g(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.Z.listCurrencies();case 3:n=e.sent,t.currencies=n.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},registerDonation:function(t){var e=this;return g(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isBusy=!0,n.prev=1,n.next=4,u.Z.storeDonation(e.id,t);case 4:r=n.sent,(0,c.OV)(r.message),e.newDonationForm=!1,e.fetchDonations(),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),alert(n.t0);case 13:e.isBusy=!1;case 14:case"end":return n.stop()}}),n,null,[[1,10]])})))()},editDonation:function(t){var e=this;return g(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.selectedDonation=t;case 1:case"end":return n.stop()}}),n)})))()},updateDonation:function(t){var e=this;return g(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isBusy=!0,n.prev=1,n.next=4,i.Z.update(e.selectedDonation.id,t);case 4:r=n.sent,(0,c.OV)(r.message),e.selectedDonation=!1,e.fetchDonations(),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),alert(n.t0);case 13:e.isBusy=!1;case 14:case"end":return n.stop()}}),n,null,[[1,10]])})))()},deleteDonation:function(){var t=this;return g(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isBusy=!0,e.prev=1,e.next=4,i.Z.delete(t.selectedDonation.id);case 4:n=e.sent,(0,c.OV)(n.message),t.selectedDonation=!1,t.fetchDonations(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),alert(e.t0);case 13:t.isBusy=!1;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))()}}};const _=(0,f.Z)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-3"},[t.selectedDonation?n("b-container",{staticClass:"px-0"},[n("b-card",{staticClass:"mb-4",attrs:{"body-class":"pb-0","header-class":"d-flex justify-content-between align-items-center"},scopedSlots:t._u([{key:"header",fn:function(){return[t._v("\n                "+t._s(t.$t("Edit donation"))+"\n                "),n("small",{staticClass:"d-none d-sm-inline"},[t._v("\n                    "+t._s(t.$t("Last updated"))+":\n                    "+t._s(t._f("dateTimeFormat")(t.selectedDonation.updated_at))+"\n                ")])]},proxy:!0}],null,!1,4081912669)},[t._v(" "),n("donation-form",{attrs:{donation:t.selectedDonation,currencies:t.currencies,channels:t.channels,"base-currency":t.baseCurrency,disabled:t.isBusy},on:{submit:t.updateDonation,cancel:function(e){t.selectedDonation=!1},delete:t.deleteDonation}})],1)],1):t.newDonationForm?n("b-container",{staticClass:"px-0"},[n("b-card",{staticClass:"mb-4",attrs:{header:t.$t("Register new donation"),"body-class":"pb-0"}},[n("donation-form",{attrs:{currencies:t.currencies,channels:t.channels,"base-currency":t.baseCurrency,disabled:t.isBusy},on:{submit:t.registerDonation,cancel:function(e){t.newDonationForm=!1}}})],1)],1):[t.canCreate?n("p",[n("b-button",{attrs:{variant:"primary"},on:{click:function(e){t.newDonationForm=!0}}},[n("font-awesome-icon",{attrs:{icon:"plus-circle"}}),t._v("\n                "+t._s(t.$t("Register new donation"))+"\n            ")],1)],1):t._e(),t._v(" "),t.donations&&t.donations.length>0?[t._l(t.years,(function(e){return n("div",{key:e},[n("h4",[t._v(t._s(e))]),t._v(" "),n("individual-donations-table",{attrs:{donations:t.donations.filter((function(t){return t.year==e})),"base-currency":t.baseCurrency},on:{select:t.editDonation}})],1)})),t._v(" "),n("p",[t._v("\n                "+t._s(t.$t("Total donations made"))+":"),n("br"),t._v(" "),n("u",[n("strong",[t._v(t._s(t.baseCurrency)+" "+t._s(t._f("decimalNumberFormat")(t.totalAmount)))])])])]:t.donations?n("b-alert",{attrs:{show:"",variant:"info"}},[t._v("\n            "+t._s(t.$t("No donations found."))+"\n        ")]):n("p",[t._v("\n            "+t._s(t.$t("Loading..."))+"\n        ")])]],2)}),[],!1,null,null,null).exports},8739:(t,e,n)=>{n.d(e,{Z:()=>p});var r=n(7757),a=n.n(r),o=n(7202);function s(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){s(o,r,a,i,u,"next",t)}function u(t){s(o,r,a,i,u,"throw",t)}i(void 0)}))}}const u=function(){var t=arguments;return i(a().mark((function e(){var n,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:null,r=n?{locale:n}:{},s=(0,o.BC)("api.languages",r),e.next=5,o.hi.get(s);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))()},c=function(){var t=arguments;return i(a().mark((function e(){var n,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:null,r=n?{locale:n}:{},s=(0,o.BC)("api.countries",r),e.next=5,o.hi.get(s);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))()};var l=n(195);function d(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){d(o,r,a,s,i,"next",t)}function i(t){d(o,r,a,s,i,"throw",t)}s(void 0)}))}}const m={props:{donor:{type:Object,required:!1},disabled:Boolean},data:function(){return{form:this.donor?{salutation:this.donor.salutation,first_name:this.donor.first_name,last_name:this.donor.last_name,company:this.donor.company,street:this.donor.street,zip:this.donor.zip,city:this.donor.city,country_name:this.donor.country_name,email:this.donor.email,phone:this.donor.phone,language:this.donor.language}:{salutation:null,first_name:null,last_name:null,company:null,street:null,zip:null,city:null,country_name:null,email:null,phone:null,language:null},salutations:[],countries:[],languages:[]}},created:function(){this.fetchSalutations(),this.fetchCountries(),this.fetchLanguages()},methods:{fetchSalutations:function(){var t=this;return f(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.listSalutations();case 2:n=e.sent,t.salutations=n.data;case 4:case"end":return e.stop()}}),e)})))()},fetchCountries:function(){var t=this;return f(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:n=e.sent,t.countries=Object.values(n);case 4:case"end":return e.stop()}}),e)})))()},fetchLanguages:function(){var t=this;return f(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:n=e.sent,t.languages=Object.values(n);case 4:case"end":return e.stop()}}),e)})))()},getValidationState:function(t){var e=t.dirty,n=t.validated,r=t.valid;return e||n?void 0===r?null:r:null},onSubmit:function(){this.$emit("submit",this.form)},onDelete:function(){confirm(this.$t("Do you really want to delete this donor?"))&&this.$emit("delete")}}};const p=(0,n(1900).Z)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("validation-observer",{ref:"observer",attrs:{slim:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.handleSubmit;return[n("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),r(t.onSubmit)}}},[n("b-form-row",[n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Salutation"),vid:"salutation",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Salutation"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",list:"salutation-list",state:t.getValidationState(e)},model:{value:t.form.salutation,callback:function(e){t.$set(t.form,"salutation",e)},expression:"form.salutation"}})],1),t._v(" "),n("b-form-datalist",{attrs:{id:"salutation-list",options:t.salutations}})]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("First Name"),vid:"first_name",rules:{required_without:"company"}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("First Name"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.first_name,callback:function(e){t.$set(t.form,"first_name",e)},expression:"form.first_name"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Last Name"),vid:"last_name",rules:{required_without:"company"}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Last Name"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Company"),vid:"company",rules:{required_without:"last_name"}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Company"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.company,callback:function(e){t.$set(t.form,"company",e)},expression:"form.company"}})],1)]}}],null,!0)})],1)],1),t._v(" "),n("b-form-row",[n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Street"),vid:"street",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Street"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.street,callback:function(e){t.$set(t.form,"street",e)},expression:"form.street"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:"2",lg:"1"}},[n("validation-provider",{attrs:{name:t.$t("ZIP"),vid:"zip",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("ZIP"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.zip,callback:function(e){t.$set(t.form,"zip",e)},expression:"form.zip"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("City"),vid:"city",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("City"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.city,callback:function(e){t.$set(t.form,"city",e)},expression:"form.city"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Country"),vid:"country",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Country"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",list:"country-list",state:t.getValidationState(e)},model:{value:t.form.country_name,callback:function(e){t.$set(t.form,"country_name",e)},expression:"form.country_name"}})],1),t._v(" "),n("b-form-datalist",{attrs:{id:"country-list",options:t.countries}})]}}],null,!0)})],1)],1),t._v(" "),n("b-form-row",[n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("E-Mail Address"),vid:"email",rules:{email:!0}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("E-Mail Address"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{type:"email",autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Phone"),vid:"phone",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Phone"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",state:t.getValidationState(e)},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)]}}],null,!0)})],1),t._v(" "),n("b-col",{attrs:{md:""}},[n("validation-provider",{attrs:{name:t.$t("Correspondence language"),vid:"language",rules:{}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("Correspondence language"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-input",{attrs:{autocomplete:"off",list:"language-list",state:t.getValidationState(e)},model:{value:t.form.language,callback:function(e){t.$set(t.form,"language",e)},expression:"form.language"}})],1),t._v(" "),n("b-form-datalist",{attrs:{id:"language-list",options:t.languages}})]}}],null,!0)})],1)],1),t._v(" "),n("p",{staticClass:"d-flex justify-content-between align-items-start"},[n("span",[n("b-button",{attrs:{type:"submit",variant:"primary",disabled:t.disabled}},[n("font-awesome-icon",{attrs:{icon:"check"}}),t._v("\n                    "+t._s(t.donor?t.$t("Update"):t.$t("Add"))+"\n                ")],1),t._v(" "),n("b-button",{attrs:{variant:"link",disabled:t.disabled},on:{click:function(e){return t.$emit("cancel")}}},[t._v("\n                    "+t._s(t.$t("Cancel"))+"\n                ")])],1),t._v(" "),t.donor&&t.donor.can_delete?n("b-button",{staticClass:"text-danger",attrs:{variant:"link",disabled:t.disabled},on:{click:t.onDelete}},[t._v("\n                "+t._s(t.$t("Delete"))+"\n            ")]):t._e()],1)],1)]}}])})}),[],!1,null,null,null).exports},8374:(t,e,n)=>{n.d(e,{Z:()=>l});var r=n(7757),a=n.n(r),o=n(7508),s=n(6796),i=n(184);function u(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}const c={components:{AlertWithRetry:o.Z,TableFilter:s.Z,TablePagination:i.Z},props:{id:{required:!0,type:String},fields:{required:!1,type:Array},apiMethod:{required:!0,type:Function},defaultSortBy:{required:!0,type:String},defaultSortDesc:{required:!1,type:Boolean,default:!1},emptyText:{required:!1,type:String},tbodyTrClass:{required:!1},itemsPerPage:{required:!1,type:Number,default:25},filterPlaceholder:{require:!1,type:String,default:function(){return this.$t("Type to search...")}},loadingLabel:{type:String,required:!1,default:function(){return this.$t("Loading...")}},noFilter:Boolean},data:function(){return{isBusy:!1,sortBy:sessionStorage.getItem(this.id+".sortBy")?sessionStorage.getItem(this.id+".sortBy"):this.defaultSortBy,sortDesc:sessionStorage.getItem(this.id+".sortDesc")?"true"==sessionStorage.getItem(this.id+".sortDesc"):this.defaultSortDesc,currentPage:sessionStorage.getItem(this.id+".currentPage")?parseInt(sessionStorage.getItem(this.id+".currentPage")):1,perPage:this.itemsPerPage,totalRows:0,errorText:null,filter:sessionStorage.getItem(this.id+".filter")?sessionStorage.getItem(this.id+".filter"):""}},watch:{filter:function(){this.currentPage=1}},methods:{itemProvider:function(t){var e,n=this;return(e=a().mark((function e(){var r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.errorText=null,r={filter:t.filter,page:t.currentPage,pageSize:t.perPage,sortBy:t.sortBy,sortDirection:t.sortDesc?"desc":"asc"},e.prev=2,e.next=5,n.apiMethod(r);case 5:return o=e.sent,n.totalRows=o.meta?o.meta.total:0,n.$emit("metadata",o.meta),o.meta&&t.perPage!=o.meta.per_page&&console.error("Table ".concat(n.id,": Discrepancies detected between requested items per page (").concat(t.perPage,") and returned items per page (").concat(o.meta.per_page,").")),sessionStorage.setItem(n.id+".sortBy",t.sortBy),sessionStorage.setItem(n.id+".sortDesc",t.sortDesc),sessionStorage.setItem(n.id+".currentPage",t.currentPage),t.filter.length>0?sessionStorage.setItem(n.id+".filter",t.filter):sessionStorage.removeItem(n.id+".filter"),e.abrupt("return",o.data||[]);case 16:return e.prev=16,e.t0=e.catch(2),n.errorText=e.t0,n.totalRows=0,sessionStorage.removeItem(n.id+".sortBy"),sessionStorage.removeItem(n.id+".sortDesc"),sessionStorage.removeItem(n.id+".currentPage"),sessionStorage.removeItem(n.id+".filter"),e.abrupt("return",[]);case 25:case"end":return e.stop()}}),e,null,[[2,16]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(t){u(o,r,a,s,i,"next",t)}function i(t){u(o,r,a,s,i,"throw",t)}s(void 0)}))})()},refresh:function(){this.$root.$emit("bv::refresh::table",this.id)}}};const l=(0,n(1900).Z)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("alert-with-retry",{attrs:{value:t.errorText},on:{retry:t.refresh}}),t._v(" "),t._t("top"),t._v(" "),n("b-form-row",[t.$slots["filter-prepend"]||t.$scopedSlots["filter-prepend"]?n("b-col",{attrs:{cols:"auto"}},[t._t("filter-prepend",null,{filter:t.filter})],2):t._e(),t._v(" "),n("b-col",[t.noFilter?t._e():n("table-filter",{attrs:{placeholder:t.filterPlaceholder,"is-busy":t.isBusy,"total-rows":t.totalRows},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1),t._v(" "),t.$slots["filter-append"]||t.$scopedSlots["filter-append"]?n("b-col",{attrs:{cols:"auto"}},[t._t("filter-append",null,{filter:t.filter})],2):t._e()],1),t._v(" "),n("b-table",{staticClass:"bg-white shadow-sm",attrs:{id:t.id,hover:"",responsive:"",items:t.itemProvider,fields:t.fields,"primary-key":"id",busy:t.isBusy,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"per-page":t.perPage,"current-page":t.currentPage,"show-empty":!0,"empty-text":t.emptyText,"empty-filtered-text":t.$t("There are no records matching your request."),"no-sort-reset":!0,filter:t.filter,"tbody-tr-class":t.tbodyTrClass},on:{"update:busy":function(e){t.isBusy=e},"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([t._l(t.$scopedSlots,(function(e,n){return{key:n,fn:function(e){return[t._t(n,null,null,e)]}}})),{key:"empty",fn:function(e){return[n("em",[t._v(t._s(e.emptyText))])]}},{key:"emptyfiltered",fn:function(e){return[n("em",[t._v(t._s(e.emptyFilteredText))])]}}],null,!0)},[t._v(" "),n("div",{staticClass:"text-center my-2",attrs:{slot:"table-busy"},slot:"table-busy"},[n("b-spinner",{staticClass:"align-middle"}),t._v(" "),n("strong",[t._v(t._s(t.loadingLabel))])],1)]),t._v(" "),t.totalRows>0?n("table-pagination",{attrs:{"total-rows":t.totalRows,"per-page":t.perPage,disabled:t.isBusy},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],2)}),[],!1,null,null,null).exports},6796:(t,e,n)=>{n.d(e,{Z:()=>a});const r={props:{value:{required:!0},placeholder:{required:!1,type:String,default:function(){return this.$t("Type to search...")}},totalRows:{type:Number},isBusy:Boolean},computed:{filterText:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}};const a=(0,n(1900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-input-group",{staticClass:"mb-3"},[n("b-form-input",{attrs:{debounce:400,trim:"",type:"search",placeholder:t.placeholder,autocomplete:"off"},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.filterText=""}},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),n("b-input-group-append",{staticClass:"d-none d-sm-block"},[t.isBusy?n("b-input-group-text",[t._v("\n            ...\n        ")]):n("b-input-group-text",[t._v("\n            "+t._s(t.$t("{num} results",{num:t.totalRows}))+"\n        ")])],1)],1)}),[],!1,null,null,null).exports},184:(t,e,n)=>{n.d(e,{Z:()=>a});const r={props:{value:Number,totalRows:Number,perPage:Number,disabled:Boolean},computed:{currentPage:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},itemsStart:function(){return(this.currentPage-1)*this.perPage+1},itemsEnd:function(){return Math.min(this.currentPage*this.perPage,this.totalRows)}}};const a=(0,n(1900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-row",{staticClass:"mb-3",attrs:{"align-v":"center"}},[n("b-col",[t.totalRows>0?n("b-pagination",{staticClass:"mb-0",attrs:{size:"sm","total-rows":t.totalRows,"per-page":t.perPage,disabled:t.disabled},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1),t._v(" "),n("b-col",{staticClass:"text-right",attrs:{sm:"auto"}},[n("small",[t._v("\n            "+t._s(t.$t("{x} out of {y}",{x:t.itemsStart+" - "+t.itemsEnd,y:t.totalRows}))+"\n        ")])])],1)}),[],!1,null,null,null).exports},6054:(t,e,n)=>{n.d(e,{Z:()=>a});const r={props:{title:{type:String,required:!0}}};const a=(0,n(1900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-list-group-item",[n("b-row",[n("b-col",{attrs:{sm:"5",md:"4",lg:"3",xl:"2"}},[n("strong",[t._v(t._s(t.title))])]),t._v(" "),n("b-col",{attrs:{sm:""}},[t._t("default")],2)],1)],1)}),[],!1,null,null,null).exports},4013:(t,e,n)=>{n.r(e),n.d(e,{default:()=>l});var r=n(7757),a=n.n(r),o=n(6909),s=n(1581);function i(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){i(o,r,a,s,u,"next",t)}function u(t){i(o,r,a,s,u,"throw",t)}s(void 0)}))}}const c={title:function(){return this.$t("Edit donation")},components:{DonationForm:n(3609).Z},props:{id:{required:!0}},data:function(){return{donation:null,baseCurrency:null,currencies:{},channels:[],isBusy:!1}},created:function(){this.fetchDonation(),this.fetchChannels(),this.fetchCurrencies()},methods:{fetchDonation:function(){var t=this;return u(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.find(t.id);case 3:n=e.sent,t.donation=n.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},fetchChannels:function(){var t=this;return u(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.listChannels();case 3:n=e.sent,t.channels=n.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},fetchCurrencies:function(){var t=this;return u(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.listCurrencies();case 3:n=e.sent,t.currencies=n.data,t.baseCurrency=n.meta.base_currency,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},updateDonation:function(t){var e=this;return u(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isBusy=!0,n.prev=1,n.next=4,o.Z.update(e.id,t);case 4:r=n.sent,(0,s.OV)(r.message),e.$router.push({name:"fundraising.donations.index"}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),alert(n.t0);case 12:e.isBusy=!1;case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))()},deleteDonation:function(){var t=this;return u(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isBusy=!0,e.prev=1,e.next=4,o.Z.delete(t.id);case 4:n=e.sent,(0,s.OV)(n.message),t.$router.push({name:"fundraising.donations.index"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(e.t0);case 12:t.isBusy=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}};const l=(0,n(1900).Z)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.donation?n("b-container",{staticClass:"px-0"},[n("b-form-row",{staticClass:"mb-3"},[n("b-col",{attrs:{sm:"auto"}},[n("strong",[t._v(t._s(t.$t("Donor"))+":")])]),t._v(" "),n("b-col",[t._v(t._s(t.donation.donor))])],1),t._v(" "),n("donation-form",{attrs:{donation:t.donation,currencies:t.currencies,channels:t.channels,"base-currency":t.baseCurrency,disabled:t.isBusy},on:{submit:t.updateDonation,cancel:function(e){return t.$router.push({name:"fundraising.donations.index"})},delete:t.deleteDonation}}),t._v(" "),n("hr"),t._v(" "),n("p",{staticClass:"text-right"},[n("small",[t._v("\n            "+t._s(t.$t("Last updated"))+":\n            "+t._s(t._f("dateTimeFormat")(t.donation.updated_at))+"\n        ")])])],1):n("p",[t._v("\n    "+t._s(t.$t("Loading..."))+"\n")])}),[],!1,null,null,null).exports},6115:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var r=n(7757),a=n.n(r),o=n(6909),s=n(1581);function i(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}const u={title:function(){return this.$t("Import")},data:function(){return{types:[{value:"stripe",text:"Stripe"}],form:{file:null,type:"stripe"},isBusy:!1}},methods:{getValidationState:function(t){var e=t.dirty,n=t.validated,r=t.valid;return e||n?void 0===r?null:r:null},onSubmit:function(){var t,e=this;return(t=a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isBusy=!0,t.prev=1,t.next=4,o.Z.import(e.form.type,e.form.file);case 4:n=t.sent,(0,s.OV)(n.message),e.$router.push({name:"fundraising.donations.index"}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),alert(t.t0);case 12:e.isBusy=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){i(o,r,a,s,u,"next",t)}function u(t){i(o,r,a,s,u,"throw",t)}s(void 0)}))})()}}};const c=(0,n(1900).Z)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("validation-observer",{ref:"observer",attrs:{slim:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.handleSubmit;return[n("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),r(t.onSubmit)}}},[n("b-form-group",{attrs:{label:t.$t("Type")}},[n("b-form-radio-group",{attrs:{options:t.types},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}})],1),t._v(" "),n("validation-provider",{attrs:{name:t.$t("File"),vid:"file",rules:{required:!0,ext:["xlsx","xls","csv"]}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("b-form-group",{attrs:{label:t.$t("File"),state:t.getValidationState(e),"invalid-feedback":e.errors[0]}},[n("b-form-file",{attrs:{placeholder:t.$t("Choose file..."),accept:".xlsx, .xls, .csv",required:"",state:t.getValidationState(e)},model:{value:t.form.file,callback:function(e){t.$set(t.form,"file",e)},expression:"form.file"}})],1)]}}],null,!0)}),t._v(" "),n("p",[n("b-button",{attrs:{type:"submit",variant:"primary",disabled:t.isBusy}},[n("font-awesome-icon",{attrs:{icon:"upload"}}),t._v("\n                "+t._s(t.$t("Import"))+"\n            ")],1)],1)],1)]}}])})}),[],!1,null,null,null).exports},5278:(t,e,n)=>{n.r(e),n.d(e,{default:()=>d});var r=n(7757),a=n.n(r),o=n(8374),s=n(6909);function i(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}const u={components:{BaseTable:o.Z},data:function(){return{fields:[{key:"date",label:this.$t("Date"),class:"fit",sortable:!0,sortDirection:"desc",formatter:this.dateFormat},{key:"exchange_amount",label:this.$t("Amount"),class:"text-right fit",sortable:!0,sortDirection:"desc"},{key:"donor",label:this.$t("Donor"),sortable:!1},{key:"channel",label:this.$t("Channel"),class:"d-none d-sm-table-cell",sortable:!1},{key:"purpose",label:this.$t("Purpose"),sortable:!1},{key:"budget_name",label:this.$t("Budget"),sortable:!1},{key:"reference",label:this.$t("Reference"),class:"d-none d-sm-table-cell",sortable:!1},{key:"in_name_of",label:this.$t("In the name of"),class:"d-none d-sm-table-cell",sortable:!0},{key:"created_at",label:this.$t("Registered"),class:"d-none d-sm-table-cell fit",sortable:!0,formatter:this.timeFromNow},{key:"thanked",label:this.$t("Thanked"),class:"fit",sortable:!1}],baseCurrency:null}},methods:{list:function(t){var e,n=this;return(e=a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.list(t);case 2:return r=e.sent,n.baseCurrency=r.meta.base_currency,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(t){i(o,r,a,s,u,"next",t)}function u(t){i(o,r,a,s,u,"throw",t)}s(void 0)}))})()}}};var c=n(1900);const l={title:function(){return this.$t("Donations")},components:{DonationsTable:(0,c.Z)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("base-table",{attrs:{id:"donationsTable",fields:t.fields,"api-method":t.list,"default-sort-by":"created_at","default-sort-desc":"","empty-text":t.$t("No donations found."),"filter-placeholder":t.$t("Search..."),"items-per-page":100},scopedSlots:t._u([{key:"cell(date)",fn:function(e){return[t._t("primary-cell",(function(){return[t._v("\n            "+t._s(e.value)+"\n        ")]}),{value:e.value,item:e.item})]}},{key:"cell(exchange_amount)",fn:function(e){return[e.item.currency!=t.baseCurrency?n("small",{staticClass:"text-muted ml-1"},[t._v("\n            "+t._s(e.item.currency)+"\n            "+t._s(t._f("decimalNumberFormat")(e.item.amount))+"\n        ")]):t._e(),t._v("\n        "+t._s(t.baseCurrency)+" "+t._s(t._f("decimalNumberFormat")(e.value))+"\n    ")]}},{key:"cell(donor)",fn:function(e){return[t._t("donor-cell",(function(){return[t._v("\n            "+t._s(e.value)+"\n        ")]}),{value:e.value,item:e.item})]}},{key:"cell(budget_name)",fn:function(e){return[t.can("view-budgets")&&e.item.budget_id?n("router-link",{attrs:{to:{name:"accounting.budgets.show",params:{id:e.item.budget_id}}}},[t._v("\n            "+t._s(e.value)+"\n        ")]):[t._v("\n            "+t._s(e.value)+"\n        ")]]}},{key:"head(thanked)",fn:function(){return[n("font-awesome-icon",{attrs:{icon:"handshake"}})]},proxy:!0},{key:"cell(thanked)",fn:function(e){return[e.value?n("font-awesome-icon",{attrs:{icon:"check"}}):t._e()]}}],null,!0)})}),[],!1,null,null,null).exports},data:function(){return{baseCurrency:null,currencies:{},channels:[],isBusy:!1}}};const d=(0,c.Z)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-3"},[n("donations-table",{scopedSlots:t._u([{key:"primary-cell",fn:function(e){return[""!=e.value&&e.item.can_update?n("router-link",{attrs:{to:{name:"fundraising.donations.edit",params:{id:e.item.id}}}},[t._v("\n                "+t._s(e.value)+"\n            ")]):[t._v("\n                "+t._s(e.value)+"\n            ")]]}},{key:"donor-cell",fn:function(e){return[""!=e.value&&e.item.donor_id?n("router-link",{attrs:{to:{name:"fundraising.donors.show",params:{id:e.item.donor_id}}}},[t._v("\n                "+t._s(e.value)+"\n            ")]):[t._v("\n                "+t._s(e.value)+"\n            ")]]}}])})],1)}),[],!1,null,null,null).exports},2230:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var r=n(7757),a=n.n(r),o=n(195),s=n(1581);function i(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}const u={title:function(){return this.$t("Add donor")},components:{DonorForm:n(8739).Z},data:function(){return{isBusy:!1}},methods:{registerDonor:function(t){var e,n=this;return(e=a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.isBusy=!0,e.prev=1,e.next=4,o.Z.store(t);case 4:r=e.sent,(0,s.OV)(r.message),n.$router.push({name:"fundraising.donors.show",params:{id:r.id}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(e.t0);case 12:n.isBusy=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(t){i(o,r,a,s,u,"next",t)}function u(t){i(o,r,a,s,u,"throw",t)}s(void 0)}))})()},handleCancel:function(){this.$router.push({name:"fundraising.donors.index"})}}};const c=(0,n(1900).Z)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{staticClass:"px-0",attrs:{fluid:""}},[n("donor-form",{attrs:{disabled:t.isBusy},on:{submit:t.registerDonor,cancel:t.handleCancel}})],1)}),[],!1,null,null,null).exports},5750:(t,e,n)=>{n.r(e),n.d(e,{default:()=>l});var r=n(7757),a=n.n(r),o=n(195),s=n(1581);function i(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){i(o,r,a,s,u,"next",t)}function u(t){i(o,r,a,s,u,"throw",t)}s(void 0)}))}}const c={title:function(){return this.$t("Edit donor")},components:{DonorForm:n(8739).Z},props:{id:{required:!0}},data:function(){return{donor:null,isBusy:!1}},watch:{$route:function(){this.fetchDonor()}},created:function(){var t=this;return u(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.fetchDonor();case 1:case"end":return e.stop()}}),e)})))()},methods:{fetchDonor:function(){var t=this;return u(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.find(t.id);case 3:n=e.sent,t.donor=n.data,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},updateDonor:function(t){var e=this;return u(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isBusy=!0,n.prev=1,n.next=4,o.Z.update(e.id,t);case 4:r=n.sent,(0,s.OV)(r.message),e.$router.push({name:"fundraising.donors.show",params:{id:e.id}}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),alert(n.t0);case 12:e.isBusy=!1;case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))()},deleteDonor:function(){var t=this;return u(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isBusy=!0,e.prev=1,e.next=4,o.Z.delete(t.id);case 4:n=e.sent,(0,s.OV)(n.message),t.$router.push({name:"fundraising.donors.index"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(e.t0);case 12:t.isBusy=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}};const l=(0,n(1900).Z)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.donor?n("b-container",{staticClass:"px-0",attrs:{fluid:""}},[n("donor-form",{attrs:{donor:t.donor,disabled:t.isBusy},on:{submit:t.updateDonor,cancel:function(e){return t.$router.push({name:"fundraising.donors.show",params:{id:t.id}})},delete:t.deleteDonor}}),t._v(" "),n("hr"),t._v(" "),n("p",{staticClass:"text-right"},[n("small",[t._v("\n            "+t._s(t.$t("Last updated"))+":\n            "+t._s(t._f("dateTimeFormat")(t.donor.updated_at))+"\n        ")])])],1):n("p",[t._v("\n    "+t._s(t.$t("Loading..."))+"\n")])}),[],!1,null,null,null).exports},8446:(t,e,n)=>{n.r(e),n.d(e,{default:()=>d});var r=n(7757),a=n.n(r),o=n(195),s=n(7508),i=n(2041);function u(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){u(o,r,a,s,i,"next",t)}function i(t){u(o,r,a,s,i,"throw",t)}s(void 0)}))}}const l={title:function(){return this.$t("Show donor")},components:{AlertWithRetry:s.Z,TabNav:i.Z},props:{id:{required:!0}},data:function(){var t=this;return{loaded:!1,error:null,canViewDonations:!1,canViewBudgets:!1,donationsCount:null,budgetsCount:null,commentCount:null,tabNavItems:[{to:{name:"fundraising.donors.show"},icon:"user",text:this.$t("Donor")},{to:{name:"fundraising.donors.show.donations"},icon:"donate",text:this.$t("Donations"),key:"donations",show:function(){return t.canViewDonations}},{to:{name:"fundraising.donors.show.budgets"},icon:"money-bill-alt",text:this.$t("Budgets"),key:"budgets",show:function(){return t.canViewBudgets}},{to:{name:"fundraising.donors.show.comments"},icon:"comments",text:this.$t("Comments"),key:"comments"}]}},watch:{$route:function(){this.fetchData()}},created:function(){var t=this;return c(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.fetchData();case 1:case"end":return e.stop()}}),e)})))()},methods:{fetchData:function(){var t=this;return c(a().mark((function e(){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.error=null,e.prev=1,e.next=4,o.Z.find(t.id,!0);case 4:n=e.sent,r=n.data,t.canViewDonations=r.can_view_donations,t.canViewBudgets=r.can_view_budgets,t.donationsCount=r.donations_count,t.budgetsCount=r.budgets_count,t.commentCount=r.comments_count,t.loaded=!0,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),t.error=e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))()},updateCount:function(t){"donations"==t.type&&(this.donationsCount=t.value),"budgets"==t.type?this.budgetsCount=t.value:"comments"==t.type&&(this.commentCount=t.value)}}};const d=(0,n(1900).Z)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.error?n("alert-with-retry",{attrs:{value:t.error},on:{retry:t.fetchData}}):t.loaded?n("div",[n("tab-nav",{attrs:{items:t.tabNavItems},scopedSlots:t._u([{key:"after(donations)",fn:function(){return[t.donationsCount>0?n("b-badge",{staticClass:"ml-1"},[t._v("\n                "+t._s(t.donationsCount)+"\n            ")]):t._e()]},proxy:!0},{key:"after(budgets)",fn:function(){return[t.budgetsCount>0?n("b-badge",{staticClass:"ml-1"},[t._v("\n                "+t._s(t.budgetsCount)+"\n            ")]):t._e()]},proxy:!0},{key:"after(comments)",fn:function(){return[t.commentCount>0?n("b-badge",{staticClass:"ml-1"},[t._v("\n                "+t._s(t.commentCount)+"\n            ")]):t._e()]},proxy:!0}])}),t._v(" "),n("router-view",{on:{count:t.updateCount}})],1):n("p",[t._v("\n    "+t._s(t.$t("Loading..."))+"\n")])}),[],!1,null,null,null).exports},1175:(t,e,n)=>{n.r(e),n.d(e,{default:()=>h});var r=n(7757),a=n.n(r),o=n(4744),s=n(7236),i=n(8374),u=n(195);const c={props:{value:{type:String,required:!0},label:{type:String,required:!0},toggled:{type:Boolean,required:!1,default:!1}},data:function(){return{pressed:this.toggled}},watch:{pressed:function(t){this.$emit("toggled",this.value,t)}}};var l=n(1900);const d=(0,l.Z)(c,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("b-button",{staticClass:"mr-2 text-nowrap",attrs:{variant:t.pressed?"primary":"outline-primary",size:"sm",pressed:t.pressed},on:{"update:pressed":function(e){t.pressed=e}}},[t._v("\n    "+t._s(t.label)+"\n")])}),[],!1,null,null,null).exports,f={components:{BaseTable:i.Z,EmailLink:s.Z,PhoneLink:o.Z,TagSelectButton:d},props:{tags:{require:!1,type:Object,default:function(){return{}}},tag:{require:!1,type:String,default:null}},data:function(){var t="donorsTable";return{id:t,fields:[{key:"first_name",label:this.$t("First Name"),tdClass:"align-middle",sortable:!0},{key:"last_name",label:this.$t("Last Name"),tdClass:"align-middle",sortable:!0},{key:"company",label:this.$t("Company"),tdClass:"align-middle",sortable:!0},{key:"street",label:this.$t("Street"),class:"d-none d-sm-table-cell",tdClass:"align-middle"},{key:"zip",label:this.$t("ZIP"),class:"d-none d-sm-table-cell",tdClass:"align-middle"},{key:"city",label:this.$t("City"),class:"d-none d-sm-table-cell",tdClass:"align-middle",sortable:!0},{key:"country_name",label:this.$t("Country"),class:"d-none d-sm-table-cell",tdClass:"align-middle",sortable:!0},{key:"language",label:this.$t("Correspondence language"),class:"d-none d-sm-table-cell",tdClass:"align-middle",sortable:!0},{key:"contact",label:this.$t("Contact"),class:"fit",tdClass:"align-middle"},{key:"created_at",label:this.$t("Registered"),class:"d-none d-sm-table-cell fit",tdClass:"align-middle",sortable:!0,sortDirection:"desc",formatter:this.timeFromNow}],myTags:this.getSelectedTags(t)}},watch:{tag:function(){this.myTags=this.getSelectedTags(this.id)},myTags:{deep:!0,handler:function(){this.$refs.table.refresh()}}},methods:{fetchData:function(t){return t.tags=this.myTags.filter((function(t){return t.selected})).map((function(t){return t.value})),u.Z.list(t)},getSelectedTags:function(t){var e;return this.tag?(e=[this.tag],sessionStorage.setItem(t+".selectedTags",JSON.stringify(e))):e=sessionStorage.getItem(t+".selectedTags")?JSON.parse(sessionStorage.getItem(t+".selectedTags")):[],Object.entries(this.tags).map((function(t){return{value:t[0],text:t[1],selected:e.indexOf(t[0])>=0}}))},toggleTag:function(t,e){var n=this.myTags.findIndex((function(e){return e.value==t}));this.myTags[n].selected=e,sessionStorage.setItem(this.id+".selectedTags",JSON.stringify(this.myTags.filter((function(t){return t.selected})).map((function(t){return t.value}))))}}};function m(t,e,n,r,a,o,s){try{var i=t[o](s),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,a)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){m(o,r,a,s,i,"next",t)}function i(t){m(o,r,a,s,i,"throw",t)}s(void 0)}))}}const v={title:function(){return this.$t("Donors")},components:{DonorsTable:(0,l.Z)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("base-table",{ref:"table",attrs:{id:t.id,fields:t.fields,"api-method":t.fetchData,"default-sort-by":"first_name","empty-text":t.$t("No donors found."),"filter-placeholder":t.$t("Search for name, address, e-mail, phone")+"...","items-per-page":25},scopedSlots:t._u([{key:"cell(first_name)",fn:function(e){return[t._t("primary-cell",(function(){return[t._v("\n            "+t._s(e.value)+"\n        ")]}),{value:e.value,item:e.item})]}},{key:"cell(last_name)",fn:function(e){return[t._t("primary-cell",(function(){return[t._v("\n            "+t._s(e.value)+"\n        ")]}),{value:e.value,item:e.item})]}},{key:"cell(company)",fn:function(e){return[t._t("primary-cell",(function(){return[t._v("\n            "+t._s(e.value)+"\n        ")]}),{value:e.value,item:e.item})]}},{key:"cell(contact)",fn:function(e){return[e.item.email?n("email-link",{attrs:{value:e.item.email,"icon-only":""}}):t._e(),t._v(" "),e.item.phone?n("phone-link",{attrs:{value:e.item.phone,"icon-only":""}}):t._e()]}},{key:"top",fn:function(){return[t.myTags.length>0?n("p",{staticClass:"mb-3 d-flex align-items-center overflow-auto"},[n("span",{staticClass:"mr-2"},[t._v(t._s(t.$t("Tags"))+":")]),t._v(" "),t._l(t.myTags,(function(e){return n("tag-select-button",{key:e.value+"-"+e.selected,attrs:{label:e.text,value:e.value,toggled:e.selected},on:{toggled:t.toggleTag}})}))],2):t._e()]},proxy:!0}],null,!0)})}),[],!1,null,null,null).exports},props:{tag:{require:!1,type:String,default:null}},data:function(){return{tags:null}},created:function(){var t=this;return p(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.fetchTags();case 1:case"end":return e.stop()}}),e)})))()},methods:{fetchTags:function(){var t=this;return p(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.listTags();case 2:n=e.sent,t.tags=n.data.reduce((function(t,e){return t[e.slug]=e.name,t}),{});case 4:case"end":return e.stop()}}),e)})))()}}};const h=(0,l.Z)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-3"},[null!=t.tags?n("donors-table",{attrs:{tags:t.tags,tag:t.tag},scopedSlots:t._u([{key:"primary-cell",fn:function(e){return[n("router-link",{attrs:{to:{name:"fundraising.donors.show",params:{id:e.item.id}}}},[t._v("\n                "+t._s(e.value)+"\n            ")])]}}],null,!1,1538248904)}):n("p",[t._v("\n        "+t._s(t.$t("Loading..."))+"\n    ")])],1)}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=fundraising.js.map?id=f2a9d3e0b1052574