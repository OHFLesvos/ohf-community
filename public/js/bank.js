!function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=40)}({40:function(t,e,n){t.exports=n(9)},9:function(t,e){function n(){filterField.val("").change().focus(),l(),o(),$.post(resetFilterUrl,{_token:csrfToken})}function r(t){if(u!=t){""!=t?filterReset.addClass("bg-primary text-light"):filterReset.removeClass("bg-primary text-light");var e=t.trim();""!=e?s(e):(table.hide(),l(),o()),u=t}}function a(t){statusContainer.html(t)}function o(){statusContainer.html("")}function i(t,e){alertContainer.html(t),alertContainer.addClass("alert alert-"+e);var n="danger"==e?"warning":"info-circle";alertContainer.prepend($("<i>").addClass("fa fa-"+n).append("&nbsp;")),alertContainer.show()}function l(){alertContainer.hide(),alertContainer.removeClass()}function s(t){a("Searching..."),$.post(filterUrl,{_token:csrfToken,filter:t},function(t){var e=table.children("tbody");if(t.results.length>0)e.empty(),$.each(t.results,function(t,n){e.append(c(n))}),table.show(),l(),a(t.results.length<t.total?"Showing <strong>"+t.results.length+"</strong> of <strong>"+t.total+"</strong> persons, refine your search.":"Found <strong>"+t.results.length+"</strong> persons.");else{table.hide(),o();i($("<span>").text("No results. ").append($("<a>").attr("href",createNewRecordUrl+(t.register?"?"+t.register:"")).append("Register new person")),"info")}}).fail(function(t,e,n){table.hide(),o(),i(e+": "+n,"danger")})}function c(t){var e=$("<td>");return t.today>0?e.text(t.today).append(" &nbsp; ").append($("<a>").attr("href","javascript:;").append($("<i>").addClass("fa fa-pencil")).on("click",function(){var n=$("<input>").attr("type","number").attr("min",0).attr("max",transactionMaxAmount).attr("value",t.today).addClass("form-control form-control-sm").on("focus",function(){$(this).select()}).on("keypress",function(e){13==e.keyCode&&p(t.id,$(this).val()-t.today)});e.empty(),e.append(n),n.focus()})):e.append($("<input>").attr("type","number").attr("min",0).attr("max",transactionMaxAmount).attr("value",0).addClass("form-control form-control-sm").on("focus",function(){$(this).select()}).on("keypress",function(e){13==e.keyCode&&$(this).val()>0&&p(t.id,$(this).val())})),$("<tr>").attr("id","person-"+t.id).addClass(t.today>0?"table-success":null).append($("<td>").append($("<a>").attr("href","people/"+t.id).text(t.name))).append($("<td>").append($("<a>").attr("href","people/"+t.id).text(t.family_name))).append($("<td>").text(t.case_no)).append($("<td>").text(t.medical_no)).append($("<td>").text(t.registration_no)).append($("<td>").text(t.section_card_no)).append($("<td>").text(t.nationality)).append($("<td>").text(t.remarks)).append($("<td>").html(function(){return t.boutique_coupon?t.boutique_coupon:$("<a>").attr("href","javascript:;").text("Give coupon").on("click",function(){confirm("Give coupon to "+t.name+" "+t.family_name+"?")&&$.post(giveBouqiqueCouponUrl,{_token:csrfToken,person_id:t.id},function(e){d(t.id),filterField.select()}).fail(function(t,e){alert(extStatus)})})})).append($("<td>").html(t.yesterday>0?"<strong>"+t.yesterday+"</strong>":0)).append(e)}function p(t,e){$.post(storeTransactionUrl,{_token:csrfToken,person_id:t,value:e},function(e){$("tr#person-"+t).replaceWith(c(e)),filterField.select()}).fail(function(t,e){alert(e+": "+t.responseJSON)})}function d(t){$.get("bank/person/"+t,function(e){$("tr#person-"+t).replaceWith(c(e))}).fail(function(t,e){alert(e)})}var f,u="";$(function(){filterField.on("change paste propertychange input",function(t){"input"==t.type||"propertychange"==t.type?(clearTimeout(f),f=setTimeout(function(){r(filterField.val())},250)):r(filterField.val())}),filterField.on("keydown",function(t){var e=!1,a=!1;"key"in t?(e="Escape"==t.key||"Esc"==t.key,a="Enter"==t.key):(e=27==t.keyCode,a=13==t.keyCode),e?n():a&&(r(filterField.val()),filterField.blur())}),filterReset.on("click",function(){n()}),addFilterElem.on("click",function(){var t=$(this).attr("data-filter"),e=filterField.val();e.trim().split(" ").includes(t.trim())?filterField.focus().val(e):filterField.focus().val(t+e).change()}),filterField.select().change()})}});