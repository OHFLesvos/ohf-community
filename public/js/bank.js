!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=228)}({14:function(e,t){function n(e,t,n,r){var i=$("<li>").addClass("page-item");return null!=t?i.append($("<a>").addClass("page-link").attr("href","javascript:;").html(e).on("click",function(){r(t)})):i.append($("<span>").addClass("page-link").html(e)),null!=n&&i.addClass(n),i}e.exports={updatePagination:function(e,t,r){e.empty(),t.current_page>1?e.append(n("&laquo;",1,null,r)):e.append(n("&laquo;",null,"disabled",r));t.current_page>1?e.append(n("&lsaquo;",t.current_page-1,null,r)):e.append(n("&lsaquo;",null,"disabled",r));for(i=2+Math.max(2-(t.last_page-t.current_page),0);i>=1;i--)t.current_page>i&&e.append(n(t.current_page-i,t.current_page-i,null,r));for(e.append(n(t.current_page,null,"active",r)),i=1;i<=2+Math.max(0,3-t.current_page);i++)t.current_page+i-1<t.last_page&&e.append(n(t.current_page+i,t.current_page+i,null,r));t.current_page<t.last_page?e.append(n("&rsaquo;",t.current_page+1,null,r)):e.append(n("&rsaquo;",null,"disabled",r));t.current_page<t.last_page?e.append(n("&raquo;",t.last_page,null,r)):e.append(n("&raquo;",null,"disabled",r))}}},228:function(e,t,n){e.exports=n(229)},229:function(e,t,n){pagination=n(14);var r,i=n(230),a="";function o(){$.get(todayStatsUrl,function(e){e.numberOfPersonsServed?$("#stats").html("Today, we served <strong>"+e.numberOfPersonsServed+"</strong> persons, handing out <strong> "+e.transactionValue+"</strong> drachmas."):$("#stats").html("We did not yet serve any persons today."),$("#stats").fadeIn("fast")})}function s(){filterField.val("").change().focus(),c(),w(),$.post(resetFilterUrl,{_token:csrfToken})}function h(e){if(a!=e){$("#stats").hide(),""!=e?(filterReset.removeAttr("disabled"),filterReset.addClass("bg-primary text-light")):(filterReset.attr("disabled","disabled"),filterReset.removeClass("bg-primary text-light"));var t=e.trim();""!=t?d(t,1):(table.hide(),o(),c(),w()),a=e}}function w(){statusContainer.html(""),paginator.empty(),paginationInfo.empty()}function f(e,t){alertContainer.html(e),alertContainer.addClass("alert alert-"+t);var n="danger"==t?"warning":"info-circle";alertContainer.prepend($("<i>").addClass("fa fa-"+n).append("&nbsp;")),alertContainer.show()}function c(){alertContainer.hide(),alertContainer.removeClass()}function _(e){d(filterField.val().trim(),e)}function d(e,t){var n;paginator.empty(),paginationInfo.empty(),n="Searching...",statusContainer.html(n),$.post(filterUrl,{_token:csrfToken,filter:e,page:t},function(e){var t=table.children("tbody");e.results.length>0?(t.empty(),$.each(e.results,function(e,n){t.append(u(n))}),table.show(),c(),w(),pagination.updatePagination(paginator,e,_),paginationInfo.html(e.from+" - "+e.to+" of "+e.total)):(table.hide(),o(),w(),f($("<span>").text("No results. ").append($("<a>").attr("href",createNewRecordUrl+(e.register?"?"+e.register:"")).append("Register new person")),"info"))}).fail(function(e,t,n){table.hide(),o(),w(),f(t+": "+n,"danger"),console.log("Error: "+t+" "+e.responseText)})}function u(e){var t,n,r=$("<td>");return e.today>0?r.text(e.today).append(" &nbsp; ").append($("<a>").attr("href","javascript:;").append($("<i>").addClass("fa fa-pencil")).on("click",function(){var t=$("<input>").attr("type","number").attr("min",0).attr("max",transactionMaxAmount).attr("value",e.today).addClass("form-control form-control-sm").on("focus",function(){$(this).select()}).on("keypress",function(t){13==t.keyCode&&g(e.id,$(this).val()-e.today)});r.empty(),r.append(t),t.focus()})):(r.append($("<a>").attr("href","#").addClass("btn btn-secondary btn-sm").text("2").on("click",function(t){$(this).parent().html('<i class="fa fa-spinner fa-spin">'),g(e.id,2),t.preventDefault()})),r.append(" &nbsp; "),r.append($("<a>").attr("href","#").addClass("btn btn-secondary btn-sm").text("1").on("click",function(t){$(this).parent().html('<i class="fa fa-spinner fa-spin">'),g(e.id,1),t.preventDefault()}))),t="f"==e.gender?l("female"):"m"==e.gender?l("male"):$("<a>").attr("href","#").append(l("question-circle-o")).on("click",function(){$(this).parent().empty().addClass("text-nowrap").append(v(e,"male","m")).append("&nbsp; ").append(v(e,"female","f"))}),e.card_no?(n=e.card_no,n+="Append"):n=$("<a>").attr("href","javascript:;").text("Give card").on("click",function(){i.initiate({onResult:function(e){console.info("DONE: ",e),alert(e)},onError:function(e){console.error("ERR :::: ",e)},onTimeout:function(){console.warn("TIMEDOUT")}})}),$("<tr>").attr("id","person-"+e.id).addClass(e.today>0?"table-success":null).append($("<td>").addClass("text-center").append(t)).append($("<td>").append($("<a>").attr("href","../people/"+e.id).text(e.family_name))).append($("<td>").append($("<a>").attr("href","../people/"+e.id).text(e.name))).append($("<td>").text(e.age)).append($("<td>").append(n)).append($("<td>").text(e.police_no)).append($("<td>").text(e.case_no)).append($("<td>").text(e.medical_no)).append($("<td>").text(e.registration_no)).append($("<td>").text(e.section_card_no)).append($("<td>").text(e.temp_no)).append($("<td>").text(e.nationality)).append($("<td>").text(e.remarks)).append($("<td>").html(function(){return e.boutique_coupon?e.boutique_coupon:$("<a>").attr("href","javascript:;").text("Give coupon").on("click",function(){confirm("Give coupon to "+e.family_name+" "+e.name+"?")&&$.post(giveBouqiqueCouponUrl,{_token:csrfToken,person_id:e.id},function(t){$("tr#person-"+e.id).replaceWith(u(t)),filterField.select()}).fail(function(e,t){alert(t)})})})).append($("<td>").html(function(){return e.diapers_coupon?e.diapers_coupon:$("<a>").attr("href","javascript:;").text("Give coupon").on("click",function(){confirm("Give coupon to "+e.family_name+" "+e.name+"?")&&$.post(giveDiapersCouponUrl,{_token:csrfToken,person_id:e.id},function(t){$("tr#person-"+e.id).replaceWith(u(t)),filterField.select()}).fail(function(e,t){alert(t)})})})).append(r)}function l(e){return $("<i>").addClass("fa").addClass("fa-"+e)}function v(e,t,n){return $("<a>").attr("href","#").append(l(t)).on("click",function(){$.post(updateGenderUrl,{_token:csrfToken,person_id:e.id,gender:n},function(t){$("tr#person-"+e.id).replaceWith(u(t)),filterField.select()}).fail(function(e,t){alert(t)})})}function g(e,t){$.post(storeTransactionUrl,{_token:csrfToken,person_id:e,value:t},function(t){$("tr#person-"+e).replaceWith(u(t)),filterField.select()}).fail(function(e,t){alert(t+": "+e.responseJSON)})}$(function(){filterField.on("change paste propertychange input",function(e){"input"==e.type||"propertychange"==e.type?(clearTimeout(r),r=setTimeout(function(){h(filterField.val())},250)):h(filterField.val())}),filterField.on("keydown",function(e){var t=!1,n=!1;"key"in e?(t="Escape"==e.key||"Esc"==e.key,n="Enter"==e.key):(t=27==e.keyCode,n=13==e.keyCode),t?s():n&&(h(filterField.val()),filterField.blur())}),filterReset.on("click",function(){s()}),addFilterElem.on("click",function(){var e=$(this).attr("data-filter"),t=filterField.val();t.trim().split(" ").includes(e.trim())?filterField.focus().val(t):filterField.focus().val(e+t).change()}),filterField.select().change(),o()})},230:function(e,t,n){const r=n(231);console.log(typeof r),e.exports=r},231:function(e,t,n){var r,i,a;i=[],void 0===(a="function"==typeof(r=function(){let e={};function t(e){if(!e.qrcode){var t={};function n(e,t){this.count=e,this._fc=t,this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("_dm",function(){return this._fc})}function r(e,t,n){this._bm=e,this._do=n?new Array(t,n):new Array(t),this.__defineGetter__("_bo",function(){return this._bm}),this.__defineGetter__("_dn",function(){return this._bm*this._fo}),this.__defineGetter__("_fo",function(){for(var e=0,t=0;t<this._do.length;t++)e+=this._do[t].length;return e}),this._fb=function(){return this._do}}function i(e,t,n,r,i,a){this._bs=e,this._ar=t,this._do=new Array(n,r,i,a);for(var o=0,s=n._bo,h=n._fb(),w=0;w<h.length;w++){var f=h[w];o+=f.Count*(f._dm+s)}this._br=o,this.__defineGetter__("_fd",function(){return this._bs}),this.__defineGetter__("_as",function(){return this._ar}),this.__defineGetter__("_dp",function(){return this._br}),this.__defineGetter__("_cr",function(){return 17+4*this._bs}),this._aq=function(){var e=this._cr,t=new v(e);t._bq(0,0,9,9),t._bq(e-8,0,8,9),t._bq(0,e-8,9,8);for(var n=this._ar.length,r=0;r<n;r++)for(var i=this._ar[r]-2,a=0;a<n;a++)0==r&&(0==a||a==n-1)||r==n-1&&0==a||t._bq(this._ar[a]-2,i,5,5);return t._bq(6,9,1,e-17),t._bq(9,6,e-17,1),this._bs>6&&(t._bq(e-11,0,3,6),t._bq(0,e-11,6,3)),t},this._bu=function(e){return this._do[e.ordinal()]}}function a(e,t,n,r,i,o,s,h,w){this.a11=e,this.a12=r,this.a13=s,this.a21=t,this.a22=i,this.a23=h,this.a31=n,this.a32=o,this.a33=w,this._ad=function(e){for(var t=e.length,n=this.a11,r=this.a12,i=this.a13,a=this.a21,o=this.a22,s=this.a23,h=this.a31,w=this.a32,f=this.a33,c=0;c<t;c+=2){var _=e[c],d=e[c+1],u=i*_+s*d+f;e[c]=(n*_+a*d+h)/u,e[c+1]=(r*_+o*d+w)/u}},this._fp=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r],a=t[r],o=this.a13*i+this.a23*a+this.a33;e[r]=(this.a11*i+this.a21*a+this.a31)/o,t[r]=(this.a12*i+this.a22*a+this.a32)/o}},this._fr=function(){return new a(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new a(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}function o(e){this.image=e,this._am=null,this._bi=function(e,t,n,r){var i=Math.abs(r-t)>Math.abs(n-e);if(i){var a=e;e=t,t=a,a=n,n=r,r=a}for(var o=Math.abs(n-e),s=Math.abs(r-t),h=-o>>1,w=t<r?1:-1,f=e<n?1:-1,c=0,_=e,d=t;_!=n;_+=f){var u=i?d:_,l=i?_:d;if(1==c?this.image[u+l*A.width]&&c++:this.image[u+l*A.width]||c++,3==c){var v=_-e,g=d-t;return Math.sqrt(v*v+g*g)}if((h+=s)>0){if(d==r)break;d+=w,h-=o}}var p=n-e,m=r-t;return Math.sqrt(p*p+m*m)},this._bh=function(e,t,n,r){var i=this._bi(e,t,n,r),a=1,o=e-(n-e);o<0?(a=e/(e-o),o=0):o>=A.width&&(a=(A.width-1-e)/(o-e),o=A.width-1);var s=Math.floor(t-(r-t)*a);return a=1,s<0?(a=t/(t-s),s=0):s>=A.height&&(a=(A.height-1-t)/(s-t),s=A.height-1),o=Math.floor(e+(o-e)*a),(i+=this._bi(e,t,o,s))-1},this._bj=function(e,t){var n=this._bh(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),r=this._bh(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14},this._bk=function(e,t,n){return(this._bj(e,t)+this._bj(e,n))/2},this.distance=function(e,t){var n=e.X-t.X,r=e.Y-t.Y;return Math.sqrt(n*n+r*r)},this._bx=function(e,t,n,r){var i=7+(Math.round(this.distance(e,t)/r)+Math.round(this.distance(e,n)/r)>>1);switch(3&i){case 0:i++;break;case 2:i--;break;case 3:throw"Error"}return i},this._bl=function(e,t,n,r){var i=Math.floor(r*e),a=Math.max(0,t-i),o=Math.min(A.width-1,t+i);if(o-a<3*e)throw"Error";var s=Math.max(0,n-i),h=Math.min(A.height-1,n+i);return new function(e,t,n,r,i,a,o){this.image=e,this._cv=new Array,this.startX=t,this.startY=n,this.width=r,this.height=i,this._ef=a,this._al=new Array(0,0,0),this._am=o,this._an=function(e,t){return t-e[2]-e[1]/2},this._ao=function(e){for(var t=this._ef,n=t/2,r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0},this._ap=function(e,t,n,r){var i=this.image,a=A.height,o=this._al;o[0]=0,o[1]=0,o[2]=0;for(var s=e;s>=0&&i[t+s*A.width]&&o[1]<=n;)o[1]++,s--;if(s<0||o[1]>n)return NaN;for(;s>=0&&!i[t+s*A.width]&&o[0]<=n;)o[0]++,s--;if(o[0]>n)return NaN;for(s=e+1;s<a&&i[t+s*A.width]&&o[1]<=n;)o[1]++,s++;if(s==a||o[1]>n)return NaN;for(;s<a&&!i[t+s*A.width]&&o[2]<=n;)o[2]++,s++;if(o[2]>n)return NaN;var h=o[0]+o[1]+o[2];return 5*Math.abs(h-r)>=2*r?NaN:this._ao(o)?this._an(o,s):NaN},this._cu=function(e,t,n){var r=e[0]+e[1]+e[2],i=this._an(e,n),a=this._ap(t,Math.floor(i),2*e[1],r);if(!isNaN(a)){for(var o=(e[0]+e[1]+e[2])/3,s=this._cv.length,h=0;h<s;h++){var w=this._cv[h];if(w._ev(o,a,i))return new $(i,a,o)}var f=new $(i,a,o);this._cv.push(f),null!=this._am&&this._am._ep(f)}return null},this.find=function(){for(var t=this.startX,i=this.height,a=t+r,o=n+(i>>1),s=new Array(0,0,0),h=0;h<i;h++){var w=o+(0==(1&h)?h+1>>1:-(h+1>>1));s[0]=0,s[1]=0,s[2]=0;for(var f=t;f<a&&!e[f+A.width*w];)f++;for(var c=0;f<a;){if(e[f+w*A.width])if(1==c)s[c]++;else if(2==c){if(this._ao(s)){var _=this._cu(s,w,f);if(null!=_)return _}s[0]=s[2],s[1]=1,s[2]=0,c=1}else s[++c]++;else 1==c&&c++,s[c]++;f++}if(this._ao(s)){var _=this._cu(s,w,a);if(null!=_)return _}}if(0!=this._cv.length)return this._cv[0];throw"Couldn't find enough alignment patterns"}}(this.image,a,s,o-a,h-s,e,this._am).find()},this.createTransform=function(e,t,n,r,i){var o,s,h,w,f=i-3.5;return null!=r?(o=r.X,s=r.Y,h=w=f-3):(o=t.X-e.X+n.X,s=t.Y-e.Y+n.Y,h=w=f),a._ag(3.5,3.5,f,3.5,h,w,3.5,f,e.X,e.Y,t.X,t.Y,o,s,n.X,n.Y)},this._bz=function(e,n,r){return t._af(e,r,n)},this._cd=function(e){var t=e._gq,n=e._gs,r=e._gp,a=this._bk(t,n,r);if(a<1)throw"Error";var o=this._bx(t,n,r,a),s=i._at(o),h=s._cr-7,w=null;if(s._as.length>0)for(var f=n.X-t.X+r.X,c=n.Y-t.Y+r.Y,_=1-3/h,d=Math.floor(t.X+_*(f-t.X)),u=Math.floor(t.Y+_*(c-t.Y)),l=4;l<=16;l<<=1){w=this._bl(a,d,u,l);break}var v=this.createTransform(t,n,r,w,o);return new function(e,t){this.bits=e,this.points=t}(this._bz(this.image,v,o),null==w?new Array(r,t,n):new Array(r,t,n,w))},this.detect=function(){var e=(new function(){this.image=null,this._cv=[],this._ge=!1,this._al=new Array(0,0,0,0,0),this._am=null,this.__defineGetter__("_da",function(){return this._al[0]=0,this._al[1]=0,this._al[2]=0,this._al[3]=0,this._al[4]=0,this._al}),this._ao=function(e){for(var t=0,n=0;n<5;n++){var r=e[n];if(0==r)return!1;t+=r}if(t<7)return!1;var i=Math.floor((t<<C)/7),a=Math.floor(i/2);return Math.abs(i-(e[0]<<C))<a&&Math.abs(i-(e[1]<<C))<a&&Math.abs(3*i-(e[2]<<C))<3*a&&Math.abs(i-(e[3]<<C))<a&&Math.abs(i-(e[4]<<C))<a},this._an=function(e,t){return t-e[4]-e[3]-e[2]/2},this._ap=function(e,t,n,r){for(var i=this.image,a=A.height,o=this._da,s=e;s>=0&&i[t+s*A.width];)o[2]++,s--;if(s<0)return NaN;for(;s>=0&&!i[t+s*A.width]&&o[1]<=n;)o[1]++,s--;if(s<0||o[1]>n)return NaN;for(;s>=0&&i[t+s*A.width]&&o[0]<=n;)o[0]++,s--;if(o[0]>n)return NaN;for(s=e+1;s<a&&i[t+s*A.width];)o[2]++,s++;if(s==a)return NaN;for(;s<a&&!i[t+s*A.width]&&o[3]<n;)o[3]++,s++;if(s==a||o[3]>=n)return NaN;for(;s<a&&i[t+s*A.width]&&o[4]<n;)o[4]++,s++;if(o[4]>=n)return NaN;var h=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(h-r)>=2*r?NaN:this._ao(o)?this._an(o,s):NaN},this._ej=function(e,t,n,r){for(var i=this.image,a=A.width,o=this._da,s=e;s>=0&&i[s+t*A.width];)o[2]++,s--;if(s<0)return NaN;for(;s>=0&&!i[s+t*A.width]&&o[1]<=n;)o[1]++,s--;if(s<0||o[1]>n)return NaN;for(;s>=0&&i[s+t*A.width]&&o[0]<=n;)o[0]++,s--;if(o[0]>n)return NaN;for(s=e+1;s<a&&i[s+t*A.width];)o[2]++,s++;if(s==a)return NaN;for(;s<a&&!i[s+t*A.width]&&o[3]<n;)o[3]++,s++;if(s==a||o[3]>=n)return NaN;for(;s<a&&i[s+t*A.width]&&o[4]<n;)o[4]++,s++;if(o[4]>=n)return NaN;var h=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(h-r)>=r?NaN:this._ao(o)?this._an(o,s):NaN},this._cu=function(e,t,n){var r=e[0]+e[1]+e[2]+e[3]+e[4],i=this._an(e,n),a=this._ap(t,Math.floor(i),e[2],r);if(!isNaN(a)&&(i=this._ej(Math.floor(i),Math.floor(a),e[2],r),!isNaN(i))){for(var o=r/7,s=!1,h=this._cv.length,w=0;w<h;w++){var f=this._cv[w];if(f._ev(o,a,i)){f._ek(),s=!0;break}}if(!s){var c=new function(e,t,n){this.x=e,this.y=t,this.count=1,this._aj=n,this.__defineGetter__("_ei",function(){return this._aj}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return this.x}),this.__defineGetter__("Y",function(){return this.y}),this._ek=function(){this.count++},this._ev=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this._aj);return r<=1||r/this._aj<=1}return!1}}(i,a,o);this._cv.push(c),null!=this._am&&this._am._ep(c)}return!0}return!1},this._ee=function(){var e=this._cv.length;if(e<3)throw"Couldn't find enough finder patterns (found "+e+")";if(e>3){for(var t=0,n=0,r=0;r<e;r++){var i=this._cv[r]._ei;t+=i,n+=i*i}var a=t/e;this._cv.sort(function(e,t){var n=Math.abs(t._ei-a),r=Math.abs(e._ei-a);return n<r?-1:n==r?0:1});for(var o=Math.sqrt(n/e-a*a),s=Math.max(.2*a,o),r=this._cv.length-1;r>=0;r--){var h=this._cv[r];Math.abs(h._ei-a)>s&&this._cv.splice(r,1)}}return this._cv.length>3&&this._cv.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),new Array(this._cv[0],this._cv[1],this._cv[2])},this._eq=function(){var e=this._cv.length;if(e<=1)return 0;for(var t=null,n=0;n<e;n++){var r=this._cv[n];if(r.Count>=N){if(null!=t)return this._ge=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2);t=r}}return 0},this._cx=function(){for(var e=0,t=0,n=this._cv.length,r=0;r<n;r++){var i=this._cv[r];i.Count>=N&&(e++,t+=i._ei)}if(e<3)return!1;for(var a=t/n,o=0,r=0;r<n;r++)i=this._cv[r],o+=Math.abs(i._ei-a);return o<=.05*t},this._ce=function(e){this.image=e;var t=A.height,n=A.width,r=Math.floor(3*t/(4*M));r<x&&(r=x);for(var i=!1,a=new Array(5),o=r-1;o<t&&!i;o+=r){a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0;for(var s=0,h=0;h<n;h++)if(e[h+o*A.width])1==(1&s)&&s++,a[s]++;else if(0==(1&s))if(4==s)if(this._ao(a)){var w=this._cu(a,o,h);if(w)if(r=2,this._ge)i=this._cx();else{var f=this._eq();f>a[2]&&(o+=f-a[2]-r,h=n-1)}else{do{h++}while(h<n&&!e[h+o*A.width]);h--}s=0,a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0}else a[0]=a[2],a[1]=a[3],a[2]=a[4],a[3]=1,a[4]=0,s=3;else a[++s]++;else a[s]++;if(this._ao(a)){var w=this._cu(a,o,n);w&&(r=a[0],this._ge&&(i=_cx()))}}var c=this._ee();return A._er(c),new function(e){this._go=e[0],this._gu=e[1],this._gr=e[2],this.__defineGetter__("_gp",function(){return this._go}),this.__defineGetter__("_gq",function(){return this._gu}),this.__defineGetter__("_gs",function(){return this._gr})}(c)}})._ce(this.image);return this._cd(e)}}t._ab=function(e,t){for(var n=A.width,r=A.height,i=!0,a=0;a<t.length&&i;a+=2){var o=Math.floor(t[a]),s=Math.floor(t[a+1]);if(o<-1||o>n||s<-1||s>r)throw"Error._ab ";i=!1,-1==o?(t[a]=0,i=!0):o==n&&(t[a]=n-1,i=!0),-1==s?(t[a+1]=0,i=!0):s==r&&(t[a+1]=r-1,i=!0)}i=!0;for(a=t.length-2;a>=0&&i;a-=2){o=Math.floor(t[a]),s=Math.floor(t[a+1]);if(o<-1||o>n||s<-1||s>r)throw"Error._ab ";i=!1,-1==o?(t[a]=0,i=!0):o==n&&(t[a]=n-1,i=!0),-1==s?(t[a+1]=0,i=!0):s==r&&(t[a+1]=r-1,i=!0)}},t._af=function(e,n,r){for(var i=new v(n),a=new Array(n<<1),o=0;o<n;o++){for(var s=a.length,h=o+.5,w=0;w<s;w+=2)a[w]=.5+(w>>1),a[w+1]=h;r._ad(a),t._ab(e,a);try{for(w=0;w<s;w+=2){e[Math.floor(a[w])+A.width*Math.floor(a[w+1])]&&i._dq(w>>1,o)}}catch(e){throw"Error._ab"}}return i},t._ah=function(e,n,r,i,o,s,h,w,f,c,_,d,u,l,v,g,p,m){var y=a._ag(r,i,o,s,h,w,f,c,_,d,u,l,v,g,p,m);return t._af(e,n,y)},i._bv=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),i.VERSIONS=new Array(new i(1,new Array,new r(7,new n(1,19)),new r(10,new n(1,16)),new r(13,new n(1,13)),new r(17,new n(1,9))),new i(2,new Array(6,18),new r(10,new n(1,34)),new r(16,new n(1,28)),new r(22,new n(1,22)),new r(28,new n(1,16))),new i(3,new Array(6,22),new r(15,new n(1,55)),new r(26,new n(1,44)),new r(18,new n(2,17)),new r(22,new n(2,13))),new i(4,new Array(6,26),new r(20,new n(1,80)),new r(18,new n(2,32)),new r(26,new n(2,24)),new r(16,new n(4,9))),new i(5,new Array(6,30),new r(26,new n(1,108)),new r(24,new n(2,43)),new r(18,new n(2,15),new n(2,16)),new r(22,new n(2,11),new n(2,12))),new i(6,new Array(6,34),new r(18,new n(2,68)),new r(16,new n(4,27)),new r(24,new n(4,19)),new r(28,new n(4,15))),new i(7,new Array(6,22,38),new r(20,new n(2,78)),new r(18,new n(4,31)),new r(18,new n(2,14),new n(4,15)),new r(26,new n(4,13),new n(1,14))),new i(8,new Array(6,24,42),new r(24,new n(2,97)),new r(22,new n(2,38),new n(2,39)),new r(22,new n(4,18),new n(2,19)),new r(26,new n(4,14),new n(2,15))),new i(9,new Array(6,26,46),new r(30,new n(2,116)),new r(22,new n(3,36),new n(2,37)),new r(20,new n(4,16),new n(4,17)),new r(24,new n(4,12),new n(4,13))),new i(10,new Array(6,28,50),new r(18,new n(2,68),new n(2,69)),new r(26,new n(4,43),new n(1,44)),new r(24,new n(6,19),new n(2,20)),new r(28,new n(6,15),new n(2,16))),new i(11,new Array(6,30,54),new r(20,new n(4,81)),new r(30,new n(1,50),new n(4,51)),new r(28,new n(4,22),new n(4,23)),new r(24,new n(3,12),new n(8,13))),new i(12,new Array(6,32,58),new r(24,new n(2,92),new n(2,93)),new r(22,new n(6,36),new n(2,37)),new r(26,new n(4,20),new n(6,21)),new r(28,new n(7,14),new n(4,15))),new i(13,new Array(6,34,62),new r(26,new n(4,107)),new r(22,new n(8,37),new n(1,38)),new r(24,new n(8,20),new n(4,21)),new r(22,new n(12,11),new n(4,12))),new i(14,new Array(6,26,46,66),new r(30,new n(3,115),new n(1,116)),new r(24,new n(4,40),new n(5,41)),new r(20,new n(11,16),new n(5,17)),new r(24,new n(11,12),new n(5,13))),new i(15,new Array(6,26,48,70),new r(22,new n(5,87),new n(1,88)),new r(24,new n(5,41),new n(5,42)),new r(30,new n(5,24),new n(7,25)),new r(24,new n(11,12),new n(7,13))),new i(16,new Array(6,26,50,74),new r(24,new n(5,98),new n(1,99)),new r(28,new n(7,45),new n(3,46)),new r(24,new n(15,19),new n(2,20)),new r(30,new n(3,15),new n(13,16))),new i(17,new Array(6,30,54,78),new r(28,new n(1,107),new n(5,108)),new r(28,new n(10,46),new n(1,47)),new r(28,new n(1,22),new n(15,23)),new r(28,new n(2,14),new n(17,15))),new i(18,new Array(6,30,56,82),new r(30,new n(5,120),new n(1,121)),new r(26,new n(9,43),new n(4,44)),new r(28,new n(17,22),new n(1,23)),new r(28,new n(2,14),new n(19,15))),new i(19,new Array(6,30,58,86),new r(28,new n(3,113),new n(4,114)),new r(26,new n(3,44),new n(11,45)),new r(26,new n(17,21),new n(4,22)),new r(26,new n(9,13),new n(16,14))),new i(20,new Array(6,34,62,90),new r(28,new n(3,107),new n(5,108)),new r(26,new n(3,41),new n(13,42)),new r(30,new n(15,24),new n(5,25)),new r(28,new n(15,15),new n(10,16))),new i(21,new Array(6,28,50,72,94),new r(28,new n(4,116),new n(4,117)),new r(26,new n(17,42)),new r(28,new n(17,22),new n(6,23)),new r(30,new n(19,16),new n(6,17))),new i(22,new Array(6,26,50,74,98),new r(28,new n(2,111),new n(7,112)),new r(28,new n(17,46)),new r(30,new n(7,24),new n(16,25)),new r(24,new n(34,13))),new i(23,new Array(6,30,54,74,102),new r(30,new n(4,121),new n(5,122)),new r(28,new n(4,47),new n(14,48)),new r(30,new n(11,24),new n(14,25)),new r(30,new n(16,15),new n(14,16))),new i(24,new Array(6,28,54,80,106),new r(30,new n(6,117),new n(4,118)),new r(28,new n(6,45),new n(14,46)),new r(30,new n(11,24),new n(16,25)),new r(30,new n(30,16),new n(2,17))),new i(25,new Array(6,32,58,84,110),new r(26,new n(8,106),new n(4,107)),new r(28,new n(8,47),new n(13,48)),new r(30,new n(7,24),new n(22,25)),new r(30,new n(22,15),new n(13,16))),new i(26,new Array(6,30,58,86,114),new r(28,new n(10,114),new n(2,115)),new r(28,new n(19,46),new n(4,47)),new r(28,new n(28,22),new n(6,23)),new r(30,new n(33,16),new n(4,17))),new i(27,new Array(6,34,62,90,118),new r(30,new n(8,122),new n(4,123)),new r(28,new n(22,45),new n(3,46)),new r(30,new n(8,23),new n(26,24)),new r(30,new n(12,15),new n(28,16))),new i(28,new Array(6,26,50,74,98,122),new r(30,new n(3,117),new n(10,118)),new r(28,new n(3,45),new n(23,46)),new r(30,new n(4,24),new n(31,25)),new r(30,new n(11,15),new n(31,16))),new i(29,new Array(6,30,54,78,102,126),new r(30,new n(7,116),new n(7,117)),new r(28,new n(21,45),new n(7,46)),new r(30,new n(1,23),new n(37,24)),new r(30,new n(19,15),new n(26,16))),new i(30,new Array(6,26,52,78,104,130),new r(30,new n(5,115),new n(10,116)),new r(28,new n(19,47),new n(10,48)),new r(30,new n(15,24),new n(25,25)),new r(30,new n(23,15),new n(25,16))),new i(31,new Array(6,30,56,82,108,134),new r(30,new n(13,115),new n(3,116)),new r(28,new n(2,46),new n(29,47)),new r(30,new n(42,24),new n(1,25)),new r(30,new n(23,15),new n(28,16))),new i(32,new Array(6,34,60,86,112,138),new r(30,new n(17,115)),new r(28,new n(10,46),new n(23,47)),new r(30,new n(10,24),new n(35,25)),new r(30,new n(19,15),new n(35,16))),new i(33,new Array(6,30,58,86,114,142),new r(30,new n(17,115),new n(1,116)),new r(28,new n(14,46),new n(21,47)),new r(30,new n(29,24),new n(19,25)),new r(30,new n(11,15),new n(46,16))),new i(34,new Array(6,34,62,90,118,146),new r(30,new n(13,115),new n(6,116)),new r(28,new n(14,46),new n(23,47)),new r(30,new n(44,24),new n(7,25)),new r(30,new n(59,16),new n(1,17))),new i(35,new Array(6,30,54,78,102,126,150),new r(30,new n(12,121),new n(7,122)),new r(28,new n(12,47),new n(26,48)),new r(30,new n(39,24),new n(14,25)),new r(30,new n(22,15),new n(41,16))),new i(36,new Array(6,24,50,76,102,128,154),new r(30,new n(6,121),new n(14,122)),new r(28,new n(6,47),new n(34,48)),new r(30,new n(46,24),new n(10,25)),new r(30,new n(2,15),new n(64,16))),new i(37,new Array(6,28,54,80,106,132,158),new r(30,new n(17,122),new n(4,123)),new r(28,new n(29,46),new n(14,47)),new r(30,new n(49,24),new n(10,25)),new r(30,new n(24,15),new n(46,16))),new i(38,new Array(6,32,58,84,110,136,162),new r(30,new n(4,122),new n(18,123)),new r(28,new n(13,46),new n(32,47)),new r(30,new n(48,24),new n(14,25)),new r(30,new n(42,15),new n(32,16))),new i(39,new Array(6,26,54,82,110,138,166),new r(30,new n(20,117),new n(4,118)),new r(28,new n(40,47),new n(7,48)),new r(30,new n(43,24),new n(22,25)),new r(30,new n(10,15),new n(67,16))),new i(40,new Array(6,30,58,86,114,142,170),new r(30,new n(19,118),new n(6,119)),new r(28,new n(18,47),new n(31,48)),new r(30,new n(34,24),new n(34,25)),new r(30,new n(20,15),new n(61,16)))),i._av=function(e){if(e<1||e>40)throw"bad arguments";return i.VERSIONS[e-1]},i._at=function(e){if(e%4!=1)throw"Error _at";try{return i._av(e-17>>2)}catch(e){throw"Error _av"}},i._aw=function(e){for(var t=4294967295,n=0,r=0;r<i._bv.length;r++){var a=i._bv[r];if(a==e)return this._av(r+7);var o=w._gj(e,a);o<t&&(n=r+7,t=o)}return t<=3?this._av(n):null},a._ag=function(e,t,n,r,i,a,o,s,h,w,f,c,_,d,u,l){var v=this._be(e,t,n,r,i,a,o,s);return this._bf(h,w,f,c,_,d,u,l).times(v)},a._bf=function(e,t,n,r,i,o,s,h){var w=h-o,f=t-r+o-h;if(0==w&&0==f)return new a(n-e,i-n,e,r-t,o-r,t,0,0,1);var c=n-i,_=s-i,d=e-n+i-s,u=r-o,l=c*w-_*u,v=(d*w-_*f)/l,g=(c*f-d*u)/l;return new a(n-e+v*n,s-e+g*s,e,r-t+v*r,h-t+g*h,t,v,g,1)},a._be=function(e,t,n,r,i,a,o,s){return this._bf(e,t,n,r,i,a,o,s)._fr()};var s=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),h=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4);function w(e){this._cf=f.forBits(e>>3&3),this._fe=7&e,this.__defineGetter__("_cg",function(){return this._cf}),this.__defineGetter__("_dx",function(){return this._fe}),this.GetHashCode=function(){return this._cf.ordinal()<<3|_fe},this.Equals=function(e){var t=e;return this._cf==t._cf&&this._fe==t._fe}}function f(e,t,n){this._ff=e,this.bits=t,this.name=n,this.__defineGetter__("Bits",function(){return this.bits}),this.__defineGetter__("Name",function(){return this.name}),this.ordinal=function(){return this._ff}}w._gj=function(e,t){return h[15&(e^=t)]+h[15&k(e,4)]+h[15&k(e,8)]+h[15&k(e,12)]+h[15&k(e,16)]+h[15&k(e,20)]+h[15&k(e,24)]+h[15&k(e,28)]},w._ci=function(e){var t=w._cj(e);return null!=t?t:w._cj(21522^e)},w._cj=function(e){for(var t=4294967295,n=0,r=0;r<s.length;r++){var i=s[r],a=i[0];if(a==e)return new w(i[1]);var o=this._gj(e,a);o<t&&(n=i[1],t=o)}return t<=3?new w(n):null},f.forBits=function(e){if(e<0||e>=l.length)throw"bad arguments";return l[e]};var c=new f(0,1,"L"),_=new f(1,0,"M"),d=new f(2,3,"Q"),u=new f(3,2,"H"),l=new Array(_,c,u,d);function v(e,t){if(t||(t=e),e<1||t<1)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;0!=(31&e)&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var r=0;r<this.bits.length;r++)this.bits[r]=0;this.__defineGetter__("Width",function(){return this.width}),this.__defineGetter__("Height",function(){return this.height}),this.__defineGetter__("Dimension",function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}),this._ds=function(e,t){var n=t*this.rowSize+(e>>5);return 0!=(1&k(this.bits[n],31&e))},this._dq=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(31&e)},this.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0},this._bq=function(e,t,n,r){if(t<0||e<0)throw"Left and top must be nonnegative";if(r<1||n<1)throw"Height and width must be at least 1";var i=e+n,a=t+r;if(a>this.height||i>this.width)throw"The region must fit inside the matrix";for(var o=t;o<a;o++)for(var s=o*this.rowSize,h=e;h<i;h++)this.bits[s+(h>>5)]|=1<<(31&h)}}function g(e,t){this._dv=e,this._dw=t,this.__defineGetter__("_du",function(){return this._dv}),this.__defineGetter__("Codewords",function(){return this._dw})}g._gn=function(e,t,n){if(e.length!=t._dp)throw"bad arguments";for(var r=t._bu(n),i=0,a=r._fb(),o=0;o<a.length;o++)i+=a[o].Count;for(var s=new Array(i),h=0,w=0;w<a.length;w++){var f=a[w];for(o=0;o<f.Count;o++){var c=f._dm,_=r._bo+c;s[h++]=new g(c,new Array(_))}}for(var d=s[0]._dw.length,u=s.length-1;u>=0;){if(s[u]._dw.length==d)break;u--}u++;var l=d-r._bo,v=0;for(o=0;o<l;o++)for(w=0;w<h;w++)s[w]._dw[o]=e[v++];for(w=u;w<h;w++)s[w]._dw[l]=e[v++];var p=s[0]._dw.length;for(o=l;o<p;o++)for(w=0;w<h;w++){var m=w<u?o:o+1;s[w]._dw[m]=e[v++]}return s};var p={};function m(e,t){if(null==t||0==t.length)throw"bad arguments";this._fa=e;var n=t.length;if(n>1&&0==t[0]){for(var r=1;r<n&&0==t[r];)r++;if(r==n)this._dd=e.Zero._dd;else{this._dd=new Array(n-r);for(var i=0;i<this._dd.length;i++)this._dd[i]=0;for(var a=0;a<this._dd.length;a++)this._dd[a]=t[r+a]}}else this._dd=t;this.__defineGetter__("Zero",function(){return 0==this._dd[0]}),this.__defineGetter__("_ec",function(){return this._dd.length-1}),this.__defineGetter__("Coefficients",function(){return this._dd}),this._ex=function(e){return this._dd[this._dd.length-1-e]},this.evaluateAt=function(e){if(0==e)return this._ex(0);var t=this._dd.length;if(1==e){for(var n=0,r=0;r<t;r++)n=y._bd(n,this._dd[r]);return n}var i=this._dd[0];for(r=1;r<t;r++)i=y._bd(this._fa.multiply(e,i),this._dd[r]);return i},this._bd=function(t){if(this._fa!=t._fa)throw"GF256Polys do not have same _az _fa";if(this.Zero)return t;if(t.Zero)return this;var n=this._dd,r=t._dd;if(n.length>r.length){var i=n;n=r,r=i}for(var a=new Array(r.length),o=r.length-n.length,s=0;s<o;s++)a[s]=r[s];for(var h=o;h<r.length;h++)a[h]=y._bd(n[h-o],r[h]);return new m(e,a)},this.multiply1=function(e){if(this._fa!=e._fa)throw"GF256Polys do not have same _az _fa";if(this.Zero||e.Zero)return this._fa.Zero;for(var t=this._dd,n=t.length,r=e._dd,i=r.length,a=new Array(n+i-1),o=0;o<n;o++)for(var s=t[o],h=0;h<i;h++)a[o+h]=y._bd(a[o+h],this._fa.multiply(s,r[h]));return new m(this._fa,a)},this.multiply2=function(e){if(0==e)return this._fa.Zero;if(1==e)return this;for(var t=this._dd.length,n=new Array(t),r=0;r<t;r++)n[r]=this._fa.multiply(this._dd[r],e);return new m(this._fa,n)},this._dc=function(e,t){if(e<0)throw"bad arguments";if(0==t)return this._fa.Zero;for(var n=this._dd.length,r=new Array(n+e),i=0;i<r.length;i++)r[i]=0;for(i=0;i<n;i++)r[i]=this._fa.multiply(this._dd[i],t);return new m(this._fa,r)},this.divide=function(e){if(this._fa!=e._fa)throw"GF256Polys do not have same _az _fa";if(e.Zero)throw"Divide by 0";for(var t=this._fa.Zero,n=this,r=e._ex(e._ec),i=this._fa.inverse(r);n._ec>=e._ec&&!n.Zero;){var a=n._ec-e._ec,o=this._fa.multiply(n._ex(n._ec),i),s=e._dc(a,o),h=this._fa._ba(a,o);t=t._bd(h),n=n._bd(s)}return new Array(t,n)}}function y(e){this._gh=new Array(256),this._gi=new Array(256);for(var t=1,n=0;n<256;n++)this._gh[n]=t,(t<<=1)>=256&&(t^=e);for(n=0;n<255;n++)this._gi[this._gh[n]]=n;var r=new Array(1);r[0]=0,this.zero=new m(this,new Array(r));var i=new Array(1);i[0]=1,this.one=new m(this,new Array(i)),this.__defineGetter__("Zero",function(){return this.zero}),this.__defineGetter__("One",function(){return this.one}),this._ba=function(e,t){if(e<0)throw"bad arguments";if(0==t)return zero;for(var n=new Array(e+1),r=0;r<n.length;r++)n[r]=0;return n[0]=t,new m(this,n)},this.exp=function(e){return this._gh[e]},this.log=function(e){if(0==e)throw"bad arguments";return this._gi[e]},this.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this._gh[255-this._gi[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this._gh[(this._gi[e]+this._gi[t])%255]}}p._gl=function(e){if(e<0||e>7)throw"bad arguments";return p._dy[e]},p._dy=new Array(new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){return 0==(e+t&1)}},new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){return 0==(1&e)}},new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){return t%3==0}},new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){return(e+t)%3==0}},new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){return 0==(k(e,1)+t/3&1)}},new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){var n=e*t;return(1&n)+n%3==0}},new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){var n=e*t;return 0==((1&n)+n%3&1)}},new function(){this._dj=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this._fw(n,r)&&e.flip(r,n)},this._fw=function(e,t){return 0==((e+t&1)+e*t%3&1)}}),y._bb=new y(285),y._bc=new y(301),y._bd=function(e,t){return e^t};var b={};b.rsDecoder=new function(e){this._fa=e,this.decode=function(e,t){for(var n=new m(this._fa,e),r=new Array(t),i=0;i<r.length;i++)r[i]=0;var a=!0;for(i=0;i<t;i++){var o=n.evaluateAt(this._fa.exp(i));r[r.length-1-i]=o,0!=o&&(a=!1)}if(!a){var s=new m(this._fa,r),h=this._eb(this._fa._ba(t,1),s,t),w=h[0],f=h[1],c=this._ey(w),_=this._di(f,c,!1);for(i=0;i<c.length;i++){var d=e.length-1-this._fa.log(c[i]);if(d<0)throw"ReedSolomonException Bad error location";e[d]=y._bd(e[d],_[i])}}},this._eb=function(e,t,n){if(e._ec<t._ec){var r=e;e=t,t=r}for(var i=e,a=t,o=this._fa.One,s=this._fa.Zero,h=this._fa.Zero,w=this._fa.One;a._ec>=Math.floor(n/2);){var f=i,c=o,_=h;if(o=s,h=w,(i=a).Zero)throw"r_{i-1} was zero";a=f;for(var d=this._fa.Zero,u=i._ex(i._ec),l=this._fa.inverse(u);a._ec>=i._ec&&!a.Zero;){var v=a._ec-i._ec,g=this._fa.multiply(a._ex(a._ec),l);d=d._bd(this._fa._ba(v,g)),a=a._bd(i._dc(v,g))}s=d.multiply1(o)._bd(c),w=d.multiply1(h)._bd(_)}var p=w._ex(0);if(0==p)throw"ReedSolomonException sigmaTilde(0) was zero";var m=this._fa.inverse(p),y=w.multiply2(m),b=a.multiply2(m);return new Array(y,b)},this._ey=function(e){var t=e._ec;if(1==t)return new Array(e._ex(1));for(var n=new Array(t),r=0,i=1;i<256&&r<t;i++)0==e.evaluateAt(i)&&(n[r]=this._fa.inverse(i),r++);if(r!=t)throw"Error locator degree does not match number of roots";return n},this._di=function(e,t,n){for(var r=t.length,i=new Array(r),a=0;a<r;a++){for(var o=this._fa.inverse(t[a]),s=1,h=0;h<r;h++)a!=h&&(s=this._fa.multiply(s,y._bd(1,this._fa.multiply(t[h],o))));i[a]=this._fa.multiply(e.evaluateAt(o),this._fa.inverse(s)),n&&(i[a]=this._fa.multiply(i[a],o))}return i}}(y._bb),b.correctErrors=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++)r[i]=255&e[i];var a=e.length-t;try{b.rsDecoder.decode(r,a)}catch(e){throw e}for(i=0;i<t;i++)e[i]=r[i]},b.decode=function(e){for(var t=new function(e){var t=e.Dimension;if(t<21||1!=(3&t))throw"Error _cl";this._au=e,this._cp=null,this._co=null,this._dk=function(e,t,n){return this._au._ds(e,t)?n<<1|1:n<<1},this._cm=function(){if(null!=this._co)return this._co;for(var e=0,t=0;t<6;t++)e=this._dk(t,8,e);e=this._dk(7,8,e),e=this._dk(8,8,e),e=this._dk(8,7,e);for(var n=5;n>=0;n--)e=this._dk(8,n,e);if(this._co=w._ci(e),null!=this._co)return this._co;var r=this._au.Dimension;e=0;var i=r-8;for(t=r-1;t>=i;t--)e=this._dk(t,8,e);for(n=r-7;n<r;n++)e=this._dk(8,n,e);if(this._co=w._ci(e),null!=this._co)return this._co;throw"Error _cm"},this._cq=function(){if(null!=this._cp)return this._cp;var e=this._au.Dimension,t=e-17>>2;if(t<=6)return i._av(t);for(var n=0,r=e-11,a=5;a>=0;a--)for(var o=e-9;o>=r;o--)n=this._dk(o,a,n);if(this._cp=i._aw(n),null!=this._cp&&this._cp._cr==e)return this._cp;for(n=0,o=5;o>=0;o--)for(a=e-9;a>=r;a--)n=this._dk(o,a,n);if(this._cp=i._aw(n),null!=this._cp&&this._cp._cr==e)return this._cp;throw"Error _cq"},this._gk=function(){var e=this._cm(),t=this._cq(),n=p._gl(e._dx),r=this._au.Dimension;n._dj(this._au,r);for(var i=t._aq(),a=!0,o=new Array(t._dp),s=0,h=0,w=0,f=r-1;f>0;f-=2){6==f&&f--;for(var c=0;c<r;c++)for(var _=a?r-1-c:c,d=0;d<2;d++)i._ds(f-d,_)||(w++,h<<=1,this._au._ds(f-d,_)&&(h|=1),8==w&&(o[s++]=h,w=0,h=0));a^=!0}if(s!=t._dp)throw"Error _gk";return o}}(e),n=t._cq(),r=t._cm()._cg,a=t._gk(),o=g._gn(a,n,r),s=0,h=0;h<o.length;h++)s+=o[h]._du;for(var f=new Array(s),c=0,_=0;_<o.length;_++){var d=o[_],u=d.Codewords,l=d._du;b.correctErrors(u,l);for(h=0;h<l;h++)f[c++]=u[h]}return new function(e,t,n){this._ed=0,this._cw=7,this.dataLength=0,this.blocks=e,this._en=n,t<=9?this.dataLengthMode=0:t>=10&&t<=26?this.dataLengthMode=1:t>=27&&t<=40&&(this.dataLengthMode=2);this._gd=function(e){var t=0;if(e<this._cw+1){for(var n=0,r=0;r<e;r++)n+=1<<r;return n<<=this._cw-e+1,t=(this.blocks[this._ed]&n)>>this._cw-e+1,this._cw-=e,t}if(e<this._cw+1+8){for(var i=0,r=0;r<this._cw+1;r++)i+=1<<r;return t=(this.blocks[this._ed]&i)<<e-(this._cw+1),this._ed++,t+=this.blocks[this._ed]>>8-(e-(this._cw+1)),this._cw=this._cw-e%8,this._cw<0&&(this._cw=8+this._cw),t}if(e<this._cw+1+16){for(var i=0,a=0,r=0;r<this._cw+1;r++)i+=1<<r;var o=(this.blocks[this._ed]&i)<<e-(this._cw+1);this._ed++;var s=this.blocks[this._ed]<<e-(this._cw+1+8);this._ed++;for(var r=0;r<e-(this._cw+1+8);r++)a+=1<<r;a<<=8-(e-(this._cw+1+8));var h=(this.blocks[this._ed]&a)>>8-(e-(this._cw+1+8));return t=o+s+h,this._cw=this._cw-(e-8)%8,this._cw<0&&(this._cw=8+this._cw),t}return 0},this.NextMode=function(){return this._ed>this.blocks.length-this._en-2?0:this._gd(4)},this.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this._gd(A._eo[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t=e,n=0,r="",i=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do{if(t>1){n=this._gd(11);var a=Math.floor(n/45),o=n%45;r+=i[a],r+=i[o],t-=2}else 1==t&&(n=this._gd(6),r+=i[n],t-=1)}while(t>0);return r},this.getFigureString=function(e){var t=e,n=0,r="";do{t>=3?((n=this._gd(10))<100&&(r+="0"),n<10&&(r+="0"),t-=3):2==t?((n=this._gd(7))<10&&(r+="0"),t-=2):1==t&&(n=this._gd(4),t-=1),r+=n}while(t>0);return r},this.get8bitByteArray=function(e){var t=e,n=0,r=new Array;do{n=this._gd(8),r.push(n),t--}while(t>0);return r},this.getKanjiString=function(e){var t=e,n=0,r="";do{var i=(n=_gd(13))%192,a=n/192,o=(a<<8)+i,s=0;s=o+33088<=40956?o+33088:o+49472,r+=String.fromCharCode(s),t--}while(t>0);return r},this.__defineGetter__("DataByte",function(){for(var e=new Array;;){var t=this.NextMode();if(0==t){if(e.length>0)break;throw"Empty data block"}if(1!=t&&2!=t&&4!=t&&8!=t)throw"Invalid mode: "+t+" in (block:"+this._ed+" bit:"+this._cw+")";var n=this.getDataLength(t);if(n<1)throw"Invalid data length: "+n;switch(t){case 1:for(var r=this.getFigureString(n),i=new Array(r.length),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);e.push(i);break;case 2:for(var r=this.getRomanAndFigureString(n),i=new Array(r.length),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);e.push(i);break;case 4:var o=this.get8bitByteArray(n);e.push(o);break;case 8:var r=this.getKanjiString(n);e.push(r)}}return e})}(f,n._fd,r.Bits)};var A={};function k(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}A.imagedata=null,A.width=0,A.height=0,A.qrCodeSymbol=null,A.debug=!1,A.maxImgSize=1048576,A._eo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],A.callback=null,A.vidSuccess=function(e){A.localstream=e,A.webkit?A.video.src=window.webkitURL.createObjectURL(e):A.moz?(A.video.mozSrcObject=e,A.video.play()):A.video.src=e,A.gUM=!0,A.canvas_qr2=document.createElement("canvas"),A.canvas_qr2.id="QRScanner-canvasEl",A.qrcontext2=A.canvas_qr2.getContext("2d"),A.canvas_qr2.width=A.video.videoWidth,A.canvas_qr2.height=A.video.videoHeight,setTimeout(A.captureToCanvas,500)},A.vidError=function(e){A.gUM=!1},A.captureToCanvas=function(){if(A.gUM)try{if(0==A.video.videoWidth)return void setTimeout(A.captureToCanvas,500);A.canvas_qr2.width=A.video.videoWidth,A.canvas_qr2.height=A.video.videoHeight,A.qrcontext2.drawImage(A.video,0,0);try{A.decode()}catch(e){setTimeout(A.captureToCanvas,500)}}catch(e){setTimeout(A.captureToCanvas,500)}},A.setWebcam=function(e){var t=navigator;A.video=document.getElementById(e);var n=!0;if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then(function(e){e.forEach(function(e){"videoinput"===e.kind&&e.label.toLowerCase().search("back")>-1&&(n=[{sourceId:e.deviceId}])})})}catch(e){}else console.log("no navigator.mediaDevices.enumerateDevices");t.getUserMedia?t.getUserMedia({video:n,audio:!1},A.vidSuccess,A.vidError):t.webkitGetUserMedia?(A.webkit=!0,t.webkitGetUserMedia({video:n,audio:!1},A.vidSuccess,A.vidError)):t.mozGetUserMedia&&(A.moz=!0,t.mozGetUserMedia({video:n,audio:!1},A.vidSuccess,A.vidError))},A.decode=function(e){if(0==arguments.length){if(A.canvas_qr2)var t=A.canvas_qr2,n=A.qrcontext2;else n=(t=document.getElementById("QRScanner-canvasEl")||document.getElementById("qr-canvas")).getContext("2d");return A.width=t.width,A.height=t.height,A.imagedata=n.getImageData(0,0,A.width,A.height),A.result=A.process(n),null!=A.callback&&A.callback(A.result),A.result}var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){var e=document.getElementById("out-canvas");if(null!=e){var t=e.getContext("2d");t.clearRect(0,0,320,240),t.drawImage(r,0,0,320,240)}var n=document.createElement("canvas"),i=n.getContext("2d"),a=r.height,o=r.width;if(r.width*r.height>A.maxImgSize){var s=r.width/r.height;o=s*(a=Math.sqrt(A.maxImgSize/s))}n.width=o,n.height=a,i.drawImage(r,0,0,n.width,n.height),A.width=n.width,A.height=n.height;try{A.imagedata=i.getImageData(0,0,n.width,n.height)}catch(e){return A.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",void(null!=A.callback&&A.callback(A.result))}try{A.result=A.process(i)}catch(e){A.result="error decoding QR Code"}null!=A.callback&&A.callback(A.result)},r.onerror=function(){null!=A.callback&&A.callback("Failed to load the image")},r.src=e},A.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},A.decode_url=function(e){var t="";try{t=escape(e)}catch(n){t=e}var n="";try{n=decodeURIComponent(t)}catch(e){n=t}return n},A.decode_utf8=function(e){return A.isUrl(e)?A.decode_url(e):e},A.process=function(e){var t=(new Date).getTime(),n=A.grayScaleToBitmap(A.grayscale());if(A.debug){for(var r=0;r<A.height;r++)for(var i=0;i<A.width;i++){var a=4*i+r*A.width*4;A.imagedata.data[a]=(n[i+r*A.width],0),A.imagedata.data[a+1]=(n[i+r*A.width],0),A.imagedata.data[a+2]=n[i+r*A.width]?255:0}e.putImageData(A.imagedata,0,0)}var s=new o(n).detect();if(A.debug){for(r=0;r<s.bits.Height;r++)for(i=0;i<s.bits.Width;i++){a=4*i*2+2*r*A.width*4;A.imagedata.data[a]=(s.bits._ds(i,r),0),A.imagedata.data[a+1]=(s.bits._ds(i,r),0),A.imagedata.data[a+2]=s.bits._ds(i,r)?255:0}e.putImageData(A.imagedata,0,0)}for(var h=b.decode(s.bits).DataByte,w="",f=0;f<h.length;f++)for(var c=0;c<h[f].length;c++)w+=String.fromCharCode(h[f][c]);(new Date).getTime();return A.decode_utf8(w)},A.getPixel=function(e,t){if(A.width<e)throw"point error";if(A.height<t)throw"point error";var n=4*e+t*A.width*4;return(33*A.imagedata.data[n]+34*A.imagedata.data[n+1]+33*A.imagedata.data[n+2])/100},A.binarize=function(e){for(var t=new Array(A.width*A.height),n=0;n<A.height;n++)for(var r=0;r<A.width;r++){var i=A.getPixel(r,n);t[r+n*A.width]=i<=e}return t},A._em=function(e){for(var t=Math.floor(A.width/4),n=Math.floor(A.height/4),r=new Array(4),i=0;i<4;i++){r[i]=new Array(4);for(var a=0;a<4;a++)r[i][a]=new Array(0,0)}for(var o=0;o<4;o++)for(var s=0;s<4;s++){r[s][o][0]=255;for(var h=0;h<n;h++)for(var w=0;w<t;w++){var f=e[t*s+w+(n*o+h)*A.width];f<r[s][o][0]&&(r[s][o][0]=f),f>r[s][o][1]&&(r[s][o][1]=f)}}for(var c=new Array(4),_=0;_<4;_++)c[_]=new Array(4);for(o=0;o<4;o++)for(s=0;s<4;s++)c[s][o]=Math.floor((r[s][o][0]+r[s][o][1])/2);return c},A.grayScaleToBitmap=function(e){for(var t=A._em(e),n=t.length,r=Math.floor(A.width/n),i=Math.floor(A.height/n),a=new ArrayBuffer(A.width*A.height),o=new Uint8Array(a),s=0;s<n;s++)for(var h=0;h<n;h++)for(var w=0;w<i;w++)for(var f=0;f<r;f++)o[r*h+f+(i*s+w)*A.width]=e[r*h+f+(i*s+w)*A.width]<t[h][s];return o},A.grayscale=function(){for(var e=new ArrayBuffer(A.width*A.height),t=new Uint8Array(e),n=0;n<A.height;n++)for(var r=0;r<A.width;r++){var i=A.getPixel(r,n);t[r+n*A.width]=i}return t};var x=3,M=57,C=8,N=2;function $(e,t,n){this.x=e,this.y=t,this.count=1,this._aj=n,this.__defineGetter__("_ei",function(){return this._aj}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return Math.floor(this.x)}),this.__defineGetter__("Y",function(){return Math.floor(this.y)}),this._ek=function(){this.count++},this._ev=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this._aj);return r<=1||r/this._aj<=1}return!1}}A._er=function(e){function t(e,t){var n=e.X-t.X,r=e.Y-t.Y;return Math.sqrt(n*n+r*r)}var n,r,i,a,o,s,h,w,f=t(e[0],e[1]),c=t(e[1],e[2]),_=t(e[0],e[2]);if(c>=f&&c>=_?(r=e[0],n=e[1],i=e[2]):_>=c&&_>=f?(r=e[1],n=e[0],i=e[2]):(r=e[2],n=e[0],i=e[1]),a=n,s=i,h=(o=r).x,w=o.y,(s.x-h)*(a.y-w)-(s.y-w)*(a.x-h)<0){var d=n;n=i,i=d}e[0]=n,e[1]=r,e[2]=i},e.qrcode=A}}let n=!1,r={};function i(e,t,n,r){n=n||0,"insertRule"in(r=r||o)?r.insertRule(e+"{"+t+"}",n):"addRule"in r&&r.addRule(e,t,n)}var a,o=((a=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(a),a.sheet);return e.initiate=function(e){let a=e||{};function o(e){a.match&&e&&!e.match(a.match)||(window.clearInterval(r.timer),window.clearTimeout(r.timeOut),r.stream.getTracks()[0].stop(),r.container.style.display="none",r.lockLayer.style.display="none",r.ctx.clearRect(0,0,240,200),!1!==e&&e&&a.onResult(e))}a.onResult=function(e){console.info("RESULT ::: ",e)},a.onError=function(e){console.error("ERR :::: ",e)},a.onTimeout=function(){console.warn("TIMEDOUT")},navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(window.clearInterval(r.timer),n?(r.container.style.display="block",r.lockLayer.style.display="block"):(t(r),function(e){e=e||{};let t=document.createElement("div"),n=document.createElement("div");n.className="QRScanner-lock-layer "+e.lockLayerClassName,t.className="QRScanner-container "+e.className;let a='<canvas id="QRScanner-canvasEl" width="240" height="200"></canvas>';a+='<video id="QRScanner-videoEl" style="display: none;" width="200" height="200"></video>',t.innerHTML=a,n.innerHTML=".......",i(".QRScanner-container",`position: fixed;\n            left: 0;\n            top: 0;\n            right: 0;\n            bottom: 0;\n            box-sizing: border-box;\n            width: 260px;\n            height: 220px;\n            z-index: 999999999;\n            margin: auto;\n            padding: 10px;\n            display: block;\n            background-color: ${e.bgColor||"#f0f0f0"};\n            box-shadow: ${e.shadow||"0px 0px 10px #000"}\n        `),i(".QRScanner-lock-layer","position: fixed;\n            left: 0;\n            top: 0;\n            right: 0;\n            bottom: 0;\n            box-sizing: border-box;\n            width: 100%;\n            height: 100%;\n            z-index: 999999995;\n            margin: auto;\n            display: block;\n            background-color: #000;\n            opacity: .3;\n        "),(e.parent||document.body).appendChild(t),(e.lockLayerParent||document.body).appendChild(n),r.lockLayer=n,r.container=t}(a),r.video=document.getElementById("QRScanner-videoEl"),r.canvas=document.getElementById("QRScanner-canvasEl"),r.ctx=r.canvas.getContext("2d"),r.draw=function(e){r.ctx.drawImage(e,0,0,240,200)},r.qrcode.callback=function(e){o(e)},n=!0,document.body.addEventListener("keyup",e=>{27===e.keyCode&&o()})),r.lockLayer.onclick=(e=>{o()}),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){r.video.src=window.URL.createObjectURL(e),r.video.play(),r.stream=e,r.timer=window.setInterval(function(){r.draw(r.video);try{r.qrcode.decode()}catch(e){}},200),r.timeOut=window.setTimeout(function(){a.onTimeout(),o(!1)},a.timeout||2e4)})):a.onError("Media Devices is not supported!")},e})?r.apply(t,i):r)||(e.exports=a)}});