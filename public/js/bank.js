(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"4MhE":function(t,e,n){"use strict";n("CImE")},5:function(t,e,n){t.exports=n("C05K")},C05K:function(t,e,n){"use strict";n.r(e);var r=n("XuX8"),a=n.n(r),s=n("1QPe"),o=n("o0o1"),i=n.n(o);function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e}var e,n,r;return e=t,(n=[{key:"set",value:function(t){sessionStorage.setItem(this.key,t)}},{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=sessionStorage.getItem(this.key);return void 0!==e&&null!=e&&e.length>0?e:t}},{key:"forget",value:function(){sessionStorage.removeItem(this.key)}}])&&l(e.prototype,n),r&&l(e,r),t}(),u=new a.a,p=n("o0O0"),d=n("aqyy"),f=n("bRJq");function v(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var _={components:{BModal:d.a,QrcodeStream:f.QrcodeStream},props:{title:{type:String,required:!1,default:"QR Code Scanner"},validator:{type:Function,required:!1},validatorMessage:{type:String,required:!1,default:"Invalid input."}},data:function(){return{loading:!1,isValid:void 0,camera:"auto",errorMessage:void 0}},computed:{validationPending:function(){return void 0===this.isValid&&"off"===this.camera},validationSuccess:function(){return!0===this.isValid},validationFailure:function(){return!1===this.isValid}},methods:{open:function(){this.$refs.modal.show(),this.turnCameraOn()},onInit:function(t){var e=this;this.loading=!0,this.errorMessage=void 0,t.catch((function(t){return e.errorMessage=t.message})).then(this.resetValidationState).then((function(){return e.loading=!1}))},resetValidationState:function(){this.isValid=void 0},onDecode:function(t){var e,n=this;return(e=i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.turnCameraOff(),e.next=3,n.timeout(250);case 3:if(n.isValid=!n.validator||n.validator(t),!n.isValid){e.next=11;break}return e.next=7,n.timeout(1e3);case 7:return n.$emit("decode",t),n.resetValidationState(),n.$refs.modal.hide(),e.abrupt("return");case 11:return e.next=13,n.timeout(2500);case 13:n.turnCameraOn();case 14:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(t){v(s,r,a,o,i,"next",t)}function i(t){v(s,r,a,o,i,"throw",t)}o(void 0)}))})()},turnCameraOn:function(){this.camera="auto"},turnCameraOff:function(){this.camera="off"},timeout:function(t){return new Promise((function(e){window.setTimeout(e,t)}))}}},m=(n("4MhE"),n("KHd+")),h=Object(m.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{ref:"modal",attrs:{title:t.title,"no-fade":"","hide-footer":""}},[n("qrcode-stream",{staticStyle:{width:"100%",height:"100%"},attrs:{camera:t.camera},on:{init:t.onInit,decode:t.onDecode}},[t.errorMessage?n("div",{staticClass:"loading-indicator"},[t._v("\n            "+t._s(t.errorMessage)+"\n        ")]):t._e(),t._v(" "),t.loading?n("div",{staticClass:"loading-indicator"},[n("font-awesome-icon",{attrs:{icon:"cog",spin:""}})],1):t._e(),t._v(" "),t.validationSuccess?n("div",{staticClass:"validation-success"},[n("font-awesome-icon",{attrs:{icon:"check"}})],1):t._e(),t._v(" "),t.validationFailure?n("div",{staticClass:"validation-failure"},[t._v("\n            "+t._s(t.validatorMessage)+"\n        ")]):t._e(),t._v(" "),t.validationPending?n("div",{staticClass:"validation-pending"},[n("font-awesome-icon",{attrs:{icon:"cog",spin:""}})],1):t._e()])],1)}),[],!1,null,"1dc289ee",null).exports,b={components:{CodeScannerModal:h},props:{value:{type:String,required:!1,default:""},placeholder:{type:String,required:!1,default:"Search..."},busy:Boolean,disabled:Boolean},data:function(){return{filter:this.value}},mounted:function(){var t=this;this.$nextTick((function(){t.$refs.input.focus()})),u.$on("zero-results",(function(){t.$refs.input.select()}))},methods:{submit:function(){this.$emit("submit",this.filter)},reset:function(){this.filter="",this.$emit("reset"),this.$refs.input.focus()},scanCard:function(){this.$refs.codeScanner.open()},submitScannedCode:function(t){this.filter=t,this.submit()},validateCode:function(t){return Object(p.c)(t)}}},y=Object(m.a)(b,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.filter,expression:"filter"}],ref:"input",staticClass:"form-control",attrs:{type:"text",placeholder:t.placeholder,disabled:t.busy||t.disabled},domProps:{value:t.filter},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.reset(e)}],focus:function(e){return t.$refs.input.select()},input:function(e){e.target.composing||(t.filter=e.target.value)}}}),t._v(" "),n("div",{staticClass:"input-group-append"},[t.busy?n("span",{staticClass:"input-group-text"},[n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}})],1):[n("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:!t.filter||t.disabled},on:{click:t.submit}},[n("font-awesome-icon",{attrs:{icon:"search"}})],1),t._v(" "),n("button",{staticClass:"btn btn-secondary",attrs:{type:"button",disabled:!t.filter||t.disabled},on:{click:t.reset}},[n("font-awesome-icon",{attrs:{icon:"eraser"}})],1)]],2)])]),t._v(" "),n("div",{staticClass:"col-auto"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:t.busy||t.disabled},on:{click:t.scanCard}},[n("font-awesome-icon",{attrs:{icon:"qrcode"}}),t._v(" "),n("span",{staticClass:"d-none d-sm-inline"},[t._v("\n                "+t._s(t.$t("people.scan_card"))+"\n            ")])],1)]),t._v(" "),n("code-scanner-modal",{ref:"codeScanner",attrs:{title:t.$t("people.qr_code_scanner"),validator:t.validateCode,"validator-message":t.$t("app.only_letters_and_numbers_allowed")},on:{decode:t.submitScannedCode}})],1)}),[],!1,null,null,null).exports,g={props:{url:{type:String,required:!1,default:null}},computed:{label:function(){return this.$t("cmtyvol.community_volunteer").toUpperCase()}}},w=Object(m.a)(g,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return null!=t.url?n("strong",[n("a",{staticClass:"text-warning",attrs:{href:t.url}},[t._v(t._s(t.label))])]):n("strong",{staticClass:"text-warning"},[t._v("\n    "+t._s(t.label)+"\n")])}),[],!1,null,null,null).exports,k=n("tQyR"),x={components:{TextHighlight:k.a},props:{url:{type:String,required:!1,default:null},value:{type:String,required:!0},highlightTerms:{type:Array,required:!1,default:[]}}},C=Object(m.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return null!=t.url?n("a",{attrs:{href:t.url}},[n("strong",[n("text-highlight",{attrs:{queries:t.highlightTerms}},[t._v(t._s(t.value))])],1)]):n("strong",[n("text-highlight",{attrs:{queries:t.highlightTerms}},[t._v(t._s(t.value))])],1)}),[],!1,null,null,null).exports,$=n("K9XY"),O=n("o0Hb");function P(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var B={props:{person:{required:!0},allowUpdate:Boolean,disabled:Boolean},data:function(){return{busy:!1,gender:this.person.gender}},methods:{setGender:function(t){var e,n=this;return(e=i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.busy=!0,e.prev=1,e.next=4,O.a.updateGender(n.person.id,t);case 4:r=e.sent,n.gender=t,Object($.a)(r.message),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(n.$t("app.error_err",{err:e.t0}));case 12:n.busy=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(t){P(s,r,a,o,i,"next",t)}function i(t){P(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},j=Object(m.a)(B,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t.busy?n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}}):"m"==t.gender?n("font-awesome-icon",{attrs:{icon:"male"}}):"f"==t.gender?n("font-awesome-icon",{attrs:{icon:"female"}}):t.allowUpdate?[n("button",{staticClass:"btn btn-warning btn-sm",attrs:{title:"Male",disabled:t.disabled},on:{click:function(e){return t.setGender("m")}}},[n("font-awesome-icon",{attrs:{icon:"male"}})],1),t._v(" "),n("button",{staticClass:"btn btn-warning btn-sm",attrs:{title:"Female",disabled:t.disabled},on:{click:function(e){return t.setGender("f")}}},[n("font-awesome-icon",{attrs:{icon:"female"}})],1)]:t._e()],2)}),[],!1,null,null,null).exports;function E(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var S={props:{person:{required:!0},allowUpdate:Boolean,disabled:Boolean},data:function(){return{busy:!1,form:!1,dateOfBirth:null!=this.person.date_of_birth&&this.person.date_of_birth.length>0?this.person.date_of_birth:null,newDateOfBirth:null}},computed:{age:function(){return Object(p.b)(this.dateOfBirth)},today:function(){return Object(p.h)()}},watch:{form:function(t,e){var n=this;t&&!e&&this.$nextTick((function(){return n.$refs.input.focus()})),!t&&e&&(this.newDateOfBirth=null)}},methods:{setDateOfBirth:function(){var t,e=this;return(t=i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e.newDateOfBirth&&Object(p.d)(e.newDateOfBirth)){t.next=3;break}return e.$refs.input.select(),t.abrupt("return");case 3:return e.busy=!0,t.prev=4,t.next=7,O.a.updateDateOfBirth(e.person.id,e.newDateOfBirth);case 7:n=t.sent,e.dateOfBirth=e.newDateOfBirth,e.form=!1,Object($.a)(n.message),e.$emit("changed",e.age),t.next=19;break;case 14:t.prev=14,t.t0=t.catch(4),alert(e.$t("app.error_err",{err:t.t0})),e.busy=!1,e.$nextTick((function(){return e.$refs.input.select()}));case 19:e.busy=!1;case 20:case"end":return t.stop()}}),t,null,[[4,14]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){E(s,r,a,o,i,"next",t)}function i(t){E(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},q=Object(m.a)(S,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"form-inline d-inline"},[t.busy?n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}}):null!=t.dateOfBirth?[t._v("\n        "+t._s(t.dateOfBirth)+"  ("+t._s(t.$t("people.age_n",{age:t.age}))+")\n    ")]:t.allowUpdate?[t.form?[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newDateOfBirth,expression:"newDateOfBirth"}],ref:"input",staticClass:"form-control form-control-sm",attrs:{type:"text",max:t.today,pattern:"[0-9]{4}-[0-9]{2}-[0-9]{2}'",title:"YYYY-MM-DD",placeholder:"YYYY-MM-DD"},domProps:{value:t.newDateOfBirth},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setDateOfBirth(e)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.form=!1}],input:function(e){e.target.composing||(t.newDateOfBirth=e.target.value)}}}),t._v(" "),n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.setDateOfBirth}},[n("font-awesome-icon",{attrs:{icon:"check"}})],1),t._v(" "),n("button",{staticClass:"btn btn-secondary btn-sm",attrs:{type:"button"},on:{click:function(e){t.form=!1}}},[n("font-awesome-icon",{attrs:{icon:"times"}})],1)]:n("button",{staticClass:"btn btn-warning btn-sm",attrs:{title:"Set date of birth",disabled:t.disabled},on:{click:function(e){t.form=!0}}},[n("font-awesome-icon",{attrs:{icon:"calendar-plus"}})],1)]:t._e()],2)}),[],!1,null,null,null).exports,D=n("GUe+"),N=n("R5cT"),V=n("a7GK"),I=n("+MZ5");function T(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}function R(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){T(s,r,a,o,i,"next",t)}function i(t){T(s,r,a,o,i,"throw",t)}o(void 0)}))}}var M={components:{BButton:D.a,BFormInput:N.a,BFormDatalist:V.a},props:{person:{required:!0},allowUpdate:Boolean,disabled:Boolean},data:function(){return{busy:!1,form:!1,nationality:null!=this.person.nationality&&this.person.nationality.length>0?this.person.nationality:null,newNationality:null,countries:[]}},watch:{form:function(t,e){var n=this;t&&!e&&(0==this.countries.length&&this.loadCountries(),this.$nextTick((function(){return n.$refs.input.focus()}))),!t&&e&&(this.newNationality=null)}},methods:{loadCountries:function(){var t=this;return R(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.listCountries("en");case 2:n=e.sent,t.countries=Object.values(n);case 4:case"end":return e.stop()}}),e)})))()},setNationality:function(){var t=this;return R(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.newNationality&&0!=t.newNationality.length){e.next=3;break}return t.$refs.input.select(),e.abrupt("return");case 3:return t.busy=!0,e.prev=4,e.next=7,O.a.updateNationality(t.person.id,t.newNationality);case 7:n=e.sent,t.nationality=t.newNationality,t.form=!1,Object($.a)(n.message),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(4),alert(t.$t("app.error_err",{err:e.t0})),t.busy=!1,t.$nextTick((function(){return t.$refs.input.select()}));case 18:t.busy=!1;case 19:case"end":return e.stop()}}),e,null,[[4,13]])})))()}}},F=Object(m.a)(M,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"form-inline d-inline"},[t.busy?n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}}):null!=t.nationality?[t._v("\n        "+t._s(t.nationality)+"\n    ")]:t.allowUpdate?[t.form?[n("b-form-input",{ref:"input",attrs:{size:"sm",placeholder:t.$t("people.choose_nationality"),list:"country-list"},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setNationality(e)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.form=!1}]},model:{value:t.newNationality,callback:function(e){t.newNationality=e},expression:"newNationality"}}),t._v(" "),n("b-form-datalist",{attrs:{id:"country-list",options:t.countries}}),t._v(" "),n("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:t.setNationality}},[n("font-awesome-icon",{attrs:{icon:"check"}})],1),t._v(" "),n("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:function(e){t.form=!1}}},[n("font-awesome-icon",{attrs:{icon:"times"}})],1)]:n("b-button",{attrs:{variant:"warning",size:"sm",title:"Set nationality",disabled:t.disabled},on:{click:function(e){t.form=!0}}},[n("font-awesome-icon",{attrs:{icon:"globe"}})],1)]:t._e()],2)}),[],!1,null,null,null).exports,U=Object(m.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"text-warning",attrs:{title:"Frequent visitor"}},[e("font-awesome-icon",{attrs:{icon:"star"}})],1)}),[],!1,null,null,null).exports,H={props:{url:{type:String,required:!0}}},L=Object(m.a)(H,(function(){var t=this.$createElement,e=this._self._c||t;return e("a",{attrs:{href:this.url,title:"Edit"}},[e("font-awesome-icon",{attrs:{icon:"edit"}})],1)}),[],!1,null,null,null).exports;function Y(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var A={components:{CodeScannerModal:h},props:{person:{required:!0},allowUpdate:Boolean,disabled:Boolean},data:function(){return{busy:!1,cardNo:this.person.card_no}},computed:{cardNoShort:function(){return null!=this.cardNo?this.cardNo.substr(0,7):null}},methods:{registerCard:function(){this.cardNo&&!confirm(this.$t("people.really_replace_card_with_new_one",{cardNo:this.cardNoShort}))||this.$refs.codeScanner.open()},validateCode:function(t){return Object(p.c)(t)},submitScannedCard:function(t){var e,n=this;return(e=i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.busy=!0,e.prev=1,e.next=4,O.a.updateCardNo(n.person.id,t);case 4:r=e.sent,n.cardNo=t,Object(p.g)(r.message),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(n.$t("app.error_err",{err:e.t0}));case 12:n.busy=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(t){Y(s,r,a,o,i,"next",t)}function i(t){Y(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},z=Object(m.a)(A,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[t.allowUpdate&&!t.disabled?[n("font-awesome-icon",{attrs:{icon:"id-card"}}),t._v(" "),t.busy?n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}}):n("a",{attrs:{href:"javascript:;"},on:{click:t.registerCard}},[t.cardNo?n("strong",[t._v(t._s(t.cardNoShort))]):[t._v(t._s(t.$t("app.register")))]],2)]:t.cardNo?[n("font-awesome-icon",{attrs:{icon:"id-card"}}),t._v(" "),n("strong",[t._v(t._s(t.cardNoShort))])]:t._e(),t._v(" "),n("code-scanner-modal",{ref:"codeScanner",attrs:{title:t.$t("people.qr_code_scanner"),validator:t.validateCode,"validator-message":t.$t("app.only_letters_and_numbers_allowed")},on:{decode:t.submitScannedCard}})],2)}),[],!1,null,null,null).exports,G={props:{value:{required:!0},placeholder:{type:String,required:!1,default:""},disabled:Boolean,busy:Boolean},data:function(){return{modelValue:this.value}},watch:{busy:function(t,e){var n=this;!t&&e&&this.$nextTick((function(){n.$refs.input.focus()}))}},mounted:function(){var t=this;this.$nextTick((function(){t.$refs.input.focus()}))},methods:{saveEdit:function(){this.$emit("submit",this.modelValue)},cancelEdit:function(){this.modelValue=this.value,this.$emit("cancel")},focus:function(){this.$refs.input.focus()}}},Q=Object(m.a)(G,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.modelValue,expression:"modelValue"}],ref:"input",staticClass:"form-control form-control-sm",attrs:{type:"text",placeholder:t.placeholder,disabled:t.disabled||t.busy},domProps:{value:t.modelValue},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveEdit(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancelEdit(e)}],input:function(e){e.target.composing||(t.modelValue=e.target.value)}}}),t._v(" "),n("div",{staticClass:"input-group-append"},[t.busy?n("span",{staticClass:"input-group-text"},[n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}})],1):[n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button",disabled:t.disabled||t.busy},on:{click:t.saveEdit}},[n("font-awesome-icon",{attrs:{icon:"check"}})],1),t._v(" "),n("button",{staticClass:"btn btn-secondary btn-sm",attrs:{type:"button",disabled:t.disabled||t.busy},on:{click:t.cancelEdit}},[n("font-awesome-icon",{attrs:{icon:"times"}})],1)]],2)])}),[],!1,null,null,null).exports;function W(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var J={components:{InlineValueEditor:Q,TextHighlight:k.a},props:{person:{required:!0},allowUpdate:Boolean,highlightTerms:{type:Array,required:!1,default:function(){return[]}},disabled:Boolean},data:function(){return{form:!1,busy:!1,police_no:null!=this.person.police_no_formatted&&this.person.police_no_formatted.length>0?this.person.police_no_formatted:null,editValue:""}},methods:{startEdit:function(){this.form=!0,this.editValue=this.police_no},cancelEdit:function(){this.form=!1},saveEdit:function(t){var e,n=this;return(e=i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&0!=t.length){e.next=3;break}return n.$refs.input.focus(),e.abrupt("return");case 3:return n.busy=!0,n.editValue=t,e.prev=5,e.next=8,O.a.updatePoliceNo(n.person.id,t);case 8:r=e.sent,n.police_no=r.police_no,n.form=!1,Object($.a)(r.message),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),alert(n.$t("app.error_err",{err:e.t0}));case 17:n.busy=!1;case 18:case"end":return e.stop()}}),e,null,[[5,14]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(t){W(s,r,a,o,i,"next",t)}function i(t){W(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},K=(n("lf1L"),Object(m.a)(J,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.police_no||t.allowUpdate?n("div",[t.form?n("inline-value-editor",{ref:"input",attrs:{value:t.editValue,placeholder:t.$t("people.police_number"),disabled:t.disabled,busy:t.busy},on:{submit:t.saveEdit,cancel:t.cancelEdit}}):[n("font-awesome-icon",{attrs:{icon:"hashtag"}}),t._v(" "),t.police_no?[n("small",{staticClass:"text-muted"},[t._v(t._s(t.$t("people.police_number"))+":")]),t._v(" "),n("span",{staticClass:"pr-2"},[n("text-highlight",{attrs:{queries:t.highlightTerms}},[t._v(t._s(t.police_no))])],1)]:t.allowUpdate?n("em",{staticClass:"text-muted clickable",on:{click:t.startEdit}},[t._v("\n            "+t._s(t.$t("people.click_to_add_police_number"))+"\n        ")]):t._e()]],2):t._e()}),[],!1,null,"1debff10",null).exports);function X(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var Z={components:{InlineValueEditor:Q},props:{person:{required:!0},allowUpdate:Boolean,disabled:Boolean},data:function(){return{busy:!1,form:!1,remarks:null!=this.person.remarks&&this.person.remarks.length>0?this.person.remarks:null,editValue:""}},methods:{startEdit:function(){this.form=!0,this.editValue=this.remarks},cancelEdit:function(){this.form=!1},saveEdit:function(t){var e,n=this;return(e=i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.busy=!0,n.editValue=t,e.prev=2,e.next=5,O.a.updateRemarks(n.person.id,t);case 5:r=e.sent,n.remarks=r.remarks,n.form=!1,Object($.a)(r.message),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),alert(n.$t("app.error_err",{err:e.t0}));case 14:n.busy=!1;case 15:case"end":return e.stop()}}),e,null,[[2,11]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(t){X(s,r,a,o,i,"next",t)}function i(t){X(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},tt=(n("YwO6"),Object(m.a)(Z,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.remarks||t.allowUpdate?n("div",[t.form?n("inline-value-editor",{attrs:{value:t.editValue,placeholder:t.$t("people.remarks"),disabled:t.disabled,busy:t.busy},on:{submit:t.saveEdit,cancel:t.cancelEdit}}):[n("font-awesome-icon",{attrs:{icon:"comment-dots"}}),t._v(" "),t.allowUpdate?[t.remarks?n("span",{staticClass:"text-info clickable",on:{click:t.startEdit}},[t._v("\n                "+t._s(t.remarks)+"\n            ")]):n("em",{staticClass:"text-muted clickable",on:{click:t.startEdit}},[t._v("\n                "+t._s(t.$t("people.click_to_add_remarks"))+"\n            ")])]:t.remarks?n("span",{staticClass:"text-info"},[t._v("\n            "+t._s(t.remarks)+"\n        ")]):t._e()]],2):t._e()}),[],!1,null,"710ebcbc",null).exports),et={props:{url:{type:String,required:!1,default:null}}},nt=Object(m.a)(et,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("font-awesome-icon",{attrs:{icon:"book"}}),t._v(" "),n("em",{staticClass:"text-danger"},[t._v("\n        Needs to bring back book(s) to the\n        "),null!=t.url?n("a",{attrs:{href:t.url}},[t._v("\n            "+t._s(t.$t("library.library"))+"\n        ")]):[t._v("\n            "+t._s(t.$t("library.library"))+"\n        ")]],2)],1)}),[],!1,null,null,null).exports,rt=n("OJ8O");function at(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}function st(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){at(s,r,a,o,i,"next",t)}function i(t){at(s,r,a,o,i,"throw",t)}o(void 0)}))}}var ot={listTransactions:function(t){return st(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(rt.c)("api.bank.withdrawal.transactions",t),e.next=3,rt.a.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},fetchDailyStats:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.withdrawal.dailyStats"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},searchPersons:function(t,e){return st(i.a.mark((function n(){var r,a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={filter:t,page:e},a=Object(rt.c)("api.bank.withdrawal.search",r),n.next=4,rt.a.get(a);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})))()},findPerson:function(t){return st(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(rt.c)("api.bank.withdrawal.person",t),e.next=3,rt.a.get(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()},handoutCoupon:function(t,e,n){return st(i.a.mark((function r(){var a;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=Object(rt.c)("api.bank.withdrawal.handoutCoupon",[t,e]),r.next=3,rt.a.post(a,n);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()},undoHandoutCoupon:function(t,e){return st(i.a.mark((function n(){var r;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Object(rt.c)("api.bank.withdrawal.handoutCoupon",[t,e]),n.next=3,rt.a.delete(r);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},fetchVisitorReportData:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.reporting.visitors"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},fetchWithdrawalReportData:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.reporting.withdrawals"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},fetchAvgVisitorsPerDayOfWeek:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.reporting.avgVisitorsPerDayOfWeek"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},fetchVisitorsPerDay:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.reporting.visitorsPerDay"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},fetchVisitorsPerWeek:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.reporting.visitorsPerWeek"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},fetchVisitorsPerMonth:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.reporting.visitorsPerMonth"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},fetchVisitorsPerYear:function(){return st(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(rt.c)("api.bank.reporting.visitorsPerYear"),t.next=3,rt.a.get(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},fetchCouponsHandedOutPerDay:function(t,e,n){return st(i.a.mark((function r(){var a;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a="".concat(Object(rt.c)("api.bank.reporting.couponsHandedOutPerDay",t),"?from=").concat(e,"&to=").concat(n),r.next=3,rt.a.get(a);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))()}};function it(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}function lt(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){it(s,r,a,o,i,"next",t)}function i(t){it(s,r,a,o,i,"throw",t)}o(void 0)}))}}function ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ut(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var pt={components:{CodeScannerModal:h},props:{personId:{required:!0},coupon:{type:Object,required:!0,validator:function(t){return"qr_code_enabled"in t&&"daily_amount"in t&&"last_handout"in t&&"returning_possible"in t&&"icon"in t&&"name"in t}},disabled:Boolean},data:function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(n),!0).forEach((function(e){ut(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({busy:!1,scannedCode:null},this.coupon)},methods:{validateCode:function(t){return Object(p.c)(t)},submitScannedCode:function(t){var e=this;return lt(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.sendHandoutRequest({amount:e.daily_amount,code:t});case 1:case"end":return n.stop()}}),n)})))()},handoutCoupon:function(){var t=this;return lt(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.qr_code_enabled?t.$refs.codeScanner.open():t.sendHandoutRequest({amount:t.daily_amount});case 1:case"end":return e.stop()}}),e)})))()},sendHandoutRequest:function(t){var e=this;return lt(i.a.mark((function n(){var r;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.busy=!0,n.prev=1,n.next=4,ot.handoutCoupon(e.personId,e.coupon.id,t);case 4:r=n.sent,e.last_handout=r.countdown,e.returning_possible=!0,setTimeout(e.disableCouponReturn,1e3*r.return_grace_period),Object(p.g)(r.message,e.$t("app.undo"),"warning",(function(t){t.style.opacity=0,e.undoHandoutCoupon()})),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),alert(n.t0);case 14:e.busy=!1;case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))()},disableCouponReturn:function(){this.last_handout&&(this.returning_possible=!1)},undoHandoutCoupon:function(){var t=this;return lt(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.busy=!0,e.prev=1,e.next=4,ot.undoHandoutCoupon(t.personId,t.coupon.id);case 4:n=e.sent,t.last_handout=null,Object(p.g)(n.message),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(e.t0);case 12:t.busy=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}},dt=Object(m.a)(pt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.last_handout?n("button",{staticClass:"btn btn-secondary btn-sm btn-block",attrs:{type:"button",disabled:t.busy||!t.returning_possible||t.disabled},on:{click:t.undoHandoutCoupon}},[t._v("\n    "+t._s(t.daily_amount)+"\n    "),n("font-awesome-icon",{attrs:{icon:t.icon}}),t._v("\n    "+t._s(t.name)+"\n    ("+t._s(t.last_handout)+")\n")],1):n("button",{staticClass:"btn btn-primary btn-sm btn-block",attrs:{type:"button",disabled:t.busy||t.disabled},on:{click:t.handoutCoupon}},[t._v("\n    "+t._s(t.daily_amount)+"\n    "),n("font-awesome-icon",{attrs:{icon:t.icon}}),t._v("\n    "+t._s(t.name)+"\n    "),t.qr_code_enabled?n("font-awesome-icon",{attrs:{icon:"qrcode"}}):t._e(),t._v(" "),t.qr_code_enabled?n("code-scanner-modal",{ref:"codeScanner",attrs:{title:t.$t("people.qr_code_scanner"),validator:t.validateCode,"validator-message":t.$t("app.only_letters_and_numbers_allowed")},on:{decode:t.submitScannedCode}}):t._e()],1)}),[],!1,null,null,null).exports,ft={props:{person:{type:Object,required:!0},disabled:Boolean,highlightTerms:{type:Array,required:!1,default:function(){return[]}}},components:{CommunityVolunteerMarker:w,NameLabel:C,GenderSelector:j,DateOfBirthSelector:q,NationalitySelector:F,FrequentVisitorMarker:U,EditLink:L,CardNumberLabel:z,PoliceNoLabel:K,RemarksLabel:tt,OverdueBookLendingsLabel:nt,CouponHandoutButton:dt},computed:{headerStyle:function(){return this.person.frequent_visitor?"background: lightgoldenrodyellow;":null}}},vt=Object(m.a)(ft,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card mb-4 bg-light"},[n("div",{staticClass:"card-header p-2",style:t.headerStyle},[n("div",{staticClass:"form-row"},[n("div",{staticClass:"col"},[t.person.is_community_volunteer?n("community-volunteer-marker",{attrs:{url:t.person.can_view_community_volunteer?t.person.show_community_volunteer_url:null}}):t._e(),t._v(" "),n("name-label",{attrs:{url:t.person.can_view?t.person.show_url:null,value:t.person.full_name,"highlight-terms":t.highlightTerms}}),t._v(" "),n("gender-selector",{attrs:{person:t.person,"allow-update":t.person.can_update,disabled:t.disabled}}),t._v(" "),n("date-of-birth-selector",{attrs:{person:t.person,"allow-update":t.person.can_update,disabled:t.disabled},on:{changed:function(e){return t.$emit("change")}}}),t._v(" "),n("nationality-selector",{attrs:{person:t.person,"allow-update":t.person.can_update,disabled:t.disabled}}),t._v(" "),t.person.frequent_visitor?n("frequent-visitor-marker"):t._e(),t._v(" "),t.person.can_update?n("edit-link",{attrs:{url:t.person.edit_url}}):t._e()],1),t._v(" "),n("div",{staticClass:"col-auto"},[n("card-number-label",{attrs:{person:t.person,"allow-update":t.person.can_update,disabled:t.disabled}})],1)])]),t._v(" "),n("div",{staticClass:"card-body p-2"},[n("police-no-label",{attrs:{person:t.person,"highlight-terms":t.highlightTerms,"allow-update":t.person.can_update}}),t._v(" "),n("remarks-label",{attrs:{person:t.person,"allow-update":t.person.can_update}}),t._v(" "),t.person.has_overdue_book_lendings?n("overdue-book-lendings-label",{attrs:{url:t.person.can_operate_library?t.person.library_lending_person_url:null}}):t._e()],1),t._v(" "),n("div",{staticClass:"card-body p-0 px-2 pt-2"},[t.person.coupon_types.length>0?n("div",{staticClass:"form-row"},t._l(t.person.coupon_types,(function(e){return n("div",{key:e.id,staticClass:"col-sm-auto mb-2"},[n("coupon-handout-button",{attrs:{"person-id":t.person.id,coupon:e,disabled:t.disabled}})],1)})),0):n("div",{staticClass:"pb-2 px-2"},[n("em",[t._v(t._s(t.$t("people.no_coupons_defined")))])])])])}),[],!1,null,null,null).exports,_t={props:{url:{required:!0,type:String}}},mt=Object(m.a)(_t,(function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("a",{staticClass:"btn btn-primary",attrs:{href:this.url}},[e("font-awesome-icon",{attrs:{icon:"plus-circle"}}),this._v("\n        "+this._s(this.$t("people.register_a_new_person"))+"\n    ")],1)])}),[],!1,null,null,null).exports;function ht(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var bt={props:{reloadInterval:{type:Number,required:!1,default:60,validator:function(t){return t>0}}},data:function(){return{stats:{},loaded:!1,interval:null}},mounted:function(){this.loadStats(),this.interval=setInterval(this.loadStats,1e3*this.reloadInterval)},beforeDestroy:function(){null!=this.interval&&clearInterval(this.interval)},methods:{loadStats:function(){var t,e=this;return(t=i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ot.fetchDailyStats();case 3:n=t.sent,e.stats=n,e.loaded=!0,t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){ht(s,r,a,o,i,"next",t)}function i(t){ht(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},yt=Object(m.a)(bt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loaded?n("div",{staticClass:"text-center lead my-5",attrs:{id:"stats"}},[t.stats.number_of_persons_served?n("p",{domProps:{innerHTML:t._s(t.$t("people.num_persons_served_handing_out_coupons",{persons:t.stats.number_of_persons_served,coupons:t.stats.number_of_coupons_handed_out}))}}):[t._v("\n        "+t._s(t.$t("people.not_yet_served_any_persons"))+"\n    ")],t._v(" "),t.stats.limited_coupons?t._l(t.stats.limited_coupons,(function(e,r){return n("p",{key:r,domProps:{innerHTML:t._s(t.$t("coupons.coupons_handed_out_n_t",{coupon:e.coupon,count:e.count,limit:e.limit}))}})})):t._e()],2):t._e()}),[],!1,null,null,null).exports,gt=n("TRA/"),wt=n("JtJI");function kt(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}function xt(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){kt(s,r,a,o,i,"next",t)}function i(t){kt(s,r,a,o,i,"throw",t)}o(void 0)}))}}var Ct=new c("bank.withdrawal.filter"),$t={components:{PersonFilterInput:y,BankPersonCard:vt,RegisterPersonButton:mt,BankStats:yt,InfoAlert:gt.a,BPagination:wt.a},props:{canRegisterPerson:Boolean,registerPersonUrl:{type:String,required:!1,default:null}},data:function(){return{persons:[],loaded:!1,totalRows:0,registerQuery:"",perPage:0,currentPage:1,filter:Ct.get(""),busy:!1,message:null,searchTerms:[],disabledCards:[],disableSearch:!1}},computed:{registerPersonUrlWithQuery:function(){var t=this.registerPersonUrl;return this.registerQuery.length>0&&(t+="?".concat(this.registerQuery)),t}},watch:{currentPage:function(){this.search(this.filter)}},mounted:function(){this.filter.length>0&&this.search(this.filter)},methods:{search:function(t){var e=this;return xt(i.a.mark((function n(){var r;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.busy=!0,e.message=null,e.searchTerms=[],Ct.forget(),e.filter!=t&&(e.currentPage=1),n.prev=5,n.next=8,ot.searchPersons(t,e.currentPage);case 8:r=n.sent,e.persons=r.data,e.totalRows=r.meta.total,e.perPage=r.meta.per_page,e.registerQuery=r.meta.register_query,e.loaded=!0,e.filter=t,e.persons.length>0&&Ct.set(t),r.meta.terms.length>0&&(e.searchTerms=r.meta.terms),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(5),alert(n.t0);case 22:e.busy=!1,0==e.totalRows&&u.$emit("zero-results");case 24:case"end":return n.stop()}}),n,null,[[5,19]])})))()},reloadPerson:function(t){var e=this;return xt(i.a.mark((function n(){var r,a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.id){n.next=15;break}return e.disableSearch=!0,e.disabledCards.push(t.id),n.prev=3,n.next=6,ot.findPerson(t.id);case 6:(r=n.sent).data&&(a=e.persons.findIndex((function(e){return e.id==t.id})),e.persons[a]=r.data),e.disabledCards.splice(e.disabledCards.indexOf(t.id)),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),alert(n.t0);case 14:e.disableSearch=!1;case 15:case"end":return n.stop()}}),n,null,[[3,11]])})))()},reset:function(){this.persons=[],this.totalRows=0,this.loaded=!1,this.message=null,Ct.forget(),this.filter=""}}},Ot=Object(m.a)($t,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("person-filter-input",{attrs:{value:t.filter,busy:t.busy,disabled:t.disableSearch,placeholder:t.$t("people.bank_search_text")},on:{submit:t.search,reset:t.reset}}),t._v(" "),t.loaded?n("div",{staticClass:"mt-3"},[t.totalRows>0?[t._l(t.persons,(function(e){return n("bank-person-card",{key:e.id,attrs:{person:e,"highlight-terms":t.searchTerms,disabled:t.disabledCards.indexOf(e.id)>=0},on:{change:function(n){return t.reloadPerson(e)}}})})),t._v(" "),n("div",{staticClass:"row align-items-center"},[n("div",{staticClass:"col"},[t.totalRows>0&&t.perPage>0&&t.totalRows>t.perPage?n("b-pagination",{staticClass:"mb-0",attrs:{size:"sm","total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1),t._v(" "),n("div",{staticClass:"col-auto"},[n("small",[t._v(t._s(t.totalRows)+" total results")])])])]:[t.message?n("info-alert",{attrs:{message:t.message}}):n("info-alert",{attrs:{message:t.$t("app.not_found")}}),t._v(" "),null!=t.canRegisterPerson?n("register-person-button",{attrs:{url:t.registerPersonUrlWithQuery}}):t._e()]],2):0==t.filter.length?n("bank-stats"):t._e()],1)}),[],!1,null,null,null).exports,Pt=n("X9p1"),Bt=n("KaE5"),jt=n("oVt+"),Et=n("sove"),St={props:{person:{type:Object,required:!0}}},qt=Object(m.a)(St,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",["f"==t.person.gender?n("font-awesome-icon",{attrs:{icon:"female"}}):t._e(),t._v(" "),"m"==t.person.gender?n("font-awesome-icon",{attrs:{icon:"male"}}):t._e(),t._v(" "),t.person.url?n("a",{attrs:{href:t.person.url,target:"_blank"}},[t._v(t._s(t.person.name))]):[t._v("\n        "+t._s(t.person.name)+"\n    ")],t._v(" "),t.person.date_of_birth?[t._v("\n        "+t._s(t.person.date_of_birth)+"\n        ("+t._s(t.person.age)+")\n    ")]:t._e(),t._v(" "),t.person.nationality?[n("font-awesome-icon",{attrs:{icon:"globe"}}),t._v("\n        "+t._s(t.person.nationality)+"\n    ")]:t._e()],2)}),[],!1,null,null,null).exports;function Dt(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var Nt={components:{BAlert:Pt.a,BTable:Bt.a,BPagination:wt.a,BButton:D.a,BRow:jt.a,BCol:Et.a,BFormInput:N.a,PersonLabel:qt},data:function(){return{fields:[{key:"created_at",label:this.$t("app.registered")},{key:"date",label:this.$t("app.date")},{key:"person",label:this.$t("people.recipient")},{key:"coupon",label:this.$t("app.amount")}],totalRows:0,perPage:100,currentPage:1,isBusy:!1,initialized:!1,filter:"",apiError:null}},methods:{refresh:function(){this.$refs.table.refresh()},itemProvider:function(t){var e,n=this;return(e=i.a.mark((function e(){var r,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.isBusy=!0,r={page:t.currentPage,perPage:t.perPage,filter:t.filter},n.apiError=null,e.prev=3,e.next=6,ot.listTransactions(r);case 6:return a=e.sent,s=a.data,n.totalRows=a.meta&&a.meta?a.meta.total:0,n.isBusy=!1,n.initialized=!0,e.abrupt("return",s||[]);case 14:return e.prev=14,e.t0=e.catch(3),n.apiError=e.t0,n.isBusy=!1,e.abrupt("return",[]);case 19:case"end":return e.stop()}}),e,null,[[3,14]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(t){Dt(s,r,a,o,i,"next",t)}function i(t){Dt(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},Vt=Object(m.a)(Nt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-alert",{attrs:{variant:"danger",show:null!=t.apiError}},[t._v("\n        "+t._s(t.apiError)+"\n    ")]),t._v(" "),n("b-form-input",{staticClass:"mb-3",attrs:{type:"search",debounce:"500",placeholder:t.$t("app.filter"),autocomplete:"off",size:"sm"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),n("b-table",{ref:"table",attrs:{striped:"",small:"",hover:"",responsive:"",bordered:"","primary-key":"id",busy:t.isBusy,items:t.itemProvider,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage,"show-empty":t.initialized,"empty-text":t.$t("people.no_transactions_so_far"),"empty-filtered-text":t.$t("app.no_records_matching_your_request"),filter:t.filter},on:{"update:busy":function(e){t.isBusy=e}},scopedSlots:t._u([t.initialized?null:{key:"table-busy",fn:function(){return[n("div",{staticClass:"text-center my-2"},[n("font-awesome-icon",{attrs:{icon:"spinner",spin:""}}),t._v("\n                "+t._s(t.$t("app.loading"))+"\n            ")],1)]},proxy:!0},{key:"cell(created_at)",fn:function(e){return[n("span",{attrs:{title:e.value}},[t._v("\n                "+t._s(e.item.created_at_diff)+"\n            ")]),t._v(" "),e.item.user?n("small",{staticClass:"text-muted"},[n("font-awesome-icon",{attrs:{icon:"user"}}),t._v("\n                "+t._s(e.item.user)+"\n            ")],1):t._e()]}},{key:"cell(date)",fn:function(e){return[e.value?[t._v("\n                "+t._s(e.value)+"\n            ")]:n("em",[t._v("\n                "+t._s(t.$t("app.not_found"))+"\n            ")])]}},{key:"cell(person)",fn:function(e){return[e.value?n("person-label",{attrs:{person:e.value}}):n("em",[t._v("\n                "+t._s(t.$t("app.not_found"))+"\n            ")])]}},{key:"cell(coupon)",fn:function(e){return[e.value?[t._v("\n                "+t._s(e.value.amount_diff)+"\n                "+t._s(e.value.name)+"\n            ")]:n("em",[t._v("\n                "+t._s(t.$t("app.not_found"))+"\n            ")])]}}],null,!0)}),t._v(" "),n("b-row",[n("b-col",[t.totalRows>0&&t.perPage>0?n("b-pagination",{attrs:{size:"sm","total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1),t._v(" "),n("b-col",{attrs:{cols:"auto"}},[t.initialized?n("b-button",{attrs:{variant:"primary",size:"sm",disabled:t.isBusy},on:{click:t.refresh}},[n("font-awesome-icon",{attrs:{icon:"sync",spin:t.isBusy}})],1):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,It=n("rTcV");function Tt(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var Rt={components:{BarChart:It.a},data:function(){return{visitors:null,api:ot}},mounted:function(){this.loadData()},methods:{loadData:function(){var t,e=this;return(t=i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ot.fetchVisitorReportData();case 2:e.visitors=t.sent;case 3:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){Tt(s,r,a,o,i,"next",t)}function i(t){Tt(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},Mt=Object(m.a)(Rt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"row mb-0 mb-sm-2"},[n("div",{staticClass:"col-xl-6"},[t.visitors?t._l(t.visitors,(function(e,r){return n("div",{key:r,staticClass:"row mb-4 align-items-center"},[t._l(e,(function(e,r){return n("div",{key:r,staticClass:"col"},[n("div",{staticClass:"row align-items-center"},[n("div",{staticClass:"col text-secondary"},[t._v(t._s(r)+":")]),t._v(" "),n("div",{staticClass:"col display-4"},[t._v(t._s(e))])])])})),t._v(" "),n("div",{staticClass:"w-100 d-block d-sm-none"})],2)})):n("p",[t._v("\n                "+t._s(t.$t("app.loading"))+"\n            ")]),t._v(" "),n("bar-chart",{attrs:{title:"Average visitors per day of week","x-label":t.$t("app.weekday"),"y-label":t.$t("app.quantity"),data:t.api.fetchAvgVisitorsPerDayOfWeek,height:270}})],2),t._v(" "),n("div",{staticClass:"col-xl-6"},[n("bar-chart",{attrs:{title:"Visitors per day","x-label":t.$t("app.day"),"y-label":t.$t("app.quantity"),data:t.api.fetchVisitorsPerDay,height:270}}),t._v(" "),n("bar-chart",{attrs:{title:"Visitors per week","x-label":t.$t("app.week"),"y-label":t.$t("app.quantity"),data:t.api.fetchVisitorsPerWeek,height:270}}),t._v(" "),n("bar-chart",{attrs:{title:"Visitors per month","x-label":t.$t("app.month"),"y-label":t.$t("app.quantity"),data:t.api.fetchVisitorsPerMonth,height:270}}),t._v(" "),n("bar-chart",{attrs:{title:"Visitors per year","x-label":t.$t("app.year"),"y-label":t.$t("app.quantity"),data:t.api.fetchVisitorsPerYear,height:270}})],1)]),t._v(" "),t._m(0)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[e("small",[this._v("Visitor data is based on check-ins at the Bank.")])])])}],!1,null,null,null).exports,Ft=n("wd/R"),Ut=n.n(Ft);function Ht(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var Lt={components:{BarChart:It.a},data:function(){return{coupons:null,from:Ut()().subtract(1,"months").format(Ut.a.HTML5_FMT.DATE),to:Ut()().format(Ut.a.HTML5_FMT.DATE)}},mounted:function(){this.loadData()},methods:{loadData:function(){var t,e=this;return(t=i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ot.fetchWithdrawalReportData();case 2:n=t.sent,r=0;case 4:if(!(r<n.length)){t.next=11;break}return t.next=7,ot.fetchCouponsHandedOutPerDay(n[r].coupon.id,e.from,e.to);case 7:n[r].handedOutPerday=t.sent;case 8:r++,t.next=4;break;case 11:e.coupons=n;case 12:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){Ht(s,r,a,o,i,"next",t)}function i(t){Ht(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},Yt=Object(m.a)(Lt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.coupons?n("div",[n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-sm table-bordered table-striped table-hover mb-4"},[n("thead",[n("tr",[n("th"),t._v(" "),n("th",{staticClass:"text-right"},[t._v(t._s(t.$t("app.daily_average")))]),t._v(" "),n("th",{staticClass:"text-right"},[t._v(t._s(t.$t("app.highest")))]),t._v(" "),n("th",{staticClass:"text-right"},[t._v(t._s(t.$t("app.last_month")))]),t._v(" "),n("th",{staticClass:"text-right"},[t._v(t._s(t.$t("app.this_month")))]),t._v(" "),n("th",{staticClass:"text-right"},[t._v(t._s(t.$t("app.last_week")))]),t._v(" "),n("th",{staticClass:"text-right"},[t._v(t._s(t.$t("app.this_week")))]),t._v(" "),n("th",{staticClass:"text-right"},[t._v(t._s(t.$t("app.today")))])])]),t._v(" "),n("tbody",t._l(t.coupons,(function(e){return n("tr",{key:e.coupon.id},[n("td",[t._v(t._s(e.coupon.name))]),t._v(" "),n("td",{staticClass:"text-right"},[t._v(t._s(e.avg_sum))]),t._v(" "),n("td",{staticClass:"text-right"},[e.highest_sum?[t._v("\n                                "+t._s(e.highest_sum.sum)+"\n                                "),n("small",{staticClass:"text-muted"},[t._v(t._s(e.highest_sum.date))])]:t._e()],2),t._v(" "),n("td",{staticClass:"text-right"},[t._v(t._s(e.last_month_sum))]),t._v(" "),n("td",{staticClass:"text-right"},[t._v(t._s(e.this_month_sum))]),t._v(" "),n("td",{staticClass:"text-right"},[t._v(t._s(e.last_week_sum))]),t._v(" "),n("td",{staticClass:"text-right"},[t._v(t._s(e.this_week_sum))]),t._v(" "),n("td",{staticClass:"text-right"},[t._v(t._s(e.today_sum))])])})),0)])]),t._v(" "),n("div",{staticClass:"mb-3"},t._l(t.coupons,(function(e){return n("bar-chart",{key:e.coupon.id,staticClass:"mb-2",attrs:{title:t.$t("people.num_x_handed_out_per_day",{name:e.coupon.name}),"x-label":t.$t("app.date"),"y-label":t.$t("app.quantity"),data:e.handedOutPerday,height:300}})})),1)]):n("p",[t._v("\n    "+t._s(t.$t("app.loading"))+"\n")])}),[],!1,null,null,null).exports,At=n("Ed67"),zt=n("giZP"),Gt=n("VCnd"),Qt=n("XhI9"),Wt={components:{BFormGroup:zt.a,BInputGroup:Qt.a,BFormInput:N.a},props:{value:{type:String}},computed:{date_of_birth:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},ageString:function(){var t=this.date_of_birth;if(t&&Object(p.d)(t)){var e=Object(p.b)(t);if(!isNaN(e)&&e>=0)return this.$t("people.age_n",{age:e})}return null}}},Jt=Object(m.a)(Wt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-form-group",{attrs:{label:t.$t("people.date_of_birth")}},[n("b-input-group",{attrs:{append:t.ageString}},[n("b-form-input",{attrs:{pattern:"[0-9]{4}-[0-9]{2}-[0-9]{2}",placeholder:"YYYY-MM-DD",autocomplete:"off"},model:{value:t.date_of_birth,callback:function(e){t.date_of_birth=e},expression:"date_of_birth"}})],1)],1)}),[],!1,null,null,null).exports,Kt={components:{BFormGroup:zt.a,BFormInput:N.a,BFormDatalist:V.a},props:{value:{type:String},countries:{type:Array,required:!0}},computed:{nationality:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},Xt=Object(m.a)(Kt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("b-form-group",{attrs:{label:t.$t("people.nationality")}},[n("b-form-input",{attrs:{list:"country-list"},model:{value:t.nationality,callback:function(e){t.nationality=e},expression:"nationality"}})],1),t._v(" "),n("b-form-datalist",{attrs:{id:"country-list",options:t.countries}})],1)}),[],!1,null,null,null).exports,Zt={components:{BFormGroup:zt.a,BInputGroup:Qt.a,BFormInput:N.a},props:{value:{type:[Number,String],default:""}},computed:{police_no:{get:function(){return"number"==typeof this.value?this.value.toString():this.value},set:function(t){this.$emit("input",t)}},policeNoPrefix:function(){var t="05/",e=(null!=this.police_no?this.police_no:"").length;return t+="000000000".substr(e)}}},te=Object(m.a)(Zt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-form-group",{attrs:{label:t.$t("people.police_number"),description:t.$t("people.leading_zeros_added_automatically")}},[n("b-input-group",{attrs:{prepend:t.policeNoPrefix}},[n("b-form-input",{attrs:{type:"number","no-wheel":"",autocomplete:"off"},model:{value:t.police_no,callback:function(e){t.police_no=e},expression:"police_no"}})],1)],1)}),[],!1,null,null,null).exports,ee={components:{BButton:D.a,CodeScannerModal:h},props:{value:{type:String}},computed:{card_no:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{validateCode:function(t){return Object(p.c)(t)},assignCard:function(t){this.card_no=t}}},ne=Object(m.a)(ee,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"mb-2"},[t._v(t._s(t.$t("people.code_card")))]),t._v(" "),n("b-button",{attrs:{variant:t.card_no?"secondary":"primary"},on:{click:function(e){return t.$refs.codeScanner.open()}}},[n("font-awesome-icon",{attrs:{icon:"qrcode"}})],1),t._v(" "),null!=t.card_no&&t.card_no.length>0?[t._v("\n        "+t._s(t.card_no)+"\n        "),n("b-button",{attrs:{variant:"warning"},on:{click:function(e){t.card_no=""}}},[n("font-awesome-icon",{attrs:{icon:"trash"}})],1)]:n("span",{staticClass:"text-muted"},[t._v("\n        "+t._s(t.$t("app.no_cards_registered"))+"\n    ")]),t._v(" "),n("code-scanner-modal",{ref:"codeScanner",attrs:{title:t.$t("people.qr_code_scanner"),validator:t.validateCode,"validator-message":t.$t("app.only_letters_and_numbers_allowed")},on:{decode:t.assignCard}})],2)}),[],!1,null,null,null).exports,re={components:{BFormInput:N.a,BFormGroup:zt.a,GenderRadioInput:Gt.a,DateOfBirthInput:Jt,NationalityInput:Xt,PoliceNumberInput:te,CodeCardInput:ne},props:{value:{type:Object,required:!0},countries:{type:Array,required:!0},autofocus:Boolean},data:function(){return{person:JSON.parse(JSON.stringify(this.value))}},watch:{person:{handler:function(t){this.$emit("input",this.person)},deep:!0}},methods:{focus:function(){this.$refs.name.focus()}}},ae=Object(m.a)(re,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"form-row"},[n("div",{staticClass:"col-md"},[n("b-form-group",{attrs:{label:t.$t("people.name")}},[n("b-form-input",{ref:"name",attrs:{required:"",autofocus:t.autofocus,autocomplete:"off"},model:{value:t.person.name,callback:function(e){t.$set(t.person,"name",e)},expression:"person.name"}})],1)],1),t._v(" "),n("div",{staticClass:"col-md"},[n("b-form-group",{attrs:{label:t.$t("people.family_name")}},[n("b-form-input",{attrs:{required:"",autocomplete:"off"},model:{value:t.person.family_name,callback:function(e){t.$set(t.person,"family_name",e)},expression:"person.family_name"}})],1)],1)]),t._v(" "),n("div",{staticClass:"form-row"},[n("div",{staticClass:"col-md-3"},[n("gender-radio-input",{model:{value:t.person.gender,callback:function(e){t.$set(t.person,"gender",e)},expression:"person.gender"}})],1),t._v(" "),n("div",{staticClass:"col-md-3"},[n("date-of-birth-input",{model:{value:t.person.date_of_birth,callback:function(e){t.$set(t.person,"date_of_birth",e)},expression:"person.date_of_birth"}})],1),t._v(" "),n("div",{staticClass:"col-md-6"},[n("nationality-input",{attrs:{countries:t.countries},model:{value:t.person.nationality,callback:function(e){t.$set(t.person,"nationality",e)},expression:"person.nationality"}})],1)]),t._v(" "),n("div",{staticClass:"form-row"},[n("div",{staticClass:"col-md"},[n("police-number-input",{model:{value:t.person.police_no,callback:function(e){t.$set(t.person,"police_no",e)},expression:"person.police_no"}})],1),t._v(" "),n("div",{staticClass:"col-md"},[n("code-card-input",{model:{value:t.person.card_no,callback:function(e){t.$set(t.person,"card_no",e)},expression:"person.card_no"}})],1)]),t._v(" "),n("div",{staticClass:"form-row"},[n("div",{staticClass:"col-md"},[n("b-form-group",{attrs:{label:t.$t("people.remarks")}},[n("b-form-input",{attrs:{autocomplete:"off"},model:{value:t.person.remarks,callback:function(e){t.$set(t.person,"remarks",e)},expression:"person.remarks"}})],1)],1)])])}),[],!1,null,null,null).exports;function se(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var oe=new c("bank.withdrawal.filter"),ie={components:{BForm:At.a,BButton:D.a,PersonFormFields:ae},props:{redirectUrl:{required:!0,type:String},countries:{type:Array,required:!0},name:{type:String,required:!1,default:""},familyName:{type:String,required:!1,default:""},policeNo:{type:String,required:!1,default:""}},data:function(){return{person:{name:this.name,family_name:this.familyName,gender:"",date_of_birth:"",police_no:this.policeNo,nationality:"",remarks:"",card_no:""},busy:!1}},methods:{onSubmit:function(){var t,e=this;return(t=i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.busy=!0,t.prev=1,t.next=4,O.a.store(e.person);case 4:n=t.sent,Object($.a)(n.message),r=e.person.police_no?e.person.police_no:"".concat(e.person.name," ").concat(e.person.family_name),oe.set(r),e.$bvModal.msgBoxConfirm("Do you want to add another family nember?",{title:"Add family member",okTitle:"Yes",cancelTitle:"No",centered:!0}).then((function(t){t?(e.person.name="",e.person.gender="",e.person.date_of_birth="",e.person.remarks="",e.person.card_no="",e.$refs.formfields.focus()):window.location.href=e.redirectUrl})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),alert(e.$t("app.error_err",{err:t.t0}));case 14:e.busy=!1;case 15:case"end":return t.stop()}}),t,null,[[1,11]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){se(s,r,a,o,i,"next",t)}function i(t){se(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},le=Object(m.a)(ie,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.onSubmit(e)}}},[n("person-form-fields",{ref:"formfields",attrs:{countries:t.countries,autofocus:""},model:{value:t.person,callback:function(e){t.person=e},expression:"person"}}),t._v(" "),n("p",[n("b-button",{attrs:{variant:"primary",type:"submit",disabled:t.busy}},[n("font-awesome-icon",{attrs:{icon:"check"}}),t._v("\n                "+t._s(t.$t("app.register"))+"\n            ")],1)],1)],1)],1)}),[],!1,null,null,null).exports;function ce(t,e,n,r,a,s,o){try{var i=t[s](o),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,a)}var ue=new c("bank.withdrawal.filter"),pe={components:{BForm:At.a,BButton:D.a,PersonFormFields:ae},props:{redirectUrl:{required:!0,type:String},countries:{type:Array,required:!0},value:{type:Object,required:!0}},data:function(){return{person:JSON.parse(JSON.stringify(this.value)),busy:!1}},methods:{onSubmit:function(){var t,e=this;return(t=i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.busy=!0,t.prev=1,t.next=4,O.a.update(e.person.public_id,e.person);case 4:n=t.sent,Object($.a)(n.message),r=e.person.police_no?e.person.police_no:"".concat(e.person.name," ").concat(e.person.family_name),ue.set(r),window.location.href=e.redirectUrl,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),alert(e.$t("app.error_err",{err:t.t0}));case 14:e.busy=!1;case 15:case"end":return t.stop()}}),t,null,[[1,11]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(t){ce(s,r,a,o,i,"next",t)}function i(t){ce(s,r,a,o,i,"throw",t)}o(void 0)}))})()}}},de=Object(m.a)(pe,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.onSubmit(e)}}},[n("person-form-fields",{attrs:{countries:t.countries},model:{value:t.person,callback:function(e){t.person=e},expression:"person"}}),t._v(" "),n("p",[n("b-button",{attrs:{variant:"primary",type:"submit",disabled:t.busy}},[n("font-awesome-icon",{attrs:{icon:"check"}}),t._v("\n                "+t._s(t.$t("app.update"))+"\n            ")],1)],1)],1)],1)}),[],!1,null,null,null).exports,fe=n("DSCO"),ve=n("gZRc"),_e={components:{TwoColListGroupItem:fe.a,GenderLabel:ve.a},props:{person:{type:Object,required:!0}}},me=Object(m.a)(_e,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"list-group list-group-flush"},[n("two-col-list-group-item",{attrs:{title:t.$t("people.name")}},[t._v("\n        "+t._s(t.person.name)+"\n    ")]),t._v(" "),n("two-col-list-group-item",{attrs:{title:t.$t("people.family_name")}},[t._v("\n        "+t._s(t.person.family_name)+"\n    ")]),t._v(" "),t.person.gender?n("two-col-list-group-item",{attrs:{title:t.$t("people.gender")}},[n("gender-label",{attrs:{value:t.person.gender}})],1):t._e(),t._v(" "),t.person.date_of_birth?n("two-col-list-group-item",{attrs:{title:t.$t("people.date_of_birth")}},[t._v("\n        "+t._s(t.person.date_of_birth)+"\n    ")]):t._e(),t._v(" "),t.person.age?n("two-col-list-group-item",{attrs:{title:t.$t("people.age")}},[t._v("\n        "+t._s(t.$t("people.age_n",{age:t.person.age}))+"\n    ")]):t._e(),t._v(" "),t.person.police_no?n("two-col-list-group-item",{attrs:{title:t.$t("people.police_number")}},[t._v("\n        "+t._s(t.person.police_no_formatted)+"\n    ")]):t._e(),t._v(" "),t.person.nationality?n("two-col-list-group-item",{attrs:{title:t.$t("people.nationality")}},[t._v("\n        "+t._s(t.person.nationality)+"\n    ")]):t._e(),t._v(" "),t.person.languages?n("two-col-list-group-item",{attrs:{title:t.$t("people.languages")}},[t._v("\n        "+t._s(t.person.languages.join(", "))+"\n    ")]):t._e(),t._v(" "),t.person.portrait_picture?n("two-col-list-group-item",{attrs:{title:t.$t("people.portrait_picture")}},[n("img",{staticClass:"img-fluid img-thumbnail",attrs:{src:t.person.portrait_picture_url}})]):t._e()],1)}),[],!1,null,null,null).exports,he={components:{InfoAlert:gt.a},props:{person:{type:Object,required:!0}}},be=Object(m.a)(he,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",[t._v(t._s(t.$t("app.cards")))]),t._v(" "),t.person.card_no?n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-sm table-hover"},[n("thead",[n("tr",[n("th",{staticClass:"fit"},[t._v(t._s(t.$t("app.date")))]),t._v(" "),n("th",[t._v(t._s(t.$t("app.card_number")))])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticClass:"fit"},[t.person.card_issued?[t._v("\n                            "+t._s(t.person.card_issued)+"\n                            "),n("small",[t._v(t._s(t.person.card_issued_dfh))])]:t._e()],2),t._v(" "),n("td",[n("strong",[t._v(t._s(t.person.card_no.substr(0,7)))]),t._v(t._s(t.person.card_no.substr(7))+"\n                    ")])]),t._v(" "),t._l(t.person.revoked_cards,(function(e){return n("tr",{key:e.card_no},[n("td",{staticClass:"fit"},[n("span",{staticClass:"text-danger"},[t._v(t._s(t.$t("app.revoked")))]),t._v(" "+t._s(e.date)+"\n                        "),n("small",[t._v(t._s(e.date_dfh))])]),t._v(" "),n("td",[n("del",[n("strong",[t._v(t._s(e.card_no.substr(0,7)))]),t._v(t._s(e.card_no.substr(7))+"\n                        ")])])])}))],2)])]):n("info-alert",{attrs:{message:t.$t("app.no_cards_registered")}})],1)}),[],!1,null,null,null).exports,ye={components:{InfoAlert:gt.a},props:{person:{type:Object,required:!0},showHandoutLimit:{type:Number,required:!1,default:15}}},ge={components:{PersonProperties:me,PersonCardsList:be,PersonCouponsList:Object(m.a)(ye,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",[t._v(t._s(t.$t("coupons.coupons")))]),t._v(" "),t.person.handouts.length>0?[n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-sm table-hover"},[n("thead",[n("tr",[n("th",[t._v(t._s(t.$t("app.date")))]),t._v(" "),n("th",[t._v(t._s(t.$t("app.type")))]),t._v(" "),n("th",[t._v(t._s(t.$t("app.registered")))])])]),t._v(" "),n("tbody",t._l(t.person.handouts,(function(e){return n("tr",{key:e.id},[n("td",[t._v(t._s(e.date))]),t._v(" "),n("td",[t._v(t._s(e.amount)+" "+t._s(e.coupon_name))]),t._v(" "),n("td",[t._v("\n                            "+t._s(e.created_at_dfh)+"\n                            "),n("small",{staticClass:"text-muted"},[t._v(t._s(e.created_at))])])])})),0)])]),t._v(" "),n("p",[n("small",[t.showHandoutLimit<t.person.num_handouts?[t._v("\n                "+t._s(t.$t("app.last_n_transactions_shown",{num:t.showHandoutLimit}))+"\n            ")]:t._e(),t._v("\n            "+t._s(t.$t("coupons.n_coupons_received_total_since_date",{num:t.person.num_handouts,date:t.person.first_handout_date,date_diff:t.person.first_handout_date_diff}))+"\n        ")],2)])]:n("info-alert",{attrs:{message:t.$t("coupons.no_coupons_received_so_far")}})],2)}),[],!1,null,null,null).exports,InfoAlert:gt.a},props:{person:{type:Object,required:!0},showHandoutLimit:{type:Number,required:!1,default:15}}},we=Object(m.a)(ge,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.person.is_active_community_volunteer?n("info-alert",{attrs:{message:t.$t("people.person_registered_as_community_volunteer")}}):t._e(),t._v(" "),t.person.remarks?n("info-alert",{attrs:{message:t.$t("people.remarks")+": "+t.person.remarks}}):t._e(),t._v(" "),n("div",{staticClass:"row mb-3"},[n("div",{staticClass:"col-md"},[n("person-properties",{attrs:{person:t.person}})],1),t._v(" "),n("div",{staticClass:"col-md"},[n("person-cards-list",{attrs:{person:t.person}}),t._v(" "),n("person-coupons-list",{attrs:{person:t.person,"show-handout-limit":t.showHandoutLimit}})],1)]),t._v(" "),n("hr"),t._v(" "),n("p",{staticClass:"text-right"},[n("small",[t._v(t._s(t.$t("app.created"))+": "+t._s(t.person.created_at_dfh)+"\n            "),n("small",{staticClass:"text-muted"},[t._v(t._s(t.person.created_at))])]),t._v(" "),n("br"),t._v(" "),n("small",[t._v(t._s(t.$t("app.last_updated"))+": "+t._s(t.person.updated_at_dfh)+"\n            "),n("small",{staticClass:"text-muted"},[t._v(t._s(t.person.updated_at))])])])],1)}),[],!1,null,null,null).exports,ke=n("275+"),xe=n("fxIy"),Ce=n("UvZm");a.a.component("font-awesome-icon",s.a),a.a.use(ke.a),a.a.config.productionTip=!1,a.a.mixin(Ce.a),new a.a({el:"#bank-app",i18n:xe.a,components:{BankSearchPage:Ot,BankTransactionsPage:Vt,BankVisitorReportPage:Mt,BankWithdrawalsReportPage:Yt,RegisterPersonPage:le,EditPersonPage:de,ViewPersonPage:we}})},CImE:function(t,e,n){var r=n("ousp");"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,a);r.locals&&(t.exports=r.locals)},SRYD:function(t,e,n){var r=n("oLFi");"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,a);r.locals&&(t.exports=r.locals)},Uwtk:function(t,e,n){var r=n("lY0U");"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,a);r.locals&&(t.exports=r.locals)},YwO6:function(t,e,n){"use strict";n("SRYD")},lY0U:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".clickable[data-v-1debff10]{cursor:pointer}",""])},lf1L:function(t,e,n){"use strict";n("Uwtk")},oLFi:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".clickable[data-v-710ebcbc]{cursor:pointer}",""])},ousp:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".loading-indicator[data-v-1dc289ee],.validation-failure[data-v-1dc289ee],.validation-pending[data-v-1dc289ee],.validation-success[data-v-1dc289ee]{position:absolute;width:100%;height:100%;background-color:hsla(0,0%,100%,.8);text-align:center;font-weight:700;font-size:1.4rem;padding:10px;display:flex;flex-flow:column nowrap;justify-content:center}.validation-success[data-v-1dc289ee]{color:green}.validation-failure[data-v-1dc289ee]{color:red}",""])}},[[5,0,1]]]);
//# sourceMappingURL=bank.js.map